/* WPlace AutoBOT â€” uso bajo tu responsabilidad. Compilado 2025-08-19T17:06:53.779Z */
(()=>{var i=(...u)=>console.log("[WPA-UI]",...u);var K={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"Selecci\xF3n",user:"Usuario",charges:"Cargas",backend:"Backend",database:"Database",uptime:"Uptime",close:"Cerrar",launch:"Lanzar",loading:"Cargando\u2026",executing:"Ejecutando\u2026",downloading:"Descargando script\u2026",chooseBot:"Elige un bot y presiona Lanzar",readyToLaunch:"Listo para lanzar",loadError:"Error al cargar",loadErrorMsg:"No se pudo cargar el bot seleccionado. Revisa tu conexi\xF3n o int\xE9ntalo de nuevo.",checking:"\u{1F504} Verificando...",online:"\u{1F7E2} Online",offline:"\u{1F534} Offline",ok:"\u{1F7E2} OK",error:"\u{1F534} Error",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Iniciar Auto-BOT",uploadImage:"Subir Imagen",resizeImage:"Redimensionar Imagen",selectPosition:"Seleccionar Posici\xF3n",startPainting:"Iniciar Pintura",stopPainting:"Detener Pintura",saveProgress:"Guardar Progreso",loadProgress:"Cargar Progreso",checkingColors:"\u{1F50D} Verificando colores disponibles...",noColorsFound:"\u274C \xA1Abre la paleta de colores en el sitio e int\xE9ntalo de nuevo!",colorsFound:"\u2705 {count} colores disponibles encontrados",loadingImage:"\u{1F5BC}\uFE0F Cargando imagen...",imageLoaded:"\u2705 Imagen cargada con {count} p\xEDxeles v\xE1lidos",imageError:"\u274C Error al cargar la imagen",selectPositionAlert:"\xA1Pinta el primer p\xEDxel en la ubicaci\xF3n donde quieres que comience el arte!",waitingPosition:"\u{1F446} Esperando que pintes el p\xEDxel de referencia...",positionSet:"\u2705 \xA1Posici\xF3n establecida con \xE9xito!",positionTimeout:"\u274C Tiempo agotado para seleccionar posici\xF3n",positionDetected:"\u{1F3AF} Posici\xF3n detectada, procesando...",positionError:"\u274C Error detectando posici\xF3n, int\xE9ntalo de nuevo",startPaintingMsg:"\u{1F3A8} Iniciando pintura...",paintingProgress:"\u{1F9F1} Progreso: {painted}/{total} p\xEDxeles...",noCharges:"\u231B Sin cargas. Esperando {time}...",paintingStopped:"\u23F9\uFE0F Pintura detenida por el usuario",paintingComplete:"\u2705 \xA1Pintura completada! {count} p\xEDxeles pintados.",paintingError:"\u274C Error durante la pintura",missingRequirements:"\u274C Carga una imagen y selecciona una posici\xF3n primero",progress:"Progreso",userName:"Usuario",pixels:"P\xEDxeles",charges:"Cargas",estimatedTime:"Tiempo estimado",initMessage:"Haz clic en 'Iniciar Auto-BOT' para comenzar",waitingInit:"Esperando inicializaci\xF3n...",resizeSuccess:"\u2705 Imagen redimensionada a {width}x{height}",paintingPaused:"\u23F8\uFE0F Pintura pausada en la posici\xF3n X: {x}, Y: {y}",pixelsPerBatch:"P\xEDxeles por lote",batchSize:"Tama\xF1o del lote",nextBatchTime:"Siguiente lote en",useAllCharges:"Usar todas las cargas disponibles",showOverlay:"Mostrar overlay",maxCharges:"Cargas m\xE1ximas por lote",waitingForCharges:"\u23F3 Esperando cargas: {current}/{needed}",timeRemaining:"Tiempo restante",cooldownWaiting:"\u23F3 Esperando {time} para continuar...",progressSaved:"\u2705 Progreso guardado como {filename}",progressLoaded:"\u2705 Progreso cargado: {painted}/{total} p\xEDxeles pintados",progressLoadError:"\u274C Error al cargar progreso: {error}",progressSaveError:"\u274C Error al guardar progreso: {error}",confirmSaveProgress:"\xBFDeseas guardar el progreso actual antes de detener?",saveProgressTitle:"Guardar Progreso",discardProgress:"Descartar",cancel:"Cancelar",minimize:"Minimizar",width:"Ancho",height:"Alto",keepAspect:"Mantener proporci\xF3n",apply:"Aplicar",overlayOn:"Overlay: ON",overlayOff:"Overlay: OFF",passCompleted:"\u2705 Pasada completada: {painted} p\xEDxeles pintados | Progreso: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Esperando regeneraci\xF3n de cargas: {current}/{needed} - Tiempo: {time}",waitingChargesCountdown:"\u23F3 Esperando cargas: {current}/{needed} - Quedan: {time}",autoInitializing:"\u{1F916} Inicializando autom\xE1ticamente...",autoInitSuccess:"\u2705 Bot iniciado autom\xE1ticamente",autoInitFailed:"\u26A0\uFE0F No se pudo iniciar autom\xE1ticamente. Usa el bot\xF3n manual.",paletteDetected:"\u{1F3A8} Paleta de colores detectada",paletteNotFound:"\u{1F50D} Buscando paleta de colores...",clickingPaintButton:"\u{1F446} Haciendo clic en el bot\xF3n Paint...",paintButtonNotFound:"\u274C Bot\xF3n Paint no encontrado",manualInitRequired:"\u{1F527} Inicio manual requerido",retryAttempt:"\u{1F504} Reintento {attempt}/{maxAttempts} en {delay}s...",retryError:"\u{1F4A5} Error en intento {attempt}/{maxAttempts}, reintentando en {delay}s...",retryFailed:"\u274C Fall\xF3 despu\xE9s de {maxAttempts} intentos. Continuando con siguiente lote...",networkError:"\u{1F310} Error de red. Reintentando...",serverError:"\u{1F525} Error del servidor. Reintentando...",timeoutError:"\u23F0 Timeout del servidor. Reintentando..."},farm:{title:"WPlace Farm Bot",start:"Iniciar",stop:"Detener",stopped:"Bot detenido",calibrate:"Calibrar",paintOnce:"Una vez",checkingStatus:"Verificando estado...",configuration:"Configuraci\xF3n",delay:"Delay (ms)",pixelsPerBatch:"P\xEDxeles/lote",minCharges:"Cargas m\xEDn",colorMode:"Modo color",random:"Aleatorio",fixed:"Fijo",range:"Rango",fixedColor:"Color fijo",advanced:"Avanzado",tileX:"Tile X",tileY:"Tile Y",customPalette:"Paleta personalizada",paletteExample:"ej: #FF0000,#00FF00,#0000FF",capture:"Capturar",painted:"Pintados",charges:"Cargas",retries:"Fallos",tile:"Tile",configSaved:"Configuraci\xF3n guardada",configLoaded:"Configuraci\xF3n cargada",configReset:"Configuraci\xF3n reiniciada",captureInstructions:"Pinta un p\xEDxel manualmente para capturar coordenadas...",backendOnline:"Backend Online",backendOffline:"Backend Offline",startingBot:"Iniciando bot...",stoppingBot:"Deteniendo bot...",calibrating:"Calibrando...",alreadyRunning:"Auto-Farm ya est\xE1 corriendo.",imageRunningWarning:"Auto-Image est\xE1 ejecut\xE1ndose. Ci\xE9rralo antes de iniciar Auto-Farm.",selectPosition:"Seleccionar Zona",selectPositionAlert:"\u{1F3AF} Pinta un p\xEDxel en una zona DESPOBLADA del mapa para establecer el \xE1rea de farming",waitingPosition:"\u{1F446} Esperando que pintes el p\xEDxel de referencia...",positionSet:"\u2705 \xA1Zona establecida! Radio: 500px",positionTimeout:"\u274C Tiempo agotado para seleccionar zona",missingPosition:"\u274C Selecciona una zona primero usando 'Seleccionar Zona'",farmRadius:"Radio farm",positionInfo:"Zona actual",farmingInRadius:"\u{1F33E} Farming en radio {radius}px desde ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANTE: Selecciona una zona DESPOBLADA para evitar conflictos",noPosition:"Sin zona",currentZone:"Zona: ({x},{y})",autoSelectPosition:"\u{1F3AF} Selecciona una zona primero. Pinta un p\xEDxel en el mapa para establecer la zona de farming"},common:{yes:"S\xED",no:"No",ok:"Aceptar",cancel:"Cancelar",close:"Cerrar",save:"Guardar",load:"Cargar",delete:"Eliminar",edit:"Editar",start:"Iniciar",stop:"Detener",pause:"Pausar",resume:"Reanudar",reset:"Reiniciar",settings:"Configuraci\xF3n",help:"Ayuda",about:"Acerca de",language:"Idioma",loading:"Cargando...",error:"Error",success:"\xC9xito",warning:"Advertencia",info:"Informaci\xF3n",languageChanged:"Idioma cambiado a {language}"}};var Q={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"Selection",user:"User",charges:"Charges",backend:"Backend",database:"Database",uptime:"Uptime",close:"Close",launch:"Launch",loading:"Loading\u2026",executing:"Executing\u2026",downloading:"Downloading script\u2026",chooseBot:"Choose a bot and press Launch",readyToLaunch:"Ready to launch",loadError:"Load error",loadErrorMsg:"Could not load the selected bot. Check your connection or try again.",checking:"\u{1F504} Checking...",online:"\u{1F7E2} Online",offline:"\u{1F534} Offline",ok:"\u{1F7E2} OK",error:"\u{1F534} Error",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Initialize Auto-BOT",uploadImage:"Upload Image",resizeImage:"Resize Image",selectPosition:"Select Position",startPainting:"Start Painting",stopPainting:"Stop Painting",saveProgress:"Save Progress",loadProgress:"Load Progress",checkingColors:"\u{1F50D} Checking available colors...",noColorsFound:"\u274C Open the color palette on the site and try again!",colorsFound:"\u2705 Found {count} available colors",loadingImage:"\u{1F5BC}\uFE0F Loading image...",imageLoaded:"\u2705 Image loaded with {count} valid pixels",imageError:"\u274C Error loading image",selectPositionAlert:"Paint the first pixel at the location where you want the art to start!",waitingPosition:"\u{1F446} Waiting for you to paint the reference pixel...",positionSet:"\u2705 Position set successfully!",positionTimeout:"\u274C Timeout for position selection",positionDetected:"\u{1F3AF} Position detected, processing...",positionError:"\u274C Error detecting position, please try again",startPaintingMsg:"\u{1F3A8} Starting painting...",paintingProgress:"\u{1F9F1} Progress: {painted}/{total} pixels...",noCharges:"\u231B No charges. Waiting {time}...",paintingStopped:"\u23F9\uFE0F Painting stopped by user",paintingComplete:"\u2705 Painting completed! {count} pixels painted.",paintingError:"\u274C Error during painting",missingRequirements:"\u274C Load an image and select a position first",progress:"Progress",userName:"User",pixels:"Pixels",charges:"Charges",estimatedTime:"Estimated time",initMessage:"Click 'Initialize Auto-BOT' to begin",waitingInit:"Waiting for initialization...",resizeSuccess:"\u2705 Image resized to {width}x{height}",paintingPaused:"\u23F8\uFE0F Painting paused at position X: {x}, Y: {y}",pixelsPerBatch:"Pixels per batch",batchSize:"Batch size",nextBatchTime:"Next batch in",useAllCharges:"Use all available charges",showOverlay:"Show overlay",maxCharges:"Max charges per batch",waitingForCharges:"\u23F3 Waiting for charges: {current}/{needed}",timeRemaining:"Time remaining",cooldownWaiting:"\u23F3 Waiting {time} to continue...",progressSaved:"\u2705 Progress saved as {filename}",progressLoaded:"\u2705 Progress loaded: {painted}/{total} pixels painted",progressLoadError:"\u274C Error loading progress: {error}",progressSaveError:"\u274C Error saving progress: {error}",confirmSaveProgress:"Do you want to save the current progress before stopping?",saveProgressTitle:"Save Progress",discardProgress:"Discard",cancel:"Cancel",minimize:"Minimize",width:"Width",height:"Height",keepAspect:"Keep aspect ratio",apply:"Apply",overlayOn:"Overlay: ON",overlayOff:"Overlay: OFF",passCompleted:"\u2705 Pass completed: {painted} pixels painted | Progress: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Waiting for charge regeneration: {current}/{needed} - Time: {time}",waitingChargesCountdown:"\u23F3 Waiting for charges: {current}/{needed} - Remaining: {time}",autoInitializing:"\u{1F916} Auto-initializing...",autoInitSuccess:"\u2705 Bot auto-started successfully",autoInitFailed:"\u26A0\uFE0F Could not auto-start. Use manual button.",paletteDetected:"\u{1F3A8} Color palette detected",paletteNotFound:"\u{1F50D} Searching for color palette...",clickingPaintButton:"\u{1F446} Clicking Paint button...",paintButtonNotFound:"\u274C Paint button not found",manualInitRequired:"\u{1F527} Manual initialization required",retryAttempt:"\u{1F504} Retry {attempt}/{maxAttempts} in {delay}s...",retryError:"\u{1F4A5} Error in attempt {attempt}/{maxAttempts}, retrying in {delay}s...",retryFailed:"\u274C Failed after {maxAttempts} attempts. Continuing with next batch...",networkError:"\u{1F310} Network error. Retrying...",serverError:"\u{1F525} Server error. Retrying...",timeoutError:"\u23F0 Server timeout. Retrying..."},farm:{title:"WPlace Farm Bot",start:"Start",stop:"Stop",stopped:"Bot stopped",calibrate:"Calibrate",paintOnce:"Once",checkingStatus:"Checking status...",configuration:"Configuration",delay:"Delay (ms)",pixelsPerBatch:"Pixels/batch",minCharges:"Min charges",colorMode:"Color mode",random:"Random",fixed:"Fixed",range:"Range",fixedColor:"Fixed color",advanced:"Advanced",tileX:"Tile X",tileY:"Tile Y",customPalette:"Custom palette",paletteExample:"e.g: #FF0000,#00FF00,#0000FF",capture:"Capture",painted:"Painted",charges:"Charges",retries:"Retries",tile:"Tile",configSaved:"Configuration saved",configLoaded:"Configuration loaded",configReset:"Configuration reset",captureInstructions:"Paint a pixel manually to capture coordinates...",backendOnline:"Backend Online",backendOffline:"Backend Offline",startingBot:"Starting bot...",stoppingBot:"Stopping bot...",calibrating:"Calibrating...",alreadyRunning:"Auto-Farm is already running.",imageRunningWarning:"Auto-Image is running. Close it before starting Auto-Farm.",selectPosition:"Select Area",selectPositionAlert:"\u{1F3AF} Paint a pixel in an EMPTY area of the map to set the farming zone",waitingPosition:"\u{1F446} Waiting for you to paint the reference pixel...",positionSet:"\u2705 Area set! Radius: 500px",positionTimeout:"\u274C Timeout for area selection",missingPosition:"\u274C Select an area first using 'Select Area'",farmRadius:"Farm radius",positionInfo:"Current area",farmingInRadius:"\u{1F33E} Farming in {radius}px radius from ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANT: Select an EMPTY area to avoid conflicts",noPosition:"No area",currentZone:"Zone: ({x},{y})",autoSelectPosition:"\u{1F3AF} Select an area first. Paint a pixel on the map to set the farming zone"},common:{yes:"Yes",no:"No",ok:"OK",cancel:"Cancel",close:"Close",save:"Save",load:"Load",delete:"Delete",edit:"Edit",start:"Start",stop:"Stop",pause:"Pause",resume:"Resume",reset:"Reset",settings:"Settings",help:"Help",about:"About",language:"Language",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",languageChanged:"Language changed to {language}"}};var J={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"S\xE9lection",user:"Utilisateur",charges:"Charges",backend:"Backend",database:"Base de donn\xE9es",uptime:"Temps actif",close:"Fermer",launch:"Lancer",loading:"Chargement\u2026",executing:"Ex\xE9cution\u2026",downloading:"T\xE9l\xE9chargement du script\u2026",chooseBot:"Choisissez un bot et appuyez sur Lancer",readyToLaunch:"Pr\xEAt \xE0 lancer",loadError:"Erreur de chargement",loadErrorMsg:"Impossible de charger le bot s\xE9lectionn\xE9. V\xE9rifiez votre connexion ou r\xE9essayez.",checking:"\u{1F504} V\xE9rification...",online:"\u{1F7E2} En ligne",offline:"\u{1F534} Hors ligne",ok:"\u{1F7E2} OK",error:"\u{1F534} Erreur",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Initialiser Auto-BOT",uploadImage:"T\xE9l\xE9charger Image",resizeImage:"Redimensionner Image",selectPosition:"S\xE9lectionner Position",startPainting:"Commencer Peinture",stopPainting:"Arr\xEAter Peinture",saveProgress:"Sauvegarder Progr\xE8s",loadProgress:"Charger Progr\xE8s",checkingColors:"\u{1F50D} V\xE9rification des couleurs disponibles...",noColorsFound:"\u274C Ouvrez la palette de couleurs sur le site et r\xE9essayez!",colorsFound:"\u2705 {count} couleurs disponibles trouv\xE9es",loadingImage:"\u{1F5BC}\uFE0F Chargement de l'image...",imageLoaded:"\u2705 Image charg\xE9e avec {count} pixels valides",imageError:"\u274C Erreur lors du chargement de l'image",selectPositionAlert:"Peignez le premier pixel \xE0 l'emplacement o\xF9 vous voulez que l'art commence!",waitingPosition:"\u{1F446} En attente que vous peigniez le pixel de r\xE9f\xE9rence...",positionSet:"\u2705 Position d\xE9finie avec succ\xE8s!",positionTimeout:"\u274C D\xE9lai d\xE9pass\xE9 pour la s\xE9lection de position",positionDetected:"\u{1F3AF} Position d\xE9tect\xE9e, traitement...",positionError:"\u274C Erreur d\xE9tectant la position, essayez \xE0 nouveau",startPaintingMsg:"\u{1F3A8} D\xE9but de la peinture...",paintingProgress:"\u{1F9F1} Progr\xE8s: {painted}/{total} pixels...",noCharges:"\u231B Aucune charge. Attendre {time}...",paintingStopped:"\u23F9\uFE0F Peinture arr\xEAt\xE9e par l'utilisateur",paintingComplete:"\u2705 Peinture termin\xE9e! {count} pixels peints.",paintingError:"\u274C Erreur pendant la peinture",missingRequirements:"\u274C Chargez une image et s\xE9lectionnez une position d'abord",progress:"Progr\xE8s",userName:"Usager",pixels:"Pixels",charges:"Charges",estimatedTime:"Temps estim\xE9",initMessage:"Cliquez sur 'Initialiser Auto-BOT' pour commencer",waitingInit:"En attente d'initialisation...",resizeSuccess:"\u2705 Image redimensionn\xE9e \xE0 {width}x{height}",paintingPaused:"\u23F8\uFE0F Peinture mise en pause \xE0 la position X: {x}, Y: {y}",pixelsPerBatch:"Pixels par lot",batchSize:"Taille du lot",nextBatchTime:"Prochain lot dans",useAllCharges:"Utiliser toutes les charges disponibles",showOverlay:"Afficher l'overlay",maxCharges:"Charges max par lot",waitingForCharges:"\u23F3 En attente de charges: {current}/{needed}",timeRemaining:"Temps restant",cooldownWaiting:"\u23F3 Attendre {time} pour continuer...",progressSaved:"\u2705 Progr\xE8s sauvegard\xE9 sous {filename}",progressLoaded:"\u2705 Progr\xE8s charg\xE9: {painted}/{total} pixels peints",progressLoadError:"\u274C Erreur lors du chargement du progr\xE8s: {error}",progressSaveError:"\u274C Erreur lors de la sauvegarde du progr\xE8s: {error}",confirmSaveProgress:"Voulez-vous sauvegarder le progr\xE8s actuel avant d'arr\xEAter?",saveProgressTitle:"Sauvegarder Progr\xE8s",discardProgress:"Abandonner",cancel:"Annuler",minimize:"Minimiser",width:"Largeur",height:"Hauteur",keepAspect:"Garder les proportions",apply:"Appliquer",overlayOn:"Overlay : ON",overlayOff:"Overlay : OFF",passCompleted:"\u2705 Passage termin\xE9: {painted} pixels peints | Progr\xE8s: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Attente de r\xE9g\xE9n\xE9ration des charges: {current}/{needed} - Temps: {time}",waitingChargesCountdown:"\u23F3 Attente des charges: {current}/{needed} - Restant: {time}",autoInitializing:"\u{1F916} Initialisation automatique...",autoInitSuccess:"\u2705 Bot d\xE9marr\xE9 automatiquement",autoInitFailed:"\u26A0\uFE0F Impossible de d\xE9marrer automatiquement. Utilisez le bouton manuel.",paletteDetected:"\u{1F3A8} Palette de couleurs d\xE9tect\xE9e",paletteNotFound:"\u{1F50D} Recherche de la palette de couleurs...",clickingPaintButton:"\u{1F446} Clic sur le bouton Paint...",paintButtonNotFound:"\u274C Bouton Paint introuvable",manualInitRequired:"\u{1F527} Initialisation manuelle requise",retryAttempt:"\u{1F504} Tentative {attempt}/{maxAttempts} dans {delay}s...",retryError:"\u{1F4A5} Erreur dans tentative {attempt}/{maxAttempts}, nouvel essai dans {delay}s...",retryFailed:"\u274C \xC9chec apr\xE8s {maxAttempts} tentatives. Continuant avec le lot suivant...",networkError:"\u{1F310} Erreur r\xE9seau. Nouvel essai...",serverError:"\u{1F525} Erreur serveur. Nouvel essai...",timeoutError:"\u23F0 Timeout serveur. Nouvel essai..."},farm:{title:"WPlace Farm Bot",start:"D\xE9marrer",stop:"Arr\xEAter",stopped:"Bot arr\xEAt\xE9",calibrate:"Calibrer",paintOnce:"Une fois",checkingStatus:"V\xE9rification du statut...",configuration:"Configuration",delay:"D\xE9lai (ms)",pixelsPerBatch:"Pixels/lot",minCharges:"Charges min",colorMode:"Mode couleur",random:"Al\xE9atoire",fixed:"Fixe",range:"Plage",fixedColor:"Couleur fixe",advanced:"Avanc\xE9",tileX:"Tuile X",tileY:"Tuile Y",customPalette:"Palette personnalis\xE9e",paletteExample:"ex: #FF0000,#00FF00,#0000FF",capture:"Capturer",painted:"Peints",charges:"Charges",retries:"\xC9checs",tile:"Tuile",configSaved:"Configuration sauvegard\xE9e",configLoaded:"Configuration charg\xE9e",configReset:"Configuration r\xE9initialis\xE9e",captureInstructions:"Peindre un pixel manuellement pour capturer les coordonn\xE9es...",backendOnline:"Backend En ligne",backendOffline:"Backend Hors ligne",startingBot:"D\xE9marrage du bot...",stoppingBot:"Arr\xEAt du bot...",calibrating:"Calibrage...",alreadyRunning:"Auto-Farm est d\xE9j\xE0 en cours d'ex\xE9cution.",imageRunningWarning:"Auto-Image est en cours d'ex\xE9cution. Fermez-le avant de d\xE9marrer Auto-Farm.",selectPosition:"S\xE9lectionner Zone",selectPositionAlert:"\u{1F3AF} Peignez un pixel dans une zone VIDE de la carte pour d\xE9finir la zone de farming",waitingPosition:"\u{1F446} En attente que vous peigniez le pixel de r\xE9f\xE9rence...",positionSet:"\u2705 Zone d\xE9finie! Rayon: 500px",positionTimeout:"\u274C D\xE9lai d\xE9pass\xE9 pour la s\xE9lection de zone",missingPosition:"\u274C S\xE9lectionnez une zone d'abord en utilisant 'S\xE9lectionner Zone'",farmRadius:"Rayon farm",positionInfo:"Zone actuelle",farmingInRadius:"\u{1F33E} Farming dans un rayon de {radius}px depuis ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANT: S\xE9lectionnez une zone VIDE pour \xE9viter les conflits",noPosition:"Aucune zone",currentZone:"Zone: ({x},{y})",autoSelectPosition:"\u{1F3AF} S\xE9lectionnez une zone d'abord. Peignez un pixel sur la carte pour d\xE9finir la zone de farming"},common:{yes:"Oui",no:"Non",ok:"OK",cancel:"Annuler",close:"Fermer",save:"Sauvegarder",load:"Charger",delete:"Supprimer",edit:"Modifier",start:"D\xE9marrer",stop:"Arr\xEAter",pause:"Pause",resume:"Reprendre",reset:"R\xE9initialiser",settings:"Param\xE8tres",help:"Aide",about:"\xC0 propos",language:"Langue",loading:"Chargement...",error:"Erreur",success:"Succ\xE8s",warning:"Avertissement",info:"Information",languageChanged:"Langue chang\xE9e en {language}"}};var ee={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C",autoImage:"\u{1F3A8} \u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",selection:"\u0412\u044B\u0431\u0440\u0430\u043D\u043E",user:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",charges:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F",backend:"\u0411\u044D\u043A\u0435\u043D\u0434",database:"\u0411\u0430\u0437\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",uptime:"\u0412\u0440\u0435\u043C\u044F \u0440\u0430\u0431\u043E\u0442\u044B",close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",launch:"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C",loading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430",executing:"\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435",downloading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u043A\u0440\u0438\u043F\u0442\u0430...",chooseBot:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u043E\u0442\u0430 \u0438 \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C",readyToLaunch:"\u0413\u043E\u0442\u043E\u0432\u043E \u043A \u0437\u0430\u043F\u0443\u0441\u043A\u0443",loadError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438",loadErrorMsg:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0433\u043E \u0431\u043E\u0442\u0430. \u041F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u0438\u043B\u0438 \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",checking:"\u{1F504} \u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430...",online:"\u{1F7E2} \u041E\u043D\u043B\u0430\u0439\u043D",offline:"\u{1F534} \u041E\u0444\u043B\u0430\u0439\u043D",ok:"\u{1F7E2} \u041E\u041A",error:"\u{1F534} \u041E\u0448\u0438\u0431\u043A\u0430",unknown:"-"},image:{title:"WPlace \u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",initBot:"\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C Auto-BOT",uploadImage:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",resizeImage:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0430\u0437\u043C\u0435\u0440 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",selectPosition:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043C\u0435\u0441\u0442\u043E \u043D\u0430\u0447\u0430\u043B\u0430",startPainting:"\u041D\u0430\u0447\u0430\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u0442\u044C",stopPainting:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435",saveProgress:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",loadProgress:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",checkingColors:"\u{1F50D} \u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0445 \u0446\u0432\u0435\u0442\u043E\u0432...",noColorsFound:"\u274C \u041E\u0442\u043A\u0440\u043E\u0439\u0442\u0435 \u043F\u0430\u043B\u0438\u0442\u0440\u0443 \u0446\u0432\u0435\u0442\u043E\u0432 \u043D\u0430 \u0441\u0430\u0439\u0442\u0435 \u0438 \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u043D\u043E\u0432\u0430!",colorsFound:"\u2705 \u041D\u0430\u0439\u0434\u0435\u043D\u043E {count} \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0445 \u0446\u0432\u0435\u0442\u043E\u0432",loadingImage:"\u{1F5BC}\uFE0F \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F...",imageLoaded:"\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E \u0441 {count} \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C\u0438 \u043F\u0438\u043A\u0441\u0435\u043B\u044F\u043C\u0438",imageError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",selectPositionAlert:"\u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u044B\u0439 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432 \u0442\u043E\u043C \u043C\u0435\u0441\u0442\u0435, \u0433\u0434\u0435 \u0432\u044B \u0445\u043E\u0442\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0440\u0438\u0441\u0443\u043D\u043E\u043A \u043D\u0430\u0447\u0438\u043D\u0430\u043B\u0441\u044F!",waitingPosition:"\u{1F446} \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0433\u043E \u043F\u0438\u043A\u0441\u0435\u043B\u044F....",positionSet:"\u2705 \u041F\u043E\u0437\u0438\u0446\u0438\u044F \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E!",positionTimeout:"\u274C \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0432\u044B\u0431\u043E\u0440\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438",positionDetected:"\u{1F3AF} \u041F\u043E\u0437\u0438\u0446\u0438\u044F \u0432\u044B\u0431\u0440\u0430\u043D\u0430, \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430...",positionError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u044B\u0431\u043E\u0440\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437",startPaintingMsg:"\u{1F3A8} \u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u044F...",paintingProgress:"\u{1F9F1} \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441: {painted} \u0438\u0437 {total} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439...",noCharges:"\u231B \u041D\u0435\u0442 \u0437\u0430\u0440\u044F\u0434\u043E\u0432. \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 {time}...",paintingStopped:"\u23F9\uFE0F \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u043C",paintingComplete:"\u2705 \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E! {count} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E.",paintingError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u043F\u0440\u043E\u0446\u0435\u0441\u0441\u0435 \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u044F",missingRequirements:"\u274C \u0421\u043F\u0435\u0440\u0432\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0438 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043C\u0435\u0441\u0442\u043E \u043D\u0430\u0447\u0430\u043B\u0430",progress:"\u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",userName:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",pixels:"\u041F\u0438\u043A\u0441\u0435\u043B\u0438",charges:"\u0417\u0430\u0440\u044F\u0434\u044B",estimatedTime:"\u041F\u0440\u0435\u0434\u043F\u043E\u043B\u043E\u0436\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u0432\u0440\u0435\u043C\u044F",initMessage:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \xAB\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C Auto-BOT\xBB, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u0447\u0430\u0442\u044C",waitingInit:"\u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438...",resizeSuccess:"\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u043E \u0434\u043E {width}x{height}",paintingPaused:"\u23F8\uFE0F \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u0438\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E \u043D\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438 X: {x}, Y: {y}",pixelsPerBatch:"\u041F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u0432 \u043F\u0440\u043E\u0445\u043E\u0434\u0435",batchSize:"\u0420\u0430\u0437\u043C\u0435\u0440 \u043F\u0440\u043E\u0445\u043E\u0434\u0430",nextBatchTime:"\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u043F\u0440\u043E\u0445\u043E\u0434 \u0447\u0435\u0440\u0435\u0437",useAllCharges:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u0432\u0441\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u0437\u0430\u0440\u044F\u0434\u044B",showOverlay:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043D\u0430\u043B\u043E\u0436\u0435\u043D\u0438\u0435",maxCharges:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u0437\u0430\u0440\u044F\u0434\u043E\u0432 \u0437\u0430 \u043F\u0440\u043E\u0445\u043E\u0434",waitingForCharges:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0437\u0430\u0440\u044F\u0434\u043E\u0432: {current} \u0438\u0437 {needed}",timeRemaining:"\u0412\u0440\u0435\u043C\u0435\u043D\u0438 \u043E\u0441\u0442\u0430\u043B\u043E\u0441\u044C",cooldownWaiting:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 {time} \u0434\u043B\u044F \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u044F...",progressSaved:"\u2705 \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D \u043A\u0430\u043A {filename}",progressLoaded:"\u2705 \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D: {painted} \u0438\u0437 {total} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E",progressLoadError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441\u0430: {error}",progressSaveError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441\u0430: {error}",confirmSaveProgress:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u043F\u0435\u0440\u0435\u0434 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u043E\u0439?",saveProgressTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",discardProgress:"\u041D\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",cancel:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",minimize:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C",width:"\u0428\u0438\u0440\u0438\u043D\u0430",height:"\u0412\u044B\u0441\u043E\u0442\u0430",keepAspect:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0441\u043E\u043E\u0442\u043D\u043E\u0448\u0435\u043D\u0438\u0435 \u0441\u0442\u043E\u0440\u043E\u043D",apply:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C",passCompleted:"\u2705 \u041F\u0440\u043E\u0446\u0435\u0441\u0441 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D: {painted} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E | \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441: {percent}% ({current} \u0438\u0437 {total})",waitingChargesRegen:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0432\u043E\u0441\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u0440\u044F\u0434\u0430: {current} \u0438\u0437 {needed} - \u0412\u0440\u0435\u043C\u044F: {time}",waitingChargesCountdown:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0437\u0430\u0440\u044F\u0434\u043E\u0432: {current} \u0438\u0437 {needed} - \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F: {time}",autoInitializing:"\u{1F916} \u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0430\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F...",autoInitSuccess:"\u2705 \u0411\u043E\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u043B\u0441\u044F \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438",autoInitFailed:"\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0432\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u0437\u0430\u043F\u0443\u0441\u043A. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u043A\u043D\u043E\u043F\u043A\u0443 \u0440\u0443\u0447\u043D\u043E\u0433\u043E \u0437\u0430\u043F\u0443\u0441\u043A\u0430.",paletteDetected:"\u{1F3A8} \u0426\u0432\u0435\u0442\u043E\u0432\u0430\u044F \u043F\u0430\u043B\u0438\u0442\u0440\u0430 \u043E\u0431\u043D\u0430\u0440\u0443\u0436\u0435\u043D\u0430",paletteNotFound:"\u{1F50D} \u041F\u043E\u0438\u0441\u043A \u0446\u0432\u0435\u0442\u043E\u0432\u043E\u0439 \u043F\u0430\u043B\u0438\u0442\u0440\u044B...",clickingPaintButton:"\u{1F446} \u041D\u0430\u0436\u0430\u0442\u0438\u0435 \u043A\u043D\u043E\u043F\u043A\u0438 \xABPaint\xBB...",paintButtonNotFound:"\u274C \u041A\u043D\u043E\u043F\u043A\u0430 \xABPaint\xBB \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430",manualInitRequired:"\u{1F527} \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u0440\u0443\u0447\u043D\u0430\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F",retryAttempt:"\u{1F504} \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430 {attempt} \u0438\u0437 {maxAttempts} \u0447\u0435\u0440\u0435\u0437 {delay}s...",retryError:"\u{1F4A5} \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u043F\u043E\u043F\u044B\u0442\u043A\u0435 {attempt} \u0438\u0437 {maxAttempts}, \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 {delay}s...",retryFailed:"\u274C \u041F\u0440\u043E\u0432\u0430\u043B\u0435\u043D\u043E \u0441\u043F\u0443\u0441\u0442\u044F {maxAttempts} \u043F\u043E\u043F\u044B\u0442\u043E\u043A. \u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u0435 \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C \u043F\u0440\u043E\u0445\u043E\u0434\u0435...",networkError:"\u{1F310} \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0442\u0438. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430...",serverError:"\u{1F525} \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430...",timeoutError:"\u23F0 \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430..."},farm:{title:"WPlace \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C",start:"\u041D\u0430\u0447\u0430\u0442\u044C",stop:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C",stopped:"\u0411\u043E\u0442 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D",calibrate:"\u041A\u0430\u043B\u0438\u0431\u0440\u043E\u0432\u0430\u0442\u044C",paintOnce:"\u0415\u0434\u0438\u043D\u043E\u0440\u0430\u0437\u043E\u0432\u043E",checkingStatus:"\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430...",configuration:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F",delay:"\u0417\u0430\u0434\u0435\u0440\u0436\u043A\u0430 (\u043C\u0441)",pixelsPerBatch:"\u041F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u0437\u0430 \u043F\u0440\u043E\u0445\u043E\u0434",minCharges:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E",colorMode:"\u0420\u0435\u0436\u0438\u043C \u0446\u0432\u0435\u0442\u043E\u0432",random:"\u0421\u043B\u0443\u0447\u0430\u0439\u043D\u044B\u0439",fixed:"\u0424\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439",range:"\u0414\u0438\u0430\u043F\u0430\u0437\u043E\u043D",fixedColor:"\u0424\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0446\u0432\u0435\u0442",advanced:"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u044B\u0435",tileX:"\u041F\u043B\u0438\u0442\u043A\u0430 X",tileY:"\u041F\u043B\u0438\u0442\u043A\u0430 Y",customPalette:"\u0421\u0432\u043E\u044F \u043F\u0430\u043B\u0438\u0442\u0440\u0430",paletteExample:"\u043F\u0440\u0438\u043C\u0435\u0440: #FF0000,#00FF00,#0000FF",capture:"\u0417\u0430\u0445\u0432\u0430\u0442",painted:"\u0417\u0430\u043A\u0440\u0430\u0448\u0435\u043D\u043E",charges:"\u0417\u0430\u0440\u044F\u0434\u044B",retries:"\u041F\u043E\u0432\u0442\u043E\u0440\u043D\u044B\u0435 \u043F\u043E\u043F\u044B\u0442\u043A\u0438",tile:"\u041F\u043B\u0438\u0442\u043A\u0430",configSaved:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0430",configLoaded:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u0430",configReset:"\u0421\u0431\u0440\u043E\u0441 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438",captureInstructions:"\u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432\u0440\u0443\u0447\u043D\u0443\u044E \u0434\u043B\u044F \u0437\u0430\u0445\u0432\u0430\u0442\u0430 \u043A\u043E\u043E\u0440\u0434\u0438\u043D\u0430\u0442...",backendOnline:"\u0411\u044D\u043A\u044D\u043D\u0434 \u041E\u043D\u043B\u0430\u0439\u043D",backendOffline:"\u0411\u044D\u043A\u044D\u043D\u0434",startingBot:"\u0417\u0430\u043F\u0443\u0441\u043A \u0431\u043E\u0442\u0430...",stoppingBot:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0431\u043E\u0442\u0430...",calibrating:"\u041A\u0430\u043B\u0438\u0431\u0440\u043E\u0432\u043A\u0430...",alreadyRunning:"\u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C \u0443\u0436\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D",imageRunningWarning:"\u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D\u043E. \u0417\u0430\u043A\u0440\u043E\u0439\u0442\u0435 \u0435\u0433\u043E \u043F\u0435\u0440\u0435\u0434 \u0437\u0430\u043F\u0443\u0441\u043A\u043E\u043C \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C\u0430.",selectPosition:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",selectPositionAlert:"\u{1F3AF} \u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432 \u041F\u0423\u0421\u0422\u041E\u0419 \u043E\u0431\u043B\u0430\u0441\u0442\u0438 \u043A\u0430\u0440\u0442\u044B, \u0447\u0442\u043E\u0431\u044B \u043E\u0431\u043E\u0437\u043D\u0430\u0447\u0438\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0444\u0430\u0440\u043C\u0430.",waitingPosition:"\u{1F446} \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0433\u043E \u043F\u0438\u043A\u0441\u0435\u043B\u044F....",positionSet:"\u2705 \u041E\u0431\u043B\u0430\u0441\u0442\u044C \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430! \u0420\u0430\u0434\u0438\u0443\u0441: 500px",positionTimeout:"\u274C \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0432\u044B\u0431\u043E\u0440\u0430 \u043E\u0431\u043B\u0430\u0441\u0442\u0438",missingPosition:"\u274C \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \xAB\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C\xBB",farmRadius:"\u0420\u0430\u0434\u0438\u0443\u0441 \u0444\u0430\u0440\u043C\u0430",positionInfo:"\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043E\u0431\u043B\u0430\u0441\u0442\u044C",farmingInRadius:"\u{1F33E} \u0424\u0430\u0440\u043C \u0432 \u0440\u0430\u0434\u0438\u0443\u0441\u0435 {radius}px \u043E\u0442 ({x},{y})",selectEmptyArea:"\u26A0\uFE0F \u0412\u0410\u0416\u041D\u041E: \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u041F\u0423\u0421\u0422\u0423\u042E \u043E\u0431\u043B\u0430\u0441\u0442\u044C, \u0447\u0442\u043E\u0431\u044B \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044C \u043A\u043E\u043D\u0444\u043B\u0438\u043A\u0442\u043E\u0432.",noPosition:"\u041D\u0435\u0442 \u043E\u0431\u043B\u0430\u0441\u0442\u0438",currentZone:"\u041E\u0431\u043B\u0430\u0441\u0442\u044C: ({x},{y})",autoSelectPosition:"\u{1F3AF} \u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0431\u043B\u0430\u0441\u0442\u044C. \u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u043D\u0430 \u043A\u0430\u0440\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043E\u0431\u043E\u0437\u043D\u0430\u0447\u0438\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0444\u0430\u0440\u043C\u0430."},common:{yes:"\u0414\u0430",no:"\u041D\u0435\u0442",ok:"\u041E\u041A",cancel:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",save:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",load:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C",delete:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",edit:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C",start:"\u041D\u0430\u0447\u0430\u0442\u044C",stop:"\u0417\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C",pause:"\u041F\u0440\u0438\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C",resume:"\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C",reset:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",settings:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",help:"\u041F\u043E\u043C\u043E\u0449\u044C",about:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",language:"\u042F\u0437\u044B\u043A",loading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...",error:"\u041E\u0448\u0438\u0431\u043A\u0430",success:"\u0423\u0441\u043F\u0435\u0445",warning:"\u041F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0436\u0434\u0435\u043D\u0438\u0435",info:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",languageChanged:"\u042F\u0437\u044B\u043A \u0438\u0437\u043C\u0435\u043D\u0435\u043D \u043D\u0430 {language}"}};var Y={es:K,en:Q,fr:J,ru:ee},N="es",F=Y[N];function Pe(){let t=(window.navigator.language||window.navigator.userLanguage||"es").split("-")[0].toLowerCase();return Y[t]?t:"es"}function be(){return null}function U(){let u=be(),t=Pe(),c="es";return u&&Y[u]?c=u:t&&Y[t]&&(c=t),we(c),c}function we(u){if(!Y[u]){console.warn(`Idioma '${u}' no disponible. Usando '${N}'`);return}N=u,F=Y[u],typeof window!="undefined"&&window.CustomEvent&&window.dispatchEvent(new window.CustomEvent("languageChanged",{detail:{language:u,translations:F}}))}function te(){return N}function E(u,t={}){let c=u.split("."),n=F;for(let a of c)if(n&&typeof n=="object"&&a in n)n=n[a];else return console.warn(`Clave de traducci\xF3n no encontrada: '${u}'`),u;return typeof n!="string"?(console.warn(`Clave de traducci\xF3n no es string: '${u}'`),u):ye(n,t)}function ye(u,t){return!t||Object.keys(t).length===0?u:u.replace(/\{(\w+)\}/g,(c,n)=>t[n]!==void 0?t[n]:c)}function q(u){return F[u]?F[u]:(console.warn(`Secci\xF3n de traducci\xF3n no encontrada: '${u}'`),{})}U();var z={SITEKEY:"0x4AAAAAABpqJe8FO0N84q0F",COOLDOWN_DEFAULT:31e3,TRANSPARENCY_THRESHOLD:100,WHITE_THRESHOLD:250,LOG_INTERVAL:10,TILE_SIZE:4e3,PIXELS_PER_BATCH:20,CHARGE_REGEN_MS:3e4,THEME:{primary:"#000000",secondary:"#111111",accent:"#222222",text:"#ffffff",highlight:"#775ce3",success:"#00ff00",error:"#ff0000",warning:"#ffaa00"}};var e={running:!1,imageLoaded:!1,processing:!1,totalPixels:0,paintedPixels:0,availableColors:[],currentCharges:0,cooldown:z.COOLDOWN_DEFAULT,imageData:null,stopFlag:!1,colorsChecked:!1,startPosition:null,selectingPosition:!1,positionTimeoutId:null,cleanupObserver:null,region:null,minimized:!1,lastPosition:{x:0,y:0},estimatedTime:0,language:"es",tileX:null,tileY:null,pixelsPerBatch:z.PIXELS_PER_BATCH,useAllChargesFirst:!0,isFirstBatch:!0,maxCharges:50,nextBatchCooldown:0,inCooldown:!1,cooldownEndTime:0,remainingPixels:[],lastChargeUpdate:0,chargeDecimalPart:0,originalImageName:null,retryCount:0};var W=class{constructor(){this.detectedSize=null,this.confidence=0}detectFromUrl(){try{let t=window.location.href,c=new URLSearchParams(window.location.search),n=window.location.hash,a=null;if(c.has("x")&&c.has("y"))a=[parseInt(c.get("x")),parseInt(c.get("y"))];else if(n){let r=n.match(/#(-?\d+),(-?\d+)/);r&&(a=[parseInt(r[1]),parseInt(r[2])])}if(a&&(Math.abs(a[0])>1e4||Math.abs(a[1])>1e4)){let r=[3e3,4e3,2048,5e3];for(let g of r){let o=Math.floor(a[0]/g),m=Math.floor(a[1]/g),d=a[0]%g,s=a[1]%g;if(d>=0&&d<g&&s>=0&&s<g)return i(`[TILE DETECTOR] URL suggests tile size: ${g} (tile: ${o},${m} local: ${d},${s})`),g}}}catch(t){i("[TILE DETECTOR] Error detecting from URL:",t)}return null}detectFromDOM(){var t;try{let c=["[data-tile-size]",".tile-info",".coordinates",".position-info"];for(let r of c){let g=document.querySelectorAll(r);for(let o of g){let m=o.getAttribute("data-tile-size")||o.dataset.tileSize||((t=o.textContent.match(/tile.*?(\d{4,})/i))==null?void 0:t[1]);if(m){let d=parseInt(m);if(d>=1e3&&d<=1e4)return i(`[TILE DETECTOR] DOM suggests tile size: ${d}`),d}}}let n=document.body.textContent||"",a=n.match(/tile.*?(\d{4,})/i)||n.match(/(\d{4,}).*?tile/i);if(a){let r=parseInt(a[1]);if(r>=1e3&&r<=1e4)return i(`[TILE DETECTOR] Text content suggests tile size: ${r}`),r}}catch(c){i("[TILE DETECTOR] Error detecting from DOM:",c)}return null}async detectFromNetwork(t=1e4){return new Promise(c=>{let n=window.fetch,a=!1,r=setTimeout(()=>{a||(a=!0,window.fetch=n,c(null))},t);window.fetch=async function(g,o){try{if(g.includes("/s0/pixel/")&&o&&o.body){let m=g.match(/\/s0\/pixel\/(-?\d+)\/(-?\d+)/),d;try{d=JSON.parse(o.body)}catch{d=o.body}if(m&&d&&d.coords){let s=parseInt(m[1]),l=parseInt(m[2]),f=d.coords[0],x=d.coords[1],w=[3e3,4e3,2048,5e3];for(let p of w){let P=s*p+f,b=l*p+x;if(f>=0&&f<p&&x>=0&&x<p&&!a){a=!0,clearTimeout(r),window.fetch=n,i(`[TILE DETECTOR] Network request suggests tile size: ${p} (tile: ${s},${l} local: ${f},${x})`),c(p);return}}}}}catch(m){i("[TILE DETECTOR] Error intercepting network:",m)}return n(g,o)}})}async autoDetect(){i("[TILE DETECTOR] Auto-detecting tile size...");let t=this.detectFromUrl();if(t)return this.detectedSize=t,this.confidence=.8,t;if(t=this.detectFromDOM(),t)return this.detectedSize=t,this.confidence=.6,t;if(t=await this.detectFromNetwork(5e3),t)return this.detectedSize=t,this.confidence=.9,t;i("[TILE DETECTOR] Could not auto-detect, trying common sizes...");let n=document.querySelector('meta[name="viewport"]')||document.querySelector('[class*="modern"]')||document.querySelector('[class*="v2"]')||window.location.href.includes("v2")?4e3:3e3;return this.detectedSize=n,this.confidence=.3,i(`[TILE DETECTOR] Using fallback size: ${n} (confidence: ${this.confidence})`),n}getDetectedSize(){return this.detectedSize}getConfidence(){return this.confidence}},V=new W;function H(){i("\u{1F3A8} Detectando colores disponibles...");let u=document.querySelectorAll('[id^="color-"]'),t=[];for(let c of u){if(c.querySelector("svg"))continue;let n=c.id.replace("color-",""),a=parseInt(n);if(a===0||a===5)continue;let r=c.style.backgroundColor;if(r){let g=r.match(/\d+/g);if(g&&g.length>=3){let o={r:parseInt(g[0]),g:parseInt(g[1]),b:parseInt(g[2])};t.push({id:a,element:c,...o}),i(`Color detectado: id=${a}, rgb(${o.r},${o.g},${o.b})`)}}}return i(`\u2705 ${t.length} colores disponibles detectados`),t}var X=class{constructor(t){this.imageSrc=t,this.img=new window.Image,this.originalName=null,this.tileSize=1e3,this.drawMult=3,this.shreadSize=3,this.actualTileSize=z.TILE_SIZE,this.bitmap=null,this.imageWidth=0,this.imageHeight=0,this.totalPixels=0,this.requiredPixelCount=0,this.defacePixelCount=0,this.colorPalette={},this.allowedColorsSet=new Set,this.rgbToMeta=new Map,this.coords=[0,0,0,0],this.templateTiles={},this.templateTilesBuffers={},this.tilePrefixes=new Set,this.initializeTileSize()}async initializeTileSize(){try{let t=await V.autoDetect();t?(this.actualTileSize=t,i(`[BLUE MARBLE] Using detected tile size: ${t}`)):i(`[BLUE MARBLE] Using default tile size: ${this.actualTileSize}`)}catch(t){i("[BLUE MARBLE] Error detecting tile size, using default:",t)}}async load(){return new Promise((t,c)=>{this.img.onload=async()=>{try{this.bitmap=await createImageBitmap(this.img),this.imageWidth=this.bitmap.width,this.imageHeight=this.bitmap.height,this.totalPixels=this.imageWidth*this.imageHeight,i(`[BLUE MARBLE] Imagen cargada: ${this.imageWidth}\xD7${this.imageHeight} = ${this.totalPixels.toLocaleString()} p\xEDxeles`),t()}catch(n){c(n)}},this.img.onerror=c,this.img.src=this.imageSrc})}initializeColorPalette(){i("[BLUE MARBLE] Inicializando paleta de colores...");let t=this.detectSiteColors();this.allowedColorsSet=new Set(t.filter(n=>n.name&&n.name.toLowerCase()!=="transparent"&&Array.isArray(n.rgb)).map(n=>`${n.rgb[0]},${n.rgb[1]},${n.rgb[2]}`));let c="222,250,206";this.allowedColorsSet.add(c),this.rgbToMeta=new Map(t.filter(n=>Array.isArray(n.rgb)).map(n=>[`${n.rgb[0]},${n.rgb[1]},${n.rgb[2]}`,{id:n.id,premium:!!n.premium,name:n.name||`Color ${n.id}`}]));try{let n=t.find(a=>a.name&&a.name.toLowerCase()==="transparent");n&&Array.isArray(n.rgb)&&this.rgbToMeta.set(c,{id:n.id,premium:!!n.premium,name:n.name})}catch{}return i(`[BLUE MARBLE] Paleta inicializada: ${this.allowedColorsSet.size} colores permitidos`),Array.from(t)}detectSiteColors(){let t=document.querySelectorAll('[id^="color-"]'),c=[];for(let n of t){if(n.querySelector("svg"))continue;let a=n.id.replace("color-",""),r=parseInt(a),g=n.style.backgroundColor;if(g){let o=g.match(/\d+/g);if(o&&o.length>=3){let m=[parseInt(o[0]),parseInt(o[1]),parseInt(o[2])];c.push({id:r,element:n,rgb:m,name:n.title||n.getAttribute("aria-label")||`Color ${r}`,premium:n.classList.contains("premium")||n.querySelector(".premium")})}}}return i(`[BLUE MARBLE] ${c.length} colores detectados del sitio`),c}setCoords(t,c,n,a){this.coords=[t,c,n,a],i(`[BLUE MARBLE] \u2705 Coordenadas establecidas: tile(${t},${c}) pixel(${n},${a})`),i(`[BLUE MARBLE] \u{1F4CD} Esto significa: imagen empezar\xE1 en posici\xF3n global (${t*this.actualTileSize+n}, ${c*this.actualTileSize+a})`)}async analyzePixels(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");i("[BLUE MARBLE] Analizando p\xEDxeles de la imagen...");try{let c=new OffscreenCanvas(this.imageWidth,this.imageHeight).getContext("2d",{willReadFrequently:!0});c.imageSmoothingEnabled=!1,c.clearRect(0,0,this.imageWidth,this.imageHeight),c.drawImage(this.bitmap,0,0);let n=c.getImageData(0,0,this.imageWidth,this.imageHeight).data,a=0,r=0,g=new Map;for(let m=0;m<this.imageHeight;m++)for(let d=0;d<this.imageWidth;d++){let s=(m*this.imageWidth+d)*4,l=n[s],f=n[s+1],x=n[s+2];if(n[s+3]===0)continue;let p=`${l},${f},${x}`;l===222&&f===250&&x===206&&r++,this.allowedColorsSet.has(p)&&(a++,g.set(p,(g.get(p)||0)+1))}this.requiredPixelCount=a,this.defacePixelCount=r;let o={};for(let[m,d]of g.entries())o[m]={count:d,enabled:!0};return this.colorPalette=o,i("[BLUE MARBLE] An\xE1lisis completado:"),i(`  - P\xEDxeles requeridos: ${a.toLocaleString()}`),i(`  - P\xEDxeles #deface: ${r.toLocaleString()}`),i(`  - Colores \xFAnicos: ${g.size}`),{totalPixels:this.totalPixels,requiredPixels:a,defacePixels:r,uniqueColors:g.size,colorPalette:o}}catch{return this.requiredPixelCount=Math.max(0,this.totalPixels),this.defacePixelCount=0,i("[BLUE MARBLE] Fallback: usando total de p\xEDxeles como requeridos"),{totalPixels:this.totalPixels,requiredPixels:this.totalPixels,defacePixels:0,uniqueColors:0,colorPalette:{}}}}async createTemplateTiles(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");i("[BLUE MARBLE] Creando tiles de template...");let t={},c={},n=new OffscreenCanvas(this.tileSize,this.tileSize),a=n.getContext("2d",{willReadFrequently:!0});for(let r=this.coords[3];r<this.imageHeight+this.coords[3];){let g=Math.min(this.tileSize-r%this.tileSize,this.imageHeight-(r-this.coords[3]));for(let o=this.coords[2];o<this.imageWidth+this.coords[2];){let m=Math.min(this.tileSize-o%this.tileSize,this.imageWidth-(o-this.coords[2])),d=m*this.shreadSize,s=g*this.shreadSize;n.width=d,n.height=s,a.imageSmoothingEnabled=!1,a.clearRect(0,0,d,s),a.drawImage(this.bitmap,o-this.coords[2],r-this.coords[3],m,g,0,0,m*this.shreadSize,g*this.shreadSize);let l=a.getImageData(0,0,d,s);for(let p=0;p<s;p++)for(let P=0;P<d;P++){let b=(p*d+P)*4;if(l.data[b]===222&&l.data[b+1]===250&&l.data[b+2]===206)(P+p)%2===0?(l.data[b]=0,l.data[b+1]=0,l.data[b+2]=0):(l.data[b]=255,l.data[b+1]=255,l.data[b+2]=255),l.data[b+3]=32;else if(P%this.shreadSize!==1||p%this.shreadSize!==1)l.data[b+3]=0;else{let v=l.data[b],A=l.data[b+1],S=l.data[b+2];this.allowedColorsSet.has(`${v},${A},${S}`)||(l.data[b+3]=0)}}a.putImageData(l,0,0);let f=`${(this.coords[0]+Math.floor(o/1e3)).toString().padStart(4,"0")},${(this.coords[1]+Math.floor(r/1e3)).toString().padStart(4,"0")},${(o%1e3).toString().padStart(3,"0")},${(r%1e3).toString().padStart(3,"0")}`;t[f]=await createImageBitmap(n),this.tilePrefixes.add(f.split(",").slice(0,2).join(","));let w=await(await n.convertToBlob()).arrayBuffer();c[f]=w,o+=m}r+=g}return this.templateTiles=t,this.templateTilesBuffers=c,i(`[BLUE MARBLE] Tiles creados: ${Object.keys(t).length} tiles`),i(`[BLUE MARBLE] Prefijos registrados: ${this.tilePrefixes.size} tiles \xFAnicos`),{templateTiles:t,templateTilesBuffers:c}}generatePixelQueue(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");i("[BLUE MARBLE] \u{1F3AF} Iniciando generaci\xF3n de cola de p\xEDxeles..."),i(`[BLUE MARBLE] \u{1F4D0} Tama\xF1o actual de tile: ${this.actualTileSize}`),i(`[BLUE MARBLE] \u{1F5C2}\uFE0F Coordenadas almacenadas: tile(${this.coords[0]},${this.coords[1]}) pixel(${this.coords[2]||0},${this.coords[3]||0})`);let t=[],c=this.coords[0]*this.actualTileSize+(this.coords[2]||0),n=this.coords[1]*this.actualTileSize+(this.coords[3]||0);i(`[BLUE MARBLE] \u{1F4CD} Posici\xF3n base calculada: global(${c}, ${n})`),i(`[BLUE MARBLE] \u{1F4CF} Dimensiones imagen: ${this.imageWidth}x${this.imageHeight}`);let r=new OffscreenCanvas(this.imageWidth,this.imageHeight).getContext("2d",{willReadFrequently:!0});r.imageSmoothingEnabled=!1,r.drawImage(this.bitmap,0,0);let g=r.getImageData(0,0,this.imageWidth,this.imageHeight).data,o=-1,m=-1;e:for(let l=0;l<this.imageHeight;l++)for(let f=0;f<this.imageWidth;f++){let x=(l*this.imageWidth+f)*4,w=g[x],p=g[x+1],P=g[x+2];if(g[x+3]===0||w===222&&p===250&&P===206)continue;let v=`${w},${p},${P}`;if(this.allowedColorsSet.has(v)){o=f,m=l;break e}}if(o===-1)return i("[BLUE MARBLE] \u274C No se encontraron p\xEDxeles v\xE1lidos en la imagen"),[];i(`[BLUE MARBLE] \u{1F3AF} Primer p\xEDxel v\xE1lido encontrado en imagen(${o}, ${m})`);let d=c-o,s=n-m;i(`[BLUE MARBLE] \uFFFD Ajuste aplicado: baseX ${c} - ${o} = ${d}`),i(`[BLUE MARBLE] \u{1F527} Ajuste aplicado: baseY ${n} - ${m} = ${s}`),i(`[BLUE MARBLE] \u2705 Primer p\xEDxel se pintar\xE1 en posici\xF3n global: (${d+o}, ${s+m})`);for(let l=0;l<this.imageHeight;l++)for(let f=0;f<this.imageWidth;f++){let x=(l*this.imageWidth+f)*4,w=g[x],p=g[x+1],P=g[x+2],b=g[x+3];if(b===0||w===222&&p===250&&P===206)continue;let v=`${w},${p},${P}`;if(!this.allowedColorsSet.has(v))continue;let A=d+f,S=s+l;t.length===0&&(i("[BLUE MARBLE] \u{1F3A8} PRIMER P\xCDXEL CON AJUSTE:"),i(`[BLUE MARBLE] \u{1F4CA} Imagen position: (${f}, ${l})`),i(`[BLUE MARBLE] \u{1F4CA} Global position: (${A}, ${S})`),i(`[BLUE MARBLE] \u2705 Esto deber\xEDa coincidir con user click: (${c}, ${n})`),i(`[BLUE MARBLE] \u{1F50D} VERIFICACI\xD3N: \xBFEste es el firstValidPixel(${o}, ${m})?`),f!==o||l!==m?(i(`[BLUE MARBLE] \u274C ERROR: Primer pixel en queue (${f}, ${l}) NO coincide con firstValidPixel (${o}, ${m})`),i("[BLUE MARBLE] \u274C Esto causar\xE1 desalineaci\xF3n! Investigando..."),i(`[BLUE MARBLE] \u{1F41B} Pixel inesperado: color(${w},${p},${P}) alpha(${b}) colorKey(${v})`),i(`[BLUE MARBLE] \u{1F41B} allowedColorsSet.has(${v}): ${this.allowedColorsSet.has(v)}`)):i("[BLUE MARBLE] \u2705 CONFIRMADO: Primer pixel coincide con firstValidPixel"));let y=Math.floor(A/this.actualTileSize),L=Math.floor(S/this.actualTileSize),h=A%this.actualTileSize,C=S%this.actualTileSize,B=this.rgbToMeta.get(v)||{id:0,name:"Unknown"};t.push({imageX:f,imageY:l,globalX:A,globalY:S,tileX:y,tileY:L,localX:h,localY:C,color:{r:w,g:p,b:P,id:B.id,name:B.name},originalColor:{r:w,g:p,b:P,alpha:b}}),t.length===1&&i(`[BLUE MARBLE] \u{1F3A8} Primer p\xEDxel v\xE1lido: imagen(${f},${l}) \u2192 global(${A},${S}) \u2192 tile(${y},${L}) local(${h},${C}) color(${w},${p},${P})`)}if(i(`[BLUE MARBLE] \u2705 Cola generada: ${t.length} p\xEDxeles v\xE1lidos`),i(`[BLUE MARBLE] \u{1F4CA} Rango de p\xEDxeles ajustados: X(${d}-${d+this.imageWidth-1}), Y(${s}-${s+this.imageHeight-1})`),t.length>0){let l=t[0],f=t[t.length-1];i(`[BLUE MARBLE] \u{1F4CB} Primer p\xEDxel: global(${l.globalX},${l.globalY})`),i(`[BLUE MARBLE] \u{1F4CB} \xDAltimo p\xEDxel: global(${f.globalX},${f.globalY})`),i(`[BLUE MARBLE] \u2705 Confirmaci\xF3n: Primer p\xEDxel deber\xEDa estar en user click (${c}, ${n})`)}return t}async resize(t,c,n=!0){if(!this.img)throw new Error("Imagen no cargada. Llama a load() primero.");let a=this.img.width,r=this.img.height;if(n){let d=a/r;t/c>d?t=c*d:c=t/d}let g=document.createElement("canvas");g.width=t,g.height=c;let o=g.getContext("2d");o.imageSmoothingEnabled=!1,o.drawImage(this.img,0,0,t,c);let m=g.toDataURL();return this.img.src=m,this.imageSrc=m,await new Promise(d=>{this.img.onload=async()=>{this.bitmap=await createImageBitmap(this.img),this.imageWidth=this.bitmap.width,this.imageHeight=this.bitmap.height,this.totalPixels=this.imageWidth*this.imageHeight,d()}}),i(`[BLUE MARBLE] Imagen redimensionada: ${a}\xD7${r} \u2192 ${this.imageWidth}\xD7${this.imageHeight}`),{width:this.imageWidth,height:this.imageHeight}}getImageData(){return{width:this.imageWidth,height:this.imageHeight,totalPixels:this.totalPixels,requiredPixels:this.requiredPixelCount,defacePixels:this.defacePixelCount,colorPalette:this.colorPalette,coords:[...this.coords],originalName:this.originalName||"image.png",pixels:this.generatePixelQueue()}}generatePreview(t=200,c=200){if(!this.img)return null;let n=document.createElement("canvas"),a=n.getContext("2d"),{width:r,height:g}=this.img,o=r/g,m,d;return t/c>o?(d=c,m=c*o):(m=t,d=t/o),n.width=m,n.height=d,a.imageSmoothingEnabled=!1,a.drawImage(this.img,0,0,m,d),n.toDataURL()}getDimensions(){return{width:this.imageWidth,height:this.imageHeight}}};var _=u=>new Promise(t=>setTimeout(t,u));var ie="https://backend.wplace.live";async function ae(){var u,t,c;try{let n=await fetch(`${ie}/me`,{credentials:"include"}).then(o=>o.json()),a=n||null,r=(n==null?void 0:n.charges)||{},g={count:(u=r.count)!=null?u:0,max:(t=r.max)!=null?t:0,cooldownMs:(c=r.cooldownMs)!=null?c:3e4};return{success:!0,data:{user:a,charges:g.count,maxCharges:g.max,chargeRegen:g.cooldownMs}}}catch(n){return{success:!1,error:n.message,data:{user:null,charges:0,maxCharges:0,chargeRegen:3e4}}}}async function ne(u,t,c,n,a){try{let r=JSON.stringify({colors:n,coords:c,t:a}),g=await fetch(`${ie}/s0/pixel/${u}/${t}`,{method:"POST",credentials:"include",headers:{"Content-Type":"text/plain;charset=UTF-8"},body:r}),o=null;try{o=await g.json()}catch{o={}}return{status:g.status,json:o,success:g.ok,painted:(o==null?void 0:o.painted)||0}}catch(r){return{status:0,json:{error:r.message},success:!1,painted:0}}}var oe=!1;async function Ee(){if(!(oe||window.turnstile))return new Promise((u,t)=>{let c=document.createElement("script");c.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",c.async=!0,c.defer=!0,c.onload=()=>{oe=!0,u()},c.onerror=()=>t(new Error("No se pudo cargar Turnstile")),document.head.appendChild(c)})}async function ve(u,t="paint"){var c;if(await Ee(),typeof((c=window.turnstile)==null?void 0:c.execute)=="function")try{let n=await window.turnstile.execute(u,{action:t});if(n&&n.length>20)return n}catch{}return await new Promise(n=>{let a=document.createElement("div");a.style.position="fixed",a.style.left="-9999px",document.body.appendChild(a),window.turnstile.render(a,{sitekey:u,callback:r=>{document.body.removeChild(a),n(r)}})})}async function se(u){return ve(u,"paint")}async function re(u,t,c,n,a){var s,l,f;let{width:r,height:g}=u,{x:o,y:m}=t;i(`Iniciando pintado: imagen(${r}x${g}) inicio LOCAL(${o},${m}) tile(${e.tileX},${e.tileY})`),i("[PAINTER] \u{1F50D} DEBUGGING imageState.remainingPixels:"),i(`[PAINTER] \u{1F4CA} exists: ${!!e.remainingPixels}`),i(`[PAINTER] \u{1F4CA} length: ${((s=e.remainingPixels)==null?void 0:s.length)||0}`),i(`[PAINTER] \u{1F4CA} lastPosition: (${((l=e.lastPosition)==null?void 0:l.x)||0}, ${((f=e.lastPosition)==null?void 0:f.y)||0})`);let d=!e.remainingPixels||e.remainingPixels.length===0||e.lastPosition.x===0&&e.lastPosition.y===0;if(i(`[PAINTER] \u{1F4CA} needsGeneration: ${d}`),d){if(i("\u{1F504} Generando cola de p\xEDxeles con Blue Marble Processor..."),e.imageData&&e.imageData.processor){i("\u2705 Usando Blue Marble processor para generar cola...");let x=e.imageData.processor;e.remainingPixels=x.generatePixelQueue(),i(`\u{1F4CA} Blue Marble gener\xF3: ${e.remainingPixels.length} p\xEDxeles con alignment correcto`)}else i("\u26A0\uFE0F FALLBACK: Blue Marble processor no disponible, usando funci\xF3n antigua..."),e.remainingPixels=Le(u,t,e.tileX,e.tileY),i(`\u{1F4CA} Funci\xF3n antigua gener\xF3: ${e.remainingPixels.length} p\xEDxeles (SIN alignment)`);(e.lastPosition.x>0||e.lastPosition.y>0)&&(e.remainingPixels=e.remainingPixels.filter(x=>{let w=x.imageY*r+x.imageX,p=e.lastPosition.y*r+e.lastPosition.x;return w>=p})),i(`Cola generada: ${e.remainingPixels.length} p\xEDxeles pendientes`);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),e.startPosition&&e.tileX!==void 0&&e.tileY!==void 0&&window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:e.tileX,tileY:e.tileY,pxX:e.startPosition.x,pxY:e.startPosition.y}),window.__WPA_PLAN_OVERLAY__.setPlan(e.remainingPixels,{enabled:!0,nextBatchCount:e.pixelsPerBatch}),i(`\u2705 Plan overlay actualizado con ${e.remainingPixels.length} p\xEDxeles en cola`))}catch(x){i("\u26A0\uFE0F Error actualizando plan overlay:",x)}}try{for(;e.remainingPixels.length>0&&!e.stopFlag;){let x=Math.floor(e.currentCharges),w;if(e.isFirstBatch&&e.useAllChargesFirst&&x>0?(w=Math.min(x,e.remainingPixels.length),e.isFirstBatch=!1,i(`Primera pasada: usando ${w} cargas de ${x} disponibles`)):w=Math.min(e.pixelsPerBatch,e.remainingPixels.length),x<w){i(`Cargas insuficientes: ${x}/${w} necesarias`),await Se(w-x,c),x=Math.floor(e.currentCharges),e.isFirstBatch||(w=Math.min(e.pixelsPerBatch,e.remainingPixels.length,x));continue}let p=e.remainingPixels.splice(0,w);i(`Pintando lote de ${p.length} p\xEDxeles...`);try{window.__WPA_PLAN_OVERLAY__&&window.__WPA_PLAN_OVERLAY__.setPlan(e.remainingPixels,{enabled:!0,nextBatchCount:e.pixelsPerBatch})}catch(b){i("\u26A0\uFE0F Error actualizando plan overlay durante pintado:",b)}let P=await Ae(p,c);if(P.success&&P.painted>0){if(e.paintedPixels+=P.painted,e.currentCharges=Math.max(0,e.currentCharges-P.painted),i(`Cargas despu\xE9s del lote: ${e.currentCharges.toFixed(1)} (consumidas: ${P.painted})`),p.length>0){let S=p[p.length-1];e.lastPosition={x:S.imageX,y:S.imageY}}i(`Lote exitoso: ${P.painted}/${p.length} p\xEDxeles pintados. Total: ${e.paintedPixels}/${e.totalPixels}`);let b=Be(),v=(e.paintedPixels/e.totalPixels*100).toFixed(1),A=E("image.passCompleted",{painted:P.painted,percent:v,current:e.paintedPixels,total:e.totalPixels});c&&c(e.paintedPixels,e.totalPixels,A,b),await _(2e3)}else P.shouldContinue?i("Lote fall\xF3 despu\xE9s de todos los reintentos, continuando con siguiente lote..."):(e.remainingPixels.unshift(...p),i("Lote fall\xF3: reintentando en 5 segundos..."),await _(5e3));await _(500)}if(e.stopFlag)i(`Pintado pausado en p\xEDxel imagen(${e.lastPosition.x},${e.lastPosition.y})`),n&&n(!1,e.paintedPixels);else{i(`Pintado completado: ${e.paintedPixels} p\xEDxeles pintados`),e.lastPosition={x:0,y:0},e.remainingPixels=[];try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.setPlan([],{enabled:!0,nextBatchCount:0}),i("\u2705 Plan overlay limpiado al completar pintado"))}catch(x){i("\u26A0\uFE0F Error limpiando plan overlay:",x)}n&&n(!0,e.paintedPixels)}}catch(x){i("Error en proceso de pintado:",x),a&&a(x)}}async function Ce(u){try{if(!u||u.length===0)return{success:!1,painted:0,error:"Lote vac\xEDo"};let t=new Map;for(let a of u){if(!a){i("paintPixelBatch: skipping undefined pixel");continue}if(a.localX==null||a.localY==null||a.tileX==null||a.tileY==null){i("paintPixelBatch: skipping pixel with missing coordinates",a);continue}if(!a.color){i("paintPixelBatch: skipping pixel with missing color",a);continue}let r=a.color.id||a.color.value||null;if(r===null){i("paintPixelBatch: skipping pixel with invalid color",a);continue}let g=`${a.tileX}:${a.tileY}`;t.has(g)||t.set(g,{tileX:a.tileX,tileY:a.tileY,coords:[],colors:[]});let o=t.get(g);o.coords.push(a.localX,a.localY),o.colors.push(r),t.get(g).coords.length<=6&&i(`[PAINTER] \u{1F3A8} Pixel ${Math.ceil(t.get(g).coords.length/2)}: tile(${a.tileX},${a.tileY}) local(${a.localX},${a.localY}) imagePos(${a.imageX||"?"},${a.imageY||"?"}) color(${r})`)}if(t.size===0)return{success:!1,painted:0,error:"No valid pixels in batch"};let c=await se(z.SITEKEY),n=0;for(let[a,r]of t.entries())try{let g=await ne(r.tileX,r.tileY,r.coords,r.colors,c);g.status===200?n+=g.painted||0:i("paintPixelBatch: API error for tile",a,g==null?void 0:g.status,g==null?void 0:g.json)}catch(g){i("Error sending pixels for tile group:",a,g)}return{success:n>0,painted:n}}catch(t){return i("Error en paintPixelBatch:",t),{success:!1,painted:0,error:t.message}}}async function Ae(u,t){for(let r=1;r<=5;r++)try{let g=await Ce(u);if(g.success)return e.retryCount=0,g;if(e.retryCount=r,r<5){let o=3e3*Math.pow(2,r-1),m=Math.round(o/1e3),d;g.status===0||g.status==="NetworkError"?d=E("image.networkError"):g.status>=500?d=E("image.serverError"):g.status===408?d=E("image.timeoutError"):d=E("image.retryAttempt",{attempt:r,maxAttempts:5,delay:m}),t&&t(e.paintedPixels,e.totalPixels,d),i(`Reintento ${r}/5 despu\xE9s de ${m}s. Error: ${g.error}`),await _(o)}}catch(g){if(i(`Error en intento ${r}:`,g),e.retryCount=r,r<5){let o=3e3*Math.pow(2,r-1),m=Math.round(o/1e3),d=E("image.retryError",{attempt:r,maxAttempts:5,delay:m});t&&t(e.paintedPixels,e.totalPixels,d),await _(o)}}e.retryCount=5;let a=E("image.retryFailed",{maxAttempts:5});return t&&t(e.paintedPixels,e.totalPixels,a),i("Fall\xF3 despu\xE9s de 5 intentos, continuando con siguiente lote"),{success:!1,painted:0,error:"Fall\xF3 despu\xE9s de 5 intentos",shouldContinue:!0}}async function Se(u,t){let n=z.CHARGE_REGEN_MS*u+5e3;if(i(`Esperando ${Math.round(n/1e3)}s para obtener ${u} cargas`),e.inCooldown=!0,e.cooldownEndTime=Date.now()+n,e.nextBatchCooldown=Math.round(n/1e3),t){let a=Math.floor(n/6e4),r=Math.floor(n%6e4/1e3),g=a>0?`${a}m ${r}s`:`${r}s`,o=E("image.waitingChargesRegen",{current:Math.floor(e.currentCharges),needed:u,time:g});t(e.paintedPixels,e.totalPixels,o)}for(let a=Math.round(n/1e3);a>0&&!e.stopFlag;a--){if(e.nextBatchCooldown=a,t&&(a%5===0||a<=10||a===Math.round(n/1e3))){let r=Math.floor(a/60),g=a%60,o=r>0?`${r}m ${g}s`:`${g}s`,m=E("image.waitingChargesCountdown",{current:Math.floor(e.currentCharges),needed:u,time:o});t(e.paintedPixels,e.totalPixels,m)}await _(1e3)}e.inCooldown=!1,e.nextBatchCooldown=0,e.currentCharges=Math.min(e.maxCharges||50,e.currentCharges+n/z.CHARGE_REGEN_MS)}function Le(u,t,c,n){var d,s;let{pixels:a}=u,{x:r,y:g}=t,o=[],m=0;for(let l of a){let f=typeof l.x=="number"&&typeof l.y=="number"||typeof l.imageX=="number"&&typeof l.imageY=="number";if(!l||!f){m++,i("generatePixelQueue: skipping pixel with missing coordinates",l);continue}let x=(d=l.imageX)!=null?d:l.x,w=(s=l.imageY)!=null?s:l.y,p=l.color||l.targetColor;if(!p||!p.id&&!p.value){m++,i("generatePixelQueue: skipping pixel with missing/invalid color",l);continue}let P,b,v,A;if(l.tileX!=null&&l.tileY!=null&&l.localX!=null&&l.localY!=null)P=l.tileX,b=l.tileY,v=l.localX,A=l.localY;else{let S=r+x,y=g+w;P=c,b=n,v=S,A=y}o.push({imageX:x,imageY:w,localX:v,localY:A,tileX:P,tileY:b,color:p,originalColor:l.originalColor})}return m>0&&i(`\u26A0\uFE0F Se omitieron ${m} p\xEDxeles inv\xE1lidos durante la generaci\xF3n de la cola`),i(`Cola de p\xEDxeles generada: ${o.length} p\xEDxeles para pintar`),o}function Be(){if(!e.remainingPixels||e.remainingPixels.length===0)return 0;let u=e.remainingPixels.length,t=e.pixelsPerBatch,c=z.CHARGE_REGEN_MS/1e3,n=Math.ceil(u/t),a=t*c,r=(n-1)*a,g=n*2;return Math.ceil(r+g)}function j(){e.stopFlag=!0,e.running=!1,i("\u{1F6D1} Deteniendo proceso de pintado...")}function G(u=null){try{if(!e.imageData||e.paintedPixels===0)throw new Error("No hay progreso para guardar");let t={version:"1.0",timestamp:Date.now(),imageData:{width:e.imageData.width,height:e.imageData.height,originalName:e.originalImageName},progress:{paintedPixels:e.paintedPixels,totalPixels:e.totalPixels,lastPosition:{...e.lastPosition}},position:{startPosition:{...e.startPosition},tileX:e.tileX,tileY:e.tileY},config:{pixelsPerBatch:e.pixelsPerBatch,useAllChargesFirst:e.useAllChargesFirst,isFirstBatch:e.isFirstBatch,maxCharges:e.maxCharges},colors:e.availableColors.map(o=>({id:o.id,r:o.r,g:o.g,b:o.b})),remainingPixels:e.remainingPixels||[]},c=JSON.stringify(t,null,2),n=new window.Blob([c],{type:"application/json"}),a=u||`wplace_progress_${e.originalImageName||"image"}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,r=window.URL.createObjectURL(n),g=document.createElement("a");return g.href=r,g.download=a,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(r),i(`\u2705 Progreso guardado: ${a}`),{success:!0,filename:a}}catch(t){return i("\u274C Error guardando progreso:",t),{success:!1,error:t.message}}}async function ce(u){return new Promise(t=>{try{let c=new window.FileReader;c.onload=n=>{try{let a=JSON.parse(n.target.result),g=["imageData","progress","position","colors"].filter(o=>!(o in a));if(g.length>0)throw new Error(`Campos requeridos faltantes: ${g.join(", ")}`);if(e.availableColors.length>0){let o=a.colors.map(s=>s.id),m=e.availableColors.map(s=>s.id);o.filter(s=>m.includes(s)).length<o.length*.8&&i("\u26A0\uFE0F Los colores guardados no coinciden completamente con los actuales")}e.imageData={...a.imageData,pixels:[]},e.paintedPixels=a.progress.paintedPixels,e.totalPixels=a.progress.totalPixels,a.progress.lastPosition?e.lastPosition=a.progress.lastPosition:a.position.lastX!==void 0&&a.position.lastY!==void 0&&(e.lastPosition={x:a.position.lastX,y:a.position.lastY}),a.position.startPosition?e.startPosition=a.position.startPosition:a.position.startX!==void 0&&a.position.startY!==void 0&&(e.startPosition={x:a.position.startX,y:a.position.startY}),e.tileX=a.position.tileX,e.tileY=a.position.tileY,e.originalImageName=a.imageData.originalName,e.remainingPixels=a.remainingPixels||a.progress.remainingPixels||[];try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),e.startPosition&&e.tileX!==void 0&&e.tileY!==void 0&&(window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:e.tileX,tileY:e.tileY,pxX:e.startPosition.x,pxY:e.startPosition.y}),i(`\u2705 Plan overlay anclado con posici\xF3n cargada: tile(${e.tileX},${e.tileY}) local(${e.startPosition.x},${e.startPosition.y})`)),window.__WPA_PLAN_OVERLAY__.setPlan(e.remainingPixels,{enabled:!0,nextBatchCount:e.pixelsPerBatch}),i(`\u2705 Plan overlay activado con ${e.remainingPixels.length} p\xEDxeles restantes`))}catch(o){i("\u26A0\uFE0F Error activando plan overlay al cargar progreso:",o)}a.config&&(e.pixelsPerBatch=a.config.pixelsPerBatch||e.pixelsPerBatch,e.useAllChargesFirst=a.config.useAllChargesFirst!==void 0?a.config.useAllChargesFirst:e.useAllChargesFirst,e.isFirstBatch=a.config.isFirstBatch!==void 0?a.config.isFirstBatch:!0,e.maxCharges=a.config.maxCharges||e.maxCharges),e.imageLoaded=!0,e.colorsChecked=!0,i(`\u2705 Progreso cargado: ${e.paintedPixels}/${e.totalPixels} p\xEDxeles`),t({success:!0,data:a,painted:e.paintedPixels,total:e.totalPixels,canContinue:e.remainingPixels.length>0})}catch(a){i("\u274C Error parseando archivo de progreso:",a),t({success:!1,error:a.message})}},c.onerror=()=>{let n="Error leyendo archivo";i("\u274C",n),t({success:!1,error:n})},c.readAsText(u)}catch(c){i("\u274C Error cargando progreso:",c),t({success:!1,error:c.message})}})}function de(){e.paintedPixels=0,e.totalPixels=0,e.lastPosition={x:0,y:0},e.remainingPixels=[],e.imageData=null,e.startPosition=null,e.imageLoaded=!1,e.originalImageName=null,e.isFirstBatch=!0,e.nextBatchCooldown=0,i("\u{1F9F9} Progreso limpiado")}function le(){return e.imageLoaded&&e.paintedPixels>0&&e.remainingPixels&&e.remainingPixels.length>0}function ue(){return{hasProgress:le(),painted:e.paintedPixels,total:e.totalPixels,remaining:e.remainingPixels?e.remainingPixels.length:0,percentage:e.totalPixels>0?e.paintedPixels/e.totalPixels*100:0,lastPosition:{...e.lastPosition},canContinue:le()}}function ge(u=null){let t=document.createElement("div");u&&(t.id=u),t.style.cssText=`
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 2147483647;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  `;let c=t.attachShadow({mode:"open"});return document.body.appendChild(t),{host:t,root:c}}function pe(u,t){let c=0,n=0,a=0,r=0;u.style.cursor="move",u.addEventListener("mousedown",g);function g(d){d.target.closest(".header-btn, .wplace-header-btn")||(d.preventDefault(),a=d.clientX,r=d.clientY,document.addEventListener("mouseup",m),document.addEventListener("mousemove",o))}function o(d){d.preventDefault(),c=a-d.clientX,n=r-d.clientY,a=d.clientX,r=d.clientY,t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-c+"px"}function m(){document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",o)}}async function me({texts:u,...t}){if(i("\u{1F3A8} Creando interfaz de Auto-Image"),!document.querySelector('link[href*="font-awesome"]')){let h=document.createElement("link");h.rel="stylesheet",h.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",document.head.appendChild(h),i("\u{1F4E6} FontAwesome a\xF1adido al document.head")}let{host:c,root:n}=ge(),a=document.createElement("style");a.textContent=`
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0, 255, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0); }
    }
    
    .container {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 300px;
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 0;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      z-index: 9998;
      font-family: 'Segoe UI', Roboto, sans-serif;
      color: #eee;
      animation: slideIn 0.4s ease-out;
      overflow: hidden;
    }
    
    .header {
      padding: 12px 15px;
      background: #2d3748;
      color: #60a5fa;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: move;
      user-select: none;
    }
    
    .header-title {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .header-controls {
      display: flex;
      gap: 10px;
    }
    
    .header-btn {
      background: none;
      border: none;
      color: #eee;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
      padding: 5px;
    }
    
    .header-btn:hover {
      opacity: 1;
    }
    
    .content {
      padding: 15px;
      display: block;
    }
    
    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .config-panel {
      display: none;
      background: #2d3748;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    
    .config-panel.visible {
      display: block;
    }
    
    .config-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .config-input {
      width: 60px;
      padding: 4px;
      border: 1px solid #333;
      border-radius: 4px;
      background: #1a1a1a;
      color: #eee;
      text-align: center;
    }
    
    .config-checkbox {
      margin-right: 8px;
    }
    
    .main-config {
      background: #2d3748;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 10px;
      border: 1px solid #3a4553;
    }
    
    .config-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    
    .config-label {
      font-size: 13px;
      color: #cbd5e0;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .batch-value, .cooldown-value {
      font-weight: bold;
      color: #60a5fa;
    }
    
    .btn {
      padding: 10px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
      font-size: 14px;
    }
    
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }
    
    .btn-primary {
      background: #60a5fa;
      color: white;
    }
    
    .btn-upload {
      background: #2d3748;
      color: white;
      border: 1px dashed #eee;
    }
    
    .btn-load {
      background: #2196F3;
      color: white;
    }
    
    .btn-start {
      background: #10b981;
      color: white;
    }
    
    .btn-stop {
      background: #ef4444;
      color: white;
    }
    
    .btn-select {
      background: #f59e0b;
      color: black;
    }
    
    .progress {
      width: 100%;
      background: #2d3748;
      border-radius: 4px;
      margin: 10px 0;
      overflow: hidden;
      height: 10px;
    }
    
    .progress-bar {
      height: 100%;
      background: #60a5fa;
      transition: width 0.3s;
      width: 0%;
    }
    
    .stats {
      background: #2d3748;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
    }
    
    .stat-item {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
      font-size: 14px;
    }
    
    .stat-label {
      display: flex;
      align-items: center;
      gap: 6px;
      opacity: 0.8;
    }
    
    .status {
      padding: 8px;
      border-radius: 4px;
      text-align: center;
      font-size: 13px;
    }
    
    .status-default {
      background: rgba(255,255,255,0.1);
    }
    
    .status-success {
      background: rgba(0, 255, 0, 0.1);
      color: #10b981;
    }
    
    .status-error {
      background: rgba(255, 0, 0, 0.1);
      color: #ef4444;
    }
    
    .status-warning {
      background: rgba(255, 165, 0, 0.1);
      color: orange;
    }
    
    .status-info {
      background: rgba(0, 150, 255, 0.1);
      color: #60a5fa;
    }
    
    .minimized .content {
      display: none;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 10001;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal {
      background: #1a1a1a;
      border: 2px solid #333;
      border-radius: 15px;
      padding: 25px;
      color: #eee;
      min-width: 350px;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    
    .modal h3 {
      margin: 0 0 15px 0;
      text-align: center;
      font-size: 18px;
    }
    
    .modal p {
      margin: 0 0 20px 0;
      text-align: center;
      line-height: 1.4;
    }
    
    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    
    .modal-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 100px;
    }
    
    .modal-btn-save {
      background: #10b981;
      color: white;
    }
    
    .modal-btn-discard {
      background: #ef4444;
      color: white;
    }
    
    .modal-btn-cancel {
      background: #2d3748;
      color: white;
    }
    
    .modal-btn:hover {
      transform: translateY(-2px);
    }
    
    /* Resize Dialog Styles */
    .resize-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 9999;
      display: none;
    }
    
    .resize-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      z-index: 10000;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      max-width: 90%;
      max-height: 90%;
      overflow: auto;
      color: #ffffff;
      display: none;
    }
    
    .resize-container h3 {
      margin: 0 0 15px 0;
      color: #ffffff;
    }
    
    .resize-controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 15px;
    }
    
    .resize-controls label {
      color: #ffffff;
      font-size: 14px;
    }
    
    .resize-slider {
      width: 100%;
      margin: 5px 0;
    }
    
    .resize-preview {
      max-width: 100%;
      max-height: 300px;
      margin: 10px 0;
      border: 1px solid #333;
      display: block;
    }
    
    .resize-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
  `,n.appendChild(a);let r=document.createElement("div");r.className="container",r.innerHTML=`
    <div class="header">
      <div class="header-title">
        \u{1F5BC}\uFE0F
        <span>${u.title}</span>
      </div>
      <div class="header-controls">
        <button class="header-btn config-btn" title="Configuraci\xF3n">
          \u2699\uFE0F
        </button>
        <button class="header-btn minimize-btn" title="${u.minimize}">
          \u2796
        </button>
      </div>
    </div>
    <div class="content">
      <div class="config-panel">
        <div class="config-item">
          <label>${u.batchSize}:</label>
          <input class="config-input pixels-per-batch" type="number" min="1" max="50" value="20">
        </div>
        <div class="config-item">
          <label>
            <input class="config-checkbox use-all-charges" type="checkbox" checked>
            ${u.useAllCharges}
          </label>
        </div>
        <div class="config-item">
          <label>
            <input class="config-checkbox show-overlay" type="checkbox" checked>
            ${u.showOverlay||"Mostrar overlay"}
          </label>
        </div>
      </div>
      
      <!-- Configuraci\xF3n visible en la interfaz principal -->
      <div class="main-config">
        <div class="config-row">
          <div class="config-label">
            \u{1F3AF} ${u.batchSize}:
            <span class="batch-value">20</span>
          </div>
          <div class="config-label">
            \u23F1\uFE0F ${u.nextBatchTime}:
            <span class="cooldown-value">--</span>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn btn-primary init-btn">
          \u{1F916}
          <span>${u.initBot}</span>
        </button>
        <button class="btn btn-upload upload-btn" disabled>
          \u{1F4E4}
          <span>${u.uploadImage}</span>
        </button>
        <button class="btn btn-load load-progress-btn" disabled>
          \u{1F4C1}
          <span>${u.loadProgress}</span>
        </button>
        <button class="btn btn-primary resize-btn" disabled>
          \u{1F504}
          <span>${u.resizeImage}</span>
        </button>
        <button class="btn btn-select select-pos-btn" disabled>
          \u{1F3AF}
          <span>${u.selectPosition}</span>
        </button>
        <button class="btn btn-start start-btn" disabled>
          \u25B6\uFE0F
          <span>${u.startPainting}</span>
        </button>
        <button class="btn btn-stop stop-btn" disabled>
          \u23F9\uFE0F
          <span>${u.stopPainting}</span>
        </button>
      </div>
      
      <div class="progress">
        <div class="progress-bar"></div>
      </div>
      
      <div class="stats">
        <div class="stats-area">
          <div class="stat-item">
            <div class="stat-label">\u2139\uFE0F ${u.initMessage}</div>
          </div>
        </div>
      </div>
      
      <div class="status status-default">
        ${u.waitingInit}
      </div>
    </div>
  `,n.appendChild(r);let g=document.createElement("input");g.type="file",g.accept="image/png,image/jpeg",g.style.display="none",n.appendChild(g);let o=document.createElement("input");o.type="file",o.accept=".json",o.style.display="none",n.appendChild(o);let m=document.createElement("div");m.className="resize-overlay",n.appendChild(m);let d=document.createElement("div");d.className="resize-container",d.innerHTML=`
    <h3>${u.resizeImage}</h3>
    <div class="resize-controls">
      <label>
        ${u.width}: <span class="width-value">0</span>px
        <input type="range" class="resize-slider width-slider" min="10" max="500" value="100">
      </label>
      <label>
        ${u.height}: <span class="height-value">0</span>px
        <input type="range" class="resize-slider height-slider" min="10" max="500" value="100">
      </label>
      <label>
        <input type="checkbox" class="keep-aspect" checked>
        ${u.keepAspect}
      </label>
      <img class="resize-preview" src="" alt="Preview">
      <div class="resize-buttons">
        <button class="btn btn-primary confirm-resize">
          \u2705
          <span>${u.apply}</span>
        </button>
        <button class="btn btn-stop cancel-resize">
          \u274C
          <span>${u.cancel}</span>
        </button>
      </div>
    </div>
  `,n.appendChild(d);let s={header:r.querySelector(".header"),configBtn:r.querySelector(".config-btn"),minimizeBtn:r.querySelector(".minimize-btn"),configPanel:r.querySelector(".config-panel"),pixelsPerBatch:r.querySelector(".pixels-per-batch"),useAllCharges:r.querySelector(".use-all-charges"),showOverlay:r.querySelector(".show-overlay"),batchValue:r.querySelector(".batch-value"),cooldownValue:r.querySelector(".cooldown-value"),initBtn:r.querySelector(".init-btn"),uploadBtn:r.querySelector(".upload-btn"),loadProgressBtn:r.querySelector(".load-progress-btn"),resizeBtn:r.querySelector(".resize-btn"),selectPosBtn:r.querySelector(".select-pos-btn"),startBtn:r.querySelector(".start-btn"),stopBtn:r.querySelector(".stop-btn"),progressBar:r.querySelector(".progress-bar"),statsArea:r.querySelector(".stats-area"),status:r.querySelector(".status"),content:r.querySelector(".content")},l={overlay:m,container:d,widthSlider:d.querySelector(".width-slider"),heightSlider:d.querySelector(".height-slider"),widthValue:d.querySelector(".width-value"),heightValue:d.querySelector(".height-value"),keepAspect:d.querySelector(".keep-aspect"),preview:d.querySelector(".resize-preview"),confirmBtn:d.querySelector(".confirm-resize"),cancelBtn:d.querySelector(".cancel-resize")},f={minimized:!1,configVisible:!1};pe(s.header,r),s.minimizeBtn.addEventListener("click",()=>{f.minimized=!f.minimized,f.minimized?(r.classList.add("minimized"),s.minimizeBtn.innerHTML="\u{1F53C}"):(r.classList.remove("minimized"),s.minimizeBtn.innerHTML="\u{1F53D}")}),s.configBtn.addEventListener("click",()=>{f.configVisible=!f.configVisible,f.configVisible?(s.configPanel.classList.add("visible"),s.configBtn.innerHTML="\u274C"):(s.configPanel.classList.remove("visible"),s.configBtn.innerHTML="\u2699\uFE0F")}),s.pixelsPerBatch.addEventListener("change",()=>{let h=parseInt(s.pixelsPerBatch.value)||20;s.batchValue.textContent=h,t.onConfigChange&&t.onConfigChange({pixelsPerBatch:h})}),s.useAllCharges.addEventListener("change",()=>{t.onConfigChange&&t.onConfigChange({useAllCharges:s.useAllCharges.checked})});function x(){s.uploadBtn.disabled=!1,s.loadProgressBtn.disabled=!1}s.initBtn.addEventListener("click",async()=>{s.initBtn.disabled=!0,t.onInitBot&&await t.onInitBot()&&x(),s.initBtn.disabled=!1}),s.uploadBtn.addEventListener("click",()=>{g.click()}),g.addEventListener("change",async()=>{g.files.length>0&&t.onUploadImage&&await t.onUploadImage(g.files[0])&&(s.selectPosBtn.disabled=!1,s.resizeBtn.disabled=!1)}),s.loadProgressBtn.addEventListener("click",()=>{o.click()}),o.addEventListener("change",async()=>{o.files.length>0&&t.onLoadProgress&&await t.onLoadProgress(o.files[0])&&(s.selectPosBtn.disabled=!1,s.startBtn.disabled=!1,s.resizeBtn.disabled=!1)}),s.resizeBtn.addEventListener("click",()=>{t.onResizeImage&&t.onResizeImage()}),s.selectPosBtn.addEventListener("click",async()=>{t.onSelectPosition&&(s.selectPosBtn.disabled=!0,await t.onSelectPosition()&&(s.startBtn.disabled=!1),s.selectPosBtn.disabled=!1)}),s.showOverlay.addEventListener("change",()=>{if(!window.__WPA_PLAN_OVERLAY__)return;window.__WPA_PLAN_OVERLAY__.injectStyles();let h=s.showOverlay.checked;window.__WPA_PLAN_OVERLAY__.setEnabled(h)}),s.startBtn.addEventListener("click",async()=>{t.onStartPainting&&(s.startBtn.disabled=!0,s.stopBtn.disabled=!1,await t.onStartPainting()||(s.startBtn.disabled=!1,s.stopBtn.disabled=!0))}),s.stopBtn.addEventListener("click",async()=>{t.onStopPainting&&await t.onStopPainting()&&(s.startBtn.disabled=!1,s.stopBtn.disabled=!0)});function w(h,C="default"){s.status.textContent=h,s.status.className=`status status-${C}`,s.status.style.animation="none",s.status.offsetWidth,s.status.style.animation="slideIn 0.3s ease-out"}function p(h){let{width:C,height:B}=h.getDimensions(),I=C/B;l.widthSlider.value=C,l.heightSlider.value=B,l.widthValue.textContent=C,l.heightValue.textContent=B,l.preview.src=h.img.src,l.overlay.style.display="block",l.container.style.display="block";let $=()=>{let M=parseInt(l.widthSlider.value),k=parseInt(l.heightSlider.value);l.widthValue.textContent=M,l.heightValue.textContent=k,l.preview.src=h.generatePreview(M,k)},T=()=>{if(l.keepAspect.checked){let M=parseInt(l.widthSlider.value),k=Math.round(M/I);l.heightSlider.value=k}$()},R=()=>{if(l.keepAspect.checked){let M=parseInt(l.heightSlider.value),k=Math.round(M*I);l.widthSlider.value=k}$()};l.widthSlider.addEventListener("input",T),l.heightSlider.addEventListener("input",R);let O=()=>{let M=parseInt(l.widthSlider.value),k=parseInt(l.heightSlider.value);t.onConfirmResize&&t.onConfirmResize(h,M,k),P()},D=()=>{P()};l.confirmBtn.addEventListener("click",O),l.cancelBtn.addEventListener("click",D),l.overlay.addEventListener("click",D),window.cleanupResizeDialog=()=>{l.widthSlider.removeEventListener("input",T),l.heightSlider.removeEventListener("input",R),l.confirmBtn.removeEventListener("click",O),l.cancelBtn.removeEventListener("click",D),l.overlay.removeEventListener("click",D)},$()}function P(){l.overlay.style.display="none",l.container.style.display="none",window.cleanupResizeDialog&&(window.cleanupResizeDialog(),delete window.cleanupResizeDialog)}function b(h,C,B=null){let I=C>0?h/C*100:0;s.progressBar.style.width=`${I}%`;let $=`
      <div class="stat-item">
        <div class="stat-label">\u{1F3A8} ${u.progress}</div>
        <div>${h}/${C} (${I.toFixed(1)}%)</div>
      </div>
    `;if(B&&(B.username&&($+=`
          <div class="stat-item">
            <div class="stat-label">\u{1F464} ${u.userName}</div>
            <div>${B.username}</div>
          </div>
        `),B.charges!==void 0&&($+=`
          <div class="stat-item">
            <div class="stat-label">\u26A1 ${u.charges}</div>
            <div>${Math.floor(B.charges)}</div>
          </div>
        `),B.pixels!==void 0&&($+=`
          <div class="stat-item">
            <div class="stat-label">\u{1F533} ${u.pixels}</div>
            <div>${B.pixels.toLocaleString()}</div>
          </div>
        `),B.estimatedTime!==void 0&&B.estimatedTime>0)){let T=Math.floor(B.estimatedTime/3600),R=Math.floor(B.estimatedTime%3600/60),O=T>0?`${T}h ${R}m`:`${R}m`;$+=`
          <div class="stat-item">
            <div class="stat-label">\u23F0 ${u.timeRemaining}</div>
            <div>${O}</div>
          </div>
        `}s.statsArea.innerHTML=$}function v(h){if(h>0){let C=Math.floor(h/60),B=h%60,I=C>0?`${C}m ${B}s`:`${B}s`;s.cooldownValue.textContent=I}else s.cooldownValue.textContent="--"}function A(h){h&&h.includes("\u23F3")?(s.status.textContent=h,s.status.className="status status-info"):h&&w(h,"info")}function S(h){h?(s.initBtn.disabled=!0,s.initBtn.style.opacity="0.6",s.initBtn.innerHTML=`\u2705 <span>${u.initBot} - Completado</span>`):(s.initBtn.disabled=!1,s.initBtn.style.opacity="1",s.initBtn.innerHTML=`\u{1F916} <span>${u.initBot}</span>`)}function y(h){s.initBtn.style.display=h?"flex":"none"}function L(){c.remove()}return i("\u2705 Interfaz de Auto-Image creada"),{setStatus:w,updateProgress:b,updateCooldownDisplay:v,updateCooldownMessage:A,setInitialized:S,setInitButtonVisible:y,enableButtonsAfterInit:x,showResizeDialog:p,closeResizeDialog:P,destroy:L}}function he(u,t,c={}){return new Promise(n=>{let a=document.createElement("div");a.className="modal-overlay",a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.background="rgba(0,0,0,0.7)",a.style.zIndex="10001",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center";let r=document.createElement("div");r.style.background="#1a1a1a",r.style.border="2px solid #333",r.style.borderRadius="15px",r.style.padding="25px",r.style.color="#eee",r.style.minWidth="350px",r.style.maxWidth="400px",r.style.boxShadow="0 10px 30px rgba(0,0,0,0.5)",r.style.fontFamily="'Segoe UI', Roboto, sans-serif",r.innerHTML=`
      <h3 style="margin: 0 0 15px 0; text-align: center; font-size: 18px;">${t}</h3>
      <p style="margin: 0 0 20px 0; text-align: center; line-height: 1.4;">${u}</p>
      <div style="display: flex; gap: 10px; justify-content: center;">
        ${c.save?`<button class="save-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #10b981; color: white;">${c.save}</button>`:""}
        ${c.discard?`<button class="discard-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #ef4444; color: white;">${c.discard}</button>`:""}
        ${c.cancel?`<button class="cancel-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #2d3748; color: white;">${c.cancel}</button>`:""}
      </div>
    `,a.appendChild(r),document.body.appendChild(a);let g=r.querySelector(".save-btn"),o=r.querySelector(".discard-btn"),m=r.querySelector(".cancel-btn"),d=()=>{document.body.removeChild(a)};g&&g.addEventListener("click",()=>{d(),n("save")}),o&&o.addEventListener("click",()=>{d(),n("discard")}),m&&m.addEventListener("click",()=>{d(),n("cancel")}),a.addEventListener("click",s=>{s.target===a&&(d(),n("cancel"))})})}function Z(){let u=['[data-testid="color-picker"]',".color-picker",".palette",'[class*="color"][class*="picker"]','[class*="palette"]'];for(let n of u){let a=document.querySelector(n);if(a&&a.offsetParent!==null)return!0}let t=document.querySelectorAll('[style*="background-color"], [style*="background:"], .color, [class*="color"]'),c=0;for(let n of t)if(n.offsetParent!==null&&n.offsetWidth>10&&n.offsetHeight>10&&(c++,c>=5))return!0;return!1}function fe(){let u=document.querySelector("button.btn.btn-primary.btn-lg, button.btn.btn-primary.sm\\:btn-xl");if(u){let n=u.textContent.toLowerCase().includes("paint"),a=u.querySelector('svg path[d*="240-120"]');if(n||a)return u.click(),!0}let t=document.querySelectorAll("button");for(let c of t)if(c.textContent.toLowerCase().includes("paint")&&c.offsetParent!==null&&!c.disabled)return c.click(),!0;return!1}(()=>{let t={enabled:!1,templates:[],templatesShouldBeDrawn:!0,tileSize:1e3,drawMult:3,pixelPlan:null,nextBatchCount:0,anchor:null,imageWidth:null,imageHeight:null,originalFetch:null,fetchedBlobQueue:new Map,isIntercepting:!1};function c(){console.log("[PLAN OVERLAY] Blue Marble tile system initialized")}function n(){t.isIntercepting||(t.originalFetch=window.fetch,t.isIntercepting=!0,window.fetch=async function(...p){var S;let P=await t.originalFetch.apply(this,p),b=P.clone(),v=(p[0]instanceof Request?(S=p[0])==null?void 0:S.url:p[0])||"ignore";if((b.headers.get("content-type")||"").includes("image/")&&v.includes("/tiles/")&&!v.includes("openfreemap")&&!v.includes("maps")){console.log("[PLAN OVERLAY] Intercepting tile request:",v);try{let y=await b.blob(),L=await r(y,v);return new Response(L,{headers:b.headers,status:b.status,statusText:b.statusText})}catch(y){return console.error("[PLAN OVERLAY] Error processing tile:",y),P}}return P},console.log("[PLAN OVERLAY] Fetch interception started"))}function a(){!t.isIntercepting||!t.originalFetch||(window.fetch=t.originalFetch,t.isIntercepting=!1,console.log("[PLAN OVERLAY] Fetch interception stopped"))}async function r(p,P){if(!t.enabled||!t.templatesShouldBeDrawn||!t.pixelPlan)return p;let b=P.split("/"),v=parseInt(b[b.length-1].replace(".png","")),A=parseInt(b[b.length-2]);if(isNaN(A)||isNaN(v))return console.warn("[PLAN OVERLAY] Could not extract tile coordinates from URL:",P),p;console.log(`[PLAN OVERLAY] Processing tile: ${A},${v}`);let S=g(A,v);if(S.length===0)return p;console.log(`[PLAN OVERLAY] Found ${S.length} pixels for tile ${A},${v}`);let y=t.tileSize*t.drawMult,L=await createImageBitmap(p),h=new OffscreenCanvas(y,y),C=h.getContext("2d");return C.imageSmoothingEnabled=!1,C.clearRect(0,0,y,y),C.drawImage(L,0,0,y,y),o(C,S,A,v),await h.convertToBlob({type:"image/png"})}function g(p,P){return!t.pixelPlan||!t.pixelPlan.pixels?[]:t.pixelPlan.pixels.filter(b=>{let v=Math.floor(b.globalX/4e3),A=Math.floor(b.globalY/4e3);return v===p&&A===P})}function o(p,P,b,v){let A=b*4e3,S=v*4e3;p.globalAlpha=.7;for(let y of P){let L=(y.globalX-A)*t.drawMult+1,h=(y.globalY-S)*t.drawMult+1;L>=0&&L<t.tileSize*t.drawMult&&h>=0&&h<t.tileSize*t.drawMult&&(p.fillStyle=`rgb(${y.r},${y.g},${y.b})`,p.fillRect(L,h,1,1))}if(t.nextBatchCount>0){p.globalAlpha=1;let y=P.slice(0,t.nextBatchCount);for(let L of y){let h=(L.globalX-A)*t.drawMult+1,C=(L.globalY-S)*t.drawMult+1;h>=0&&h<t.tileSize*t.drawMult&&C>=0&&C<t.tileSize*t.drawMult&&(p.fillStyle=`rgb(${L.r},${L.g},${L.b})`,p.fillRect(h,C,1,1))}}}function m(p){t.enabled=!!p,t.enabled?n():a(),console.log(`[PLAN OVERLAY] setEnabled: ${t.enabled}`)}function d(p,P={}){var v,A,S;if(!p||p.length===0){t.pixelPlan=null,console.log("[PLAN OVERLAY] Plan cleared");return}let b=[];for(let y of p){let L,h;if(typeof y.tileX=="number"&&typeof y.localX=="number")L=y.tileX*4e3+y.localX,h=y.tileY*4e3+y.localY;else if(P.anchor&&typeof y.imageX=="number"){let C=P.anchor.tileX*4e3+(P.anchor.pxX||0),B=P.anchor.tileY*4e3+(P.anchor.pxY||0);L=C+y.imageX,h=B+y.imageY}else continue;b.push({globalX:L,globalY:h,r:((v=y.color)==null?void 0:v.r)||0,g:((A=y.color)==null?void 0:A.g)||0,b:((S=y.color)==null?void 0:S.b)||0})}t.pixelPlan={pixels:b},t.nextBatchCount=P.nextBatchCount||0,t.anchor=P.anchor||null,t.imageWidth=P.imageWidth||null,t.imageHeight=P.imageHeight||null,console.log(`[PLAN OVERLAY] Plan set: ${b.length} pixels`),typeof P.enabled=="boolean"&&m(P.enabled)}function s(p){t.nextBatchCount=Math.max(0,Number(p||0)),console.log(`[PLAN OVERLAY] Next batch count: ${t.nextBatchCount}`)}function l(p){t.anchor=p,console.log("[PLAN OVERLAY] Anchor set:",p)}function f(p,P){console.log("[PLAN OVERLAY] CSS anchor set (ignored in tile system):",{x:p,y:P})}function x(){console.log("[PLAN OVERLAY] Selection mode ended (ignored in tile system)")}function w(){a(),t.pixelPlan=null,t.fetchedBlobQueue.clear(),console.log("[PLAN OVERLAY] Cleanup completed")}window.__WPA_PLAN_OVERLAY__={injectStyles:c,setEnabled:m,setPlan:d,setPlanItemsFromTileList:d,setNextBatchCount:s,setAnchor:l,setAnchorCss:f,endSelectionMode:x,render:()=>{},cleanup:w,get state(){return t}},console.log("[PLAN OVERLAY] Blue Marble tile system ready")})();async function xe(){i("\u{1F680} Iniciando WPlace Auto-Image (versi\xF3n modular)"),U(),window.__wplaceBot={...window.__wplaceBot,imageRunning:!0};let u=null,t=window.fetch,c=()=>{window.fetch!==t&&(window.fetch=t,i("\u{1F504} Fetch original restaurado")),e.positionTimeoutId&&(clearTimeout(e.positionTimeoutId),e.positionTimeoutId=null),e.cleanupObserver&&(e.cleanupObserver(),e.cleanupObserver=null),e.selectingPosition=!1};try{let n={...z},a=q("image");if(e.language=te(),!n.SITEKEY){let d=document.querySelector("*[data-sitekey]");d?(n.SITEKEY=d.getAttribute("data-sitekey"),i(`\u{1F4DD} Sitekey encontrada autom\xE1ticamente: ${n.SITEKEY.substring(0,20)}...`)):i("\u26A0\uFE0F No se pudo encontrar la sitekey autom\xE1ticamente")}async function r(){return i("\u{1F916} Intentando auto-inicio..."),Z()?(i("\u{1F3A8} Paleta de colores ya est\xE1 abierta"),!0):(i("\u{1F50D} Paleta no encontrada, buscando bot\xF3n Paint..."),fe()?(i("\u{1F446} Bot\xF3n Paint encontrado y presionado"),await _(2e3),Z()?(i("\u2705 Paleta abierta exitosamente"),!0):(i("\u274C La paleta no se abri\xF3 despu\xE9s de hacer clic"),!1)):(i("\u274C Bot\xF3n Paint no encontrado"),!1))}async function g(d=!1){i("\u{1F916} Inicializando Auto-Image..."),o.setStatus(E("image.checkingColors"),"info");let s=H();if(s.length===0)return o.setStatus(E("image.noColorsFound"),"error"),!1;let l=await ae(),f=null;l.success&&l.data.user?(f={username:l.data.user.name||"An\xF3nimo",charges:l.data.charges,maxCharges:l.data.maxCharges,pixels:l.data.user.pixelsPainted||0},u=f,e.currentCharges=l.data.charges,e.maxCharges=l.data.maxCharges||50,i(`\u{1F464} Usuario conectado: ${l.data.user.name||"An\xF3nimo"} - Cargas: ${f.charges}/${f.maxCharges} - P\xEDxeles: ${f.pixels}`)):i("\u26A0\uFE0F No se pudo obtener informaci\xF3n del usuario"),e.availableColors=s,e.colorsChecked=!0,o.setStatus(E("image.colorsFound",{count:s.length}),"success"),o.updateProgress(0,0,f),d||i(`\u2705 ${s.length} colores disponibles detectados`),o.setInitialized(!0),o.enableButtonsAfterInit();try{}catch{}return!0}let o=await me({texts:a,onConfigChange:d=>{d.pixelsPerBatch!==void 0&&(e.pixelsPerBatch=d.pixelsPerBatch),d.useAllCharges!==void 0&&(e.useAllChargesFirst=d.useAllCharges),i("Configuraci\xF3n actualizada:",d)},onInitBot:g,onUploadImage:async d=>{try{o.setStatus(E("image.loadingImage"),"info");let s=window.URL.createObjectURL(d),l=new X(s);l.originalName=d.name,await l.load();let f=l.initializeColorPalette();e.availableColors=f;let x=await l.analyzePixels();l.setCoords(0,0,0,0);let w=l.getImageData();e.imageData=w,e.imageData.processor=l,e.totalPixels=x.requiredPixels,e.paintedPixels=0,e.originalImageName=d.name,e.imageLoaded=!0,o.setStatus(E("image.imageLoaded",{count:x.requiredPixels}),"success"),o.updateProgress(0,x.requiredPixels,u),i(`\u2705 [BLUE MARBLE] Imagen cargada: ${w.width}x${w.height}, ${x.requiredPixels} p\xEDxeles v\xE1lidos`),i(`\u2705 [BLUE MARBLE] An\xE1lisis: ${x.uniqueColors} colores \xFAnicos, ${x.defacePixels} p\xEDxeles #deface`),window.URL.revokeObjectURL(s);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),window.__WPA_PLAN_OVERLAY__.setPlan([],{enabled:!0,nextBatchCount:0}),i("\u2705 Plan overlay activado autom\xE1ticamente al cargar imagen"))}catch(p){i("\u26A0\uFE0F Error activando plan overlay:",p)}return!0}catch(s){return o.setStatus(E("image.imageError"),"error"),i("\u274C Error cargando imagen:",s),!1}},onSelectPosition:async()=>new Promise(d=>{o.setStatus(E("image.selectPositionAlert"),"info"),o.setStatus(E("image.waitingPosition"),"info"),e.selectingPosition=!0;let s=!1,l=()=>{window.fetch=async(w,p)=>{var P,b,v,A,S;if(e.selectingPosition&&!s&&typeof w=="string"&&w.includes("/s0/pixel/")&&p&&p.method==="POST")try{i(`\u{1F3AF} Interceptando request de pintado: ${w}`);let y=await t(w,p);if(y.ok&&p.body){let L;try{L=JSON.parse(p.body)}catch(h){return i("Error parseando body del request:",h),y}if(L.coords&&Array.isArray(L.coords)&&L.coords.length>=2){let h=L.coords[0],C=L.coords[1];i(`[AUTO-IMAGE] \u{1F446} Usuario hizo clic: local(${h}, ${C})`);let B=w.match(/\/s0\/pixel\/(-?\d+)\/(-?\d+)/);if(B&&!s){s=!0;let I=parseInt(B[1]),$=parseInt(B[2]);if(i(`[AUTO-IMAGE] \u{1F4CD} Posici\xF3n capturada: tile(${I}, ${$}) + pixel(${h}, ${C})`),i(`[AUTO-IMAGE] \u{1F30D} Esto corresponde a coordenada global: (${I*4e3+h}, ${$*4e3+C})`),e.tileX=I,e.tileY=$,e.startPosition={x:h,y:C},e.selectingPosition=!1,e.imageData&&e.imageData.processor){let T=e.imageData.processor;i("[AUTO-IMAGE] \u{1F504} Processor encontrado. Estado antes de setCoords:"),i(`[AUTO-IMAGE] \u{1F4CA} Processor coords actuales: [${T.coords.join(",")}]`),i(`[AUTO-IMAGE] \u{1F504} Llamando setCoords(${I}, ${$}, ${h}, ${C})`),T.setCoords(I,$,h,C),i(`[AUTO-IMAGE] \u{1F4CA} Processor coords despu\xE9s de setCoords: [${T.coords.join(",")}]`);try{await T.createTemplateTiles(),i(`\u2705 [BLUE MARBLE] Template tiles creados para posici\xF3n tile(${I},${$}) pixel(${h},${C})`)}catch(O){i(`\u274C [BLUE MARBLE] Error creando template tiles: ${O.message}`)}let R=T.generatePixelQueue();e.remainingPixels=R,e.totalPixels=R.length,i(`\u2705 Cola de p\xEDxeles generada: ${R.length} p\xEDxeles para overlay`),i(`[AUTO-IMAGE] \u{1F4CA} imageState.remainingPixels set to: ${((P=e.remainingPixels)==null?void 0:P.length)||0} pixels`),i(`[AUTO-IMAGE] \u{1F4CA} First pixel from Blue Marble: global(${(b=R[0])==null?void 0:b.globalX}, ${(v=R[0])==null?void 0:v.globalY}) local(${(A=R[0])==null?void 0:A.localX}, ${(S=R[0])==null?void 0:S.localY})`)}else i("[AUTO-IMAGE] \u274C ERROR: Processor no encontrado!"),i(`[AUTO-IMAGE] \u{1F4CA} imageState.imageData existe: ${!!e.imageData}`),e.imageData&&i(`[AUTO-IMAGE] \u{1F4CA} imageState.imageData.processor existe: ${!!e.imageData.processor}`);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:I,tileY:$,pxX:h,pxY:C}),e.remainingPixels&&e.remainingPixels.length>0?(window.__WPA_PLAN_OVERLAY__.setPlan(e.remainingPixels,{anchor:{tileX:I,tileY:$,pxX:h,pxY:C},imageWidth:e.imageData.width,imageHeight:e.imageData.height,enabled:!0}),i(`\u2705 Plan overlay anclado en tile(${I},${$}) local(${h},${C})`)):i("\u26A0\uFE0F No hay p\xEDxeles para mostrar en overlay"))}catch(T){i(`\u274C Error configurando overlay: ${T.message}`)}c(),o.setStatus(E("image.positionSet"),"success"),i(`\u2705 Posici\xF3n establecida: tile(${e.tileX},${e.tileY}) local(${h},${C})`),d(!0)}else i("\u26A0\uFE0F No se pudo extraer tile de la URL:",w)}}return y}catch(y){if(i("\u274C Error interceptando pixel:",y),!s)return c(),t(w,p)}return t(w,p)}},f=()=>{let w=document.querySelectorAll("canvas");if(w.length===0){i("\u26A0\uFE0F No se encontraron elementos canvas");return}i(`\u{1F4CA} Configurando observer para ${w.length} canvas`);let p=P=>{var v;if(!e.selectingPosition||s)return;let b=P.target;if(b&&b.tagName==="CANVAS"){i("\u{1F5B1}\uFE0F Click detectado en canvas durante selecci\xF3n");try{let S=(((v=document.querySelector("canvas"))==null?void 0:v.parentElement)||document.body).getBoundingClientRect(),y=P.clientX-S.left,L=P.clientY-S.top;window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.setAnchorCss(y,L),i(`Plan overlay: ancla CSS establecida en (${y}, ${L})`))}catch(A){i("Plan Overlay: error calculando ancla CSS",A)}setTimeout(()=>{!s&&e.selectingPosition&&i("\u{1F50D} Buscando requests recientes de pintado...")},500)}};document.addEventListener("click",p),e.cleanupObserver=()=>{document.removeEventListener("click",p)}};l(),f();let x=setTimeout(()=>{e.selectingPosition&&!s&&(c(),e.cleanupObserver&&e.cleanupObserver(),o.setStatus(E("image.positionTimeout"),"error"),i("\u23F0 Timeout en selecci\xF3n de posici\xF3n"),d(!1))},12e4);e.positionTimeoutId=x}),onStartPainting:async()=>{var d;if(i("\u{1F50D} Estado para iniciar pintura:",{imageLoaded:e.imageLoaded,startPosition:e.startPosition,tileX:e.tileX,tileY:e.tileY,totalPixels:e.totalPixels,remainingPixels:((d=e.remainingPixels)==null?void 0:d.length)||0}),!e.imageLoaded||!e.startPosition)return o.setStatus(E("image.missingRequirements"),"error"),i(`\u274C Validaci\xF3n fallida: imageLoaded=${e.imageLoaded}, startPosition=${!!e.startPosition}`),!1;e.running=!0,e.stopFlag=!1,e.isFirstBatch=!0,o.setStatus(E("image.startPaintingMsg"),"success");try{return await re(e.imageData,e.startPosition,(s,l,f,x)=>{u&&(u.charges=Math.floor(e.currentCharges),x!==void 0&&(u.estimatedTime=x)),o.updateProgress(s,l,u),e.inCooldown&&e.nextBatchCooldown>0?o.updateCooldownDisplay(e.nextBatchCooldown):o.updateCooldownDisplay(0),f?f.includes("\u23F3")&&e.inCooldown?o.updateCooldownMessage(f):o.setStatus(f,"info"):o.setStatus(E("image.paintingProgress",{painted:s,total:l}),"info")},(s,l)=>{s?(o.setStatus(E("image.paintingComplete",{count:l}),"success"),de()):o.setStatus(E("image.paintingStopped"),"warning"),e.running=!1},s=>{o.setStatus(E("image.paintingError"),"error"),i("\u274C Error en proceso de pintado:",s),e.running=!1}),!0}catch(s){return o.setStatus(E("image.paintingError"),"error"),i("\u274C Error iniciando pintado:",s),e.running=!1,!1}},onStopPainting:async()=>{if(ue().hasProgress){let s=await he(E("image.confirmSaveProgress"),E("image.saveProgressTitle"),{save:E("image.saveProgress"),discard:E("image.discardProgress"),cancel:E("image.cancel")});if(s==="save"){let l=G();l.success?o.setStatus(E("image.progressSaved",{filename:l.filename}),"success"):o.setStatus(E("image.progressSaveError",{error:l.error}),"error")}else if(s==="cancel")return!1}return j(),o.setStatus(E("image.paintingStopped"),"warning"),!0},onSaveProgress:async()=>{let d=G();return d.success?o.setStatus(E("image.progressSaved",{filename:d.filename}),"success"):o.setStatus(E("image.progressSaveError",{error:d.error}),"error"),d.success},onLoadProgress:async d=>{try{let s=await ce(d);return s.success?(o.setStatus(E("image.progressLoaded",{painted:s.painted,total:s.total}),"success"),o.updateProgress(s.painted,s.total,u),i("\u2705 Progreso cargado - habilitando botones de inicio"),!0):(o.setStatus(E("image.progressLoadError",{error:s.error}),"error"),!1)}catch(s){return o.setStatus(E("image.progressLoadError",{error:s.message}),"error"),!1}},onResizeImage:()=>{e.imageLoaded&&e.imageData&&e.imageData.processor&&o.showResizeDialog(e.imageData.processor)},onConfirmResize:async(d,s,l)=>{i(`\u{1F504} Redimensionando imagen de ${d.getDimensions().width}x${d.getDimensions().height} a ${s}x${l}`);try{await d.resize(s,l);let f=await d.analyzePixels();e.imageData={processor:d,width:s,height:l,validPixelCount:f.validPixelCount,totalPixels:f.totalPixels,unknownPixels:f.unknownPixels},e.totalPixels=f.validPixelCount,e.paintedPixels=0,e.remainingPixels=[],e.lastPosition={x:0,y:0},o.updateProgress(0,f.validPixelCount,u),o.setStatus(E("image.resizeSuccess",{width:s,height:l}),"success"),i(`\u2705 Imagen redimensionada: ${f.validPixelCount} p\xEDxeles v\xE1lidos de ${f.totalPixels} totales`);try{if(window.__WPA_PLAN_OVERLAY__&&e.startPosition&&e.tileX!=null&&e.tileY!=null){await d.createTemplateTiles();let x=d.generatePixelQueue();e.remainingPixels=x,e.totalPixels=x.length,window.__WPA_PLAN_OVERLAY__.setPlan(x,{anchor:{tileX:e.tileX,tileY:e.tileY,pxX:e.startPosition.x,pxY:e.startPosition.y},imageWidth:s,imageHeight:l,enabled:!0}),i(`\u2705 Overlay actualizado con ${x.length} p\xEDxeles despu\xE9s del resize`)}}catch(x){i(`\u26A0\uFE0F Error actualizando overlay despu\xE9s del resize: ${x.message}`)}}catch(f){i(`\u274C Error redimensionando imagen: ${f.message}`),o.setStatus(E("image.imageError"),"error")}}}),m=d=>{let{language:s}=d.detail;i(`\u{1F30D} Imagen: Detectado cambio de idioma desde launcher: ${s}`),e.language=s};window.addEventListener("launcherLanguageChanged",m),window.addEventListener("languageChanged",m),window.addEventListener("beforeunload",()=>{c(),j(),o.destroy(),window.removeEventListener("launcherLanguageChanged",m),window.removeEventListener("languageChanged",m),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1)}),i("\u2705 Auto-Image inicializado correctamente"),setTimeout(async()=>{try{o.setStatus(E("image.autoInitializing"),"info"),i("\u{1F916} Intentando auto-inicio..."),await r()?(o.setStatus(E("image.autoInitSuccess"),"success"),i("\u2705 Auto-inicio exitoso"),o.setInitButtonVisible(!1),await g(!0)&&i("\u{1F680} Bot auto-iniciado completamente")):(o.setStatus(E("image.autoInitFailed"),"warning"),i("\u26A0\uFE0F Auto-inicio fall\xF3, se requiere inicio manual"))}catch(d){i("\u274C Error en auto-inicio:",d),o.setStatus(E("image.manualInitRequired"),"warning")}},1e3)}catch(n){throw i("\u274C Error inicializando Auto-Image:",n),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1),n}}(()=>{"use strict";var u,t;if((u=window.__wplaceBot)!=null&&u.imageRunning){alert("Auto-Image ya est\xE1 corriendo.");return}if((t=window.__wplaceBot)!=null&&t.farmRunning){alert("Auto-Farm est\xE1 ejecut\xE1ndose. Ci\xE9rralo antes de iniciar Auto-Image.");return}window.__wplaceBot||(window.__wplaceBot={}),window.__wplaceBot.imageRunning=!0,xe().catch(c=>{console.error("[BOT] Error en Auto-Image:",c),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1),alert("Auto-Image: error inesperado. Revisa consola.")})})();})();
