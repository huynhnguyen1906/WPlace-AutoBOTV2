/* WPlace AutoBOT â€” uso bajo tu responsabilidad. Compilado 2025-08-23T23:27:10.713Z */
(()=>{var P={debugEnabled:!1,setDebug(g){this.debugEnabled=!!g},debug(...g){this.debugEnabled&&console.debug("[BOT]",...g)},info(...g){console.info("[BOT]",...g)},warn(...g){console.warn("[BOT]",...g)},error(...g){console.error("[BOT]",...g)}},o=(...g)=>console.log("[WPA-UI]",...g);var te={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"Selecci\xF3n",user:"Usuario",charges:"Cargas",backend:"Backend",database:"Database",uptime:"Uptime",close:"Cerrar",launch:"Lanzar",loading:"Cargando\u2026",executing:"Ejecutando\u2026",downloading:"Descargando script\u2026",chooseBot:"Elige un bot y presiona Lanzar",readyToLaunch:"Listo para lanzar",loadError:"Error al cargar",loadErrorMsg:"No se pudo cargar el bot seleccionado. Revisa tu conexi\xF3n o int\xE9ntalo de nuevo.",checking:"\u{1F504} Verificando...",online:"\u{1F7E2} Online",offline:"\u{1F534} Offline",ok:"\u{1F7E2} OK",error:"\u{1F534} Error",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Iniciar Auto-BOT",uploadImage:"Subir Imagen",resizeImage:"Redimensionar Imagen",selectPosition:"Seleccionar Posici\xF3n",startPainting:"Iniciar Pintura",stopPainting:"Detener Pintura",saveProgress:"Guardar Progreso",loadProgress:"Cargar Progreso",checkingColors:"\u{1F50D} Verificando colores disponibles...",noColorsFound:"\u274C \xA1Abre la paleta de colores en el sitio e int\xE9ntalo de nuevo!",colorsFound:"\u2705 {count} colores disponibles encontrados",loadingImage:"\u{1F5BC}\uFE0F Cargando imagen...",imageLoaded:"\u2705 Imagen cargada con {count} p\xEDxeles v\xE1lidos",imageError:"\u274C Error al cargar la imagen",selectPositionAlert:"\xA1Pinta el primer p\xEDxel en la ubicaci\xF3n donde quieres que comience el arte!",waitingPosition:"\u{1F446} Esperando que pintes el p\xEDxel de referencia...",positionSet:"\u2705 \xA1Posici\xF3n establecida con \xE9xito!",positionTimeout:"\u274C Tiempo agotado para seleccionar posici\xF3n",positionDetected:"\u{1F3AF} Posici\xF3n detectada, procesando...",positionError:"\u274C Error detectando posici\xF3n, int\xE9ntalo de nuevo",startPaintingMsg:"\u{1F3A8} Iniciando pintura...",paintingProgress:"\u{1F9F1} Progreso: {painted}/{total} p\xEDxeles...",noCharges:"\u231B Sin cargas. Esperando {time}...",paintingStopped:"\u23F9\uFE0F Pintura detenida por el usuario",paintingComplete:"\u2705 \xA1Pintura completada! {count} p\xEDxeles pintados.",paintingError:"\u274C Error durante la pintura",missingRequirements:"\u274C Carga una imagen y selecciona una posici\xF3n primero",progress:"Progreso",userName:"Usuario",pixels:"P\xEDxeles",charges:"Cargas",estimatedTime:"Tiempo estimado",initMessage:"Haz clic en 'Iniciar Auto-BOT' para comenzar",waitingInit:"Esperando inicializaci\xF3n...",resizeSuccess:"\u2705 Imagen redimensionada a {width}x{height}",paintingPaused:"\u23F8\uFE0F Pintura pausada en la posici\xF3n X: {x}, Y: {y}",pixelsPerBatch:"P\xEDxeles por lote",batchSize:"Tama\xF1o del lote",nextBatchTime:"Siguiente lote en",useAllCharges:"Usar todas las cargas disponibles",showOverlay:"Mostrar overlay",maxCharges:"Cargas m\xE1ximas por lote",waitingForCharges:"\u23F3 Esperando cargas: {current}/{needed}",timeRemaining:"Tiempo restante",cooldownWaiting:"\u23F3 Esperando {time} para continuar...",progressSaved:"\u2705 Progreso guardado como {filename}",progressLoaded:"\u2705 Progreso cargado: {painted}/{total} p\xEDxeles pintados",progressLoadError:"\u274C Error al cargar progreso: {error}",progressSaveError:"\u274C Error al guardar progreso: {error}",confirmSaveProgress:"\xBFDeseas guardar el progreso actual antes de detener?",saveProgressTitle:"Guardar Progreso",discardProgress:"Descartar",cancel:"Cancelar",minimize:"Minimizar",width:"Ancho",height:"Alto",keepAspect:"Mantener proporci\xF3n",apply:"Aplicar",overlayOn:"Overlay: ON",overlayOff:"Overlay: OFF",passCompleted:"\u2705 Pasada completada: {painted} p\xEDxeles pintados | Progreso: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Esperando regeneraci\xF3n de cargas: {current}/{needed} - Tiempo: {time}",waitingChargesCountdown:"\u23F3 Esperando cargas: {current}/{needed} - Quedan: {time}",autoInitializing:"\u{1F916} Inicializando autom\xE1ticamente...",autoInitSuccess:"\u2705 Bot iniciado autom\xE1ticamente",autoInitFailed:"\u26A0\uFE0F No se pudo iniciar autom\xE1ticamente. Usa el bot\xF3n manual.",paletteDetected:"\u{1F3A8} Paleta de colores detectada",paletteNotFound:"\u{1F50D} Buscando paleta de colores...",clickingPaintButton:"\u{1F446} Haciendo clic en el bot\xF3n Paint...",paintButtonNotFound:"\u274C Bot\xF3n Paint no encontrado",manualInitRequired:"\u{1F527} Inicio manual requerido",retryAttempt:"\u{1F504} Reintento {attempt}/{maxAttempts} en {delay}s...",retryError:"\u{1F4A5} Error en intento {attempt}/{maxAttempts}, reintentando en {delay}s...",retryFailed:"\u274C Fall\xF3 despu\xE9s de {maxAttempts} intentos. Continuando con siguiente lote...",networkError:"\u{1F310} Error de red. Reintentando...",serverError:"\u{1F525} Error del servidor. Reintentando...",timeoutError:"\u23F0 Timeout del servidor. Reintentando..."},farm:{title:"WPlace Farm Bot",start:"Iniciar",stop:"Detener",stopped:"Bot detenido",calibrate:"Calibrar",paintOnce:"Una vez",checkingStatus:"Verificando estado...",configuration:"Configuraci\xF3n",delay:"Delay (ms)",pixelsPerBatch:"P\xEDxeles/lote",minCharges:"Cargas m\xEDn",colorMode:"Modo color",random:"Aleatorio",fixed:"Fijo",range:"Rango",fixedColor:"Color fijo",advanced:"Avanzado",tileX:"Tile X",tileY:"Tile Y",customPalette:"Paleta personalizada",paletteExample:"ej: #FF0000,#00FF00,#0000FF",capture:"Capturar",painted:"Pintados",charges:"Cargas",retries:"Fallos",tile:"Tile",configSaved:"Configuraci\xF3n guardada",configLoaded:"Configuraci\xF3n cargada",configReset:"Configuraci\xF3n reiniciada",captureInstructions:"Pinta un p\xEDxel manualmente para capturar coordenadas...",backendOnline:"Backend Online",backendOffline:"Backend Offline",startingBot:"Iniciando bot...",stoppingBot:"Deteniendo bot...",calibrating:"Calibrando...",alreadyRunning:"Auto-Farm ya est\xE1 corriendo.",imageRunningWarning:"Auto-Image est\xE1 ejecut\xE1ndose. Ci\xE9rralo antes de iniciar Auto-Farm.",selectPosition:"Seleccionar Zona",selectPositionAlert:"\u{1F3AF} Pinta un p\xEDxel en una zona DESPOBLADA del mapa para establecer el \xE1rea de farming",waitingPosition:"\u{1F446} Esperando que pintes el p\xEDxel de referencia...",positionSet:"\u2705 \xA1Zona establecida! Radio: 500px",positionTimeout:"\u274C Tiempo agotado para seleccionar zona",missingPosition:"\u274C Selecciona una zona primero usando 'Seleccionar Zona'",farmRadius:"Radio farm",positionInfo:"Zona actual",farmingInRadius:"\u{1F33E} Farming en radio {radius}px desde ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANTE: Selecciona una zona DESPOBLADA para evitar conflictos",noPosition:"Sin zona",currentZone:"Zona: ({x},{y})",autoSelectPosition:"\u{1F3AF} Selecciona una zona primero. Pinta un p\xEDxel en el mapa para establecer la zona de farming"},common:{yes:"S\xED",no:"No",ok:"Aceptar",cancel:"Cancelar",close:"Cerrar",save:"Guardar",load:"Cargar",delete:"Eliminar",edit:"Editar",start:"Iniciar",stop:"Detener",pause:"Pausar",resume:"Reanudar",reset:"Reiniciar",settings:"Configuraci\xF3n",help:"Ayuda",about:"Acerca de",language:"Idioma",loading:"Cargando...",error:"Error",success:"\xC9xito",warning:"Advertencia",info:"Informaci\xF3n",languageChanged:"Idioma cambiado a {language}"}};var ie={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"Selection",user:"User",charges:"Charges",backend:"Backend",database:"Database",uptime:"Uptime",close:"Close",launch:"Launch",loading:"Loading\u2026",executing:"Executing\u2026",downloading:"Downloading script\u2026",chooseBot:"Choose a bot and press Launch",readyToLaunch:"Ready to launch",loadError:"Load error",loadErrorMsg:"Could not load the selected bot. Check your connection or try again.",checking:"\u{1F504} Checking...",online:"\u{1F7E2} Online",offline:"\u{1F534} Offline",ok:"\u{1F7E2} OK",error:"\u{1F534} Error",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Initialize Auto-BOT",uploadImage:"Upload Image",resizeImage:"Resize Image",selectPosition:"Select Position",startPainting:"Start Painting",stopPainting:"Stop Painting",saveProgress:"Save Progress",loadProgress:"Load Progress",checkingColors:"\u{1F50D} Checking available colors...",noColorsFound:"\u274C Open the color palette on the site and try again!",colorsFound:"\u2705 Found {count} available colors",loadingImage:"\u{1F5BC}\uFE0F Loading image...",imageLoaded:"\u2705 Image loaded with {count} valid pixels",imageError:"\u274C Error loading image",selectPositionAlert:"Paint the first pixel at the location where you want the art to start!",waitingPosition:"\u{1F446} Waiting for you to paint the reference pixel...",positionSet:"\u2705 Position set successfully!",positionTimeout:"\u274C Timeout for position selection",positionDetected:"\u{1F3AF} Position detected, processing...",positionError:"\u274C Error detecting position, please try again",startPaintingMsg:"\u{1F3A8} Starting painting...",paintingProgress:"\u{1F9F1} Progress: {painted}/{total} pixels...",noCharges:"\u231B No charges. Waiting {time}...",paintingStopped:"\u23F9\uFE0F Painting stopped by user",paintingComplete:"\u2705 Painting completed! {count} pixels painted.",paintingError:"\u274C Error during painting",missingRequirements:"\u274C Load an image and select a position first",progress:"Progress",userName:"User",pixels:"Pixels",charges:"Charges",estimatedTime:"Estimated time",initMessage:"Click 'Initialize Auto-BOT' to begin",waitingInit:"Waiting for initialization...",resizeSuccess:"\u2705 Image resized to {width}x{height}",paintingPaused:"\u23F8\uFE0F Painting paused at position X: {x}, Y: {y}",pixelsPerBatch:"Pixels per batch",batchSize:"Batch size",nextBatchTime:"Next batch in",useAllCharges:"Use all available charges",showOverlay:"Show overlay",maxCharges:"Max charges per batch",waitingForCharges:"\u23F3 Waiting for charges: {current}/{needed}",timeRemaining:"Time remaining",cooldownWaiting:"\u23F3 Waiting {time} to continue...",progressSaved:"\u2705 Progress saved as {filename}",progressLoaded:"\u2705 Progress loaded: {painted}/{total} pixels painted",progressLoadError:"\u274C Error loading progress: {error}",progressSaveError:"\u274C Error saving progress: {error}",confirmSaveProgress:"Do you want to save the current progress before stopping?",saveProgressTitle:"Save Progress",discardProgress:"Discard",cancel:"Cancel",minimize:"Minimize",width:"Width",height:"Height",keepAspect:"Keep aspect ratio",apply:"Apply",overlayOn:"Overlay: ON",overlayOff:"Overlay: OFF",passCompleted:"\u2705 Pass completed: {painted} pixels painted | Progress: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Waiting for charge regeneration: {current}/{needed} - Time: {time}",waitingChargesCountdown:"\u23F3 Waiting for charges: {current}/{needed} - Remaining: {time}",autoInitializing:"\u{1F916} Auto-initializing...",autoInitSuccess:"\u2705 Bot auto-started successfully",autoInitFailed:"\u26A0\uFE0F Could not auto-start. Use manual button.",paletteDetected:"\u{1F3A8} Color palette detected",paletteNotFound:"\u{1F50D} Searching for color palette...",clickingPaintButton:"\u{1F446} Clicking Paint button...",paintButtonNotFound:"\u274C Paint button not found",manualInitRequired:"\u{1F527} Manual initialization required",retryAttempt:"\u{1F504} Retry {attempt}/{maxAttempts} in {delay}s...",retryError:"\u{1F4A5} Error in attempt {attempt}/{maxAttempts}, retrying in {delay}s...",retryFailed:"\u274C Failed after {maxAttempts} attempts. Continuing with next batch...",networkError:"\u{1F310} Network error. Retrying...",serverError:"\u{1F525} Server error. Retrying...",timeoutError:"\u23F0 Server timeout. Retrying..."},farm:{title:"WPlace Farm Bot",start:"Start",stop:"Stop",stopped:"Bot stopped",calibrate:"Calibrate",paintOnce:"Once",checkingStatus:"Checking status...",configuration:"Configuration",delay:"Delay (ms)",pixelsPerBatch:"Pixels/batch",minCharges:"Min charges",colorMode:"Color mode",random:"Random",fixed:"Fixed",range:"Range",fixedColor:"Fixed color",advanced:"Advanced",tileX:"Tile X",tileY:"Tile Y",customPalette:"Custom palette",paletteExample:"e.g: #FF0000,#00FF00,#0000FF",capture:"Capture",painted:"Painted",charges:"Charges",retries:"Retries",tile:"Tile",configSaved:"Configuration saved",configLoaded:"Configuration loaded",configReset:"Configuration reset",captureInstructions:"Paint a pixel manually to capture coordinates...",backendOnline:"Backend Online",backendOffline:"Backend Offline",startingBot:"Starting bot...",stoppingBot:"Stopping bot...",calibrating:"Calibrating...",alreadyRunning:"Auto-Farm is already running.",imageRunningWarning:"Auto-Image is running. Close it before starting Auto-Farm.",selectPosition:"Select Area",selectPositionAlert:"\u{1F3AF} Paint a pixel in an EMPTY area of the map to set the farming zone",waitingPosition:"\u{1F446} Waiting for you to paint the reference pixel...",positionSet:"\u2705 Area set! Radius: 500px",positionTimeout:"\u274C Timeout for area selection",missingPosition:"\u274C Select an area first using 'Select Area'",farmRadius:"Farm radius",positionInfo:"Current area",farmingInRadius:"\u{1F33E} Farming in {radius}px radius from ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANT: Select an EMPTY area to avoid conflicts",noPosition:"No area",currentZone:"Zone: ({x},{y})",autoSelectPosition:"\u{1F3AF} Select an area first. Paint a pixel on the map to set the farming zone"},common:{yes:"Yes",no:"No",ok:"OK",cancel:"Cancel",close:"Close",save:"Save",load:"Load",delete:"Delete",edit:"Edit",start:"Start",stop:"Stop",pause:"Pause",resume:"Resume",reset:"Reset",settings:"Settings",help:"Help",about:"About",language:"Language",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",languageChanged:"Language changed to {language}"}};var ae={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} Auto-Farm",autoImage:"\u{1F3A8} Auto-Image",selection:"S\xE9lection",user:"Utilisateur",charges:"Charges",backend:"Backend",database:"Base de donn\xE9es",uptime:"Temps actif",close:"Fermer",launch:"Lancer",loading:"Chargement\u2026",executing:"Ex\xE9cution\u2026",downloading:"T\xE9l\xE9chargement du script\u2026",chooseBot:"Choisissez un bot et appuyez sur Lancer",readyToLaunch:"Pr\xEAt \xE0 lancer",loadError:"Erreur de chargement",loadErrorMsg:"Impossible de charger le bot s\xE9lectionn\xE9. V\xE9rifiez votre connexion ou r\xE9essayez.",checking:"\u{1F504} V\xE9rification...",online:"\u{1F7E2} En ligne",offline:"\u{1F534} Hors ligne",ok:"\u{1F7E2} OK",error:"\u{1F534} Erreur",unknown:"-"},image:{title:"WPlace Auto-Image",initBot:"Initialiser Auto-BOT",uploadImage:"T\xE9l\xE9charger Image",resizeImage:"Redimensionner Image",selectPosition:"S\xE9lectionner Position",startPainting:"Commencer Peinture",stopPainting:"Arr\xEAter Peinture",saveProgress:"Sauvegarder Progr\xE8s",loadProgress:"Charger Progr\xE8s",checkingColors:"\u{1F50D} V\xE9rification des couleurs disponibles...",noColorsFound:"\u274C Ouvrez la palette de couleurs sur le site et r\xE9essayez!",colorsFound:"\u2705 {count} couleurs disponibles trouv\xE9es",loadingImage:"\u{1F5BC}\uFE0F Chargement de l'image...",imageLoaded:"\u2705 Image charg\xE9e avec {count} pixels valides",imageError:"\u274C Erreur lors du chargement de l'image",selectPositionAlert:"Peignez le premier pixel \xE0 l'emplacement o\xF9 vous voulez que l'art commence!",waitingPosition:"\u{1F446} En attente que vous peigniez le pixel de r\xE9f\xE9rence...",positionSet:"\u2705 Position d\xE9finie avec succ\xE8s!",positionTimeout:"\u274C D\xE9lai d\xE9pass\xE9 pour la s\xE9lection de position",positionDetected:"\u{1F3AF} Position d\xE9tect\xE9e, traitement...",positionError:"\u274C Erreur d\xE9tectant la position, essayez \xE0 nouveau",startPaintingMsg:"\u{1F3A8} D\xE9but de la peinture...",paintingProgress:"\u{1F9F1} Progr\xE8s: {painted}/{total} pixels...",noCharges:"\u231B Aucune charge. Attendre {time}...",paintingStopped:"\u23F9\uFE0F Peinture arr\xEAt\xE9e par l'utilisateur",paintingComplete:"\u2705 Peinture termin\xE9e! {count} pixels peints.",paintingError:"\u274C Erreur pendant la peinture",missingRequirements:"\u274C Chargez une image et s\xE9lectionnez une position d'abord",progress:"Progr\xE8s",userName:"Usager",pixels:"Pixels",charges:"Charges",estimatedTime:"Temps estim\xE9",initMessage:"Cliquez sur 'Initialiser Auto-BOT' pour commencer",waitingInit:"En attente d'initialisation...",resizeSuccess:"\u2705 Image redimensionn\xE9e \xE0 {width}x{height}",paintingPaused:"\u23F8\uFE0F Peinture mise en pause \xE0 la position X: {x}, Y: {y}",pixelsPerBatch:"Pixels par lot",batchSize:"Taille du lot",nextBatchTime:"Prochain lot dans",useAllCharges:"Utiliser toutes les charges disponibles",showOverlay:"Afficher l'overlay",maxCharges:"Charges max par lot",waitingForCharges:"\u23F3 En attente de charges: {current}/{needed}",timeRemaining:"Temps restant",cooldownWaiting:"\u23F3 Attendre {time} pour continuer...",progressSaved:"\u2705 Progr\xE8s sauvegard\xE9 sous {filename}",progressLoaded:"\u2705 Progr\xE8s charg\xE9: {painted}/{total} pixels peints",progressLoadError:"\u274C Erreur lors du chargement du progr\xE8s: {error}",progressSaveError:"\u274C Erreur lors de la sauvegarde du progr\xE8s: {error}",confirmSaveProgress:"Voulez-vous sauvegarder le progr\xE8s actuel avant d'arr\xEAter?",saveProgressTitle:"Sauvegarder Progr\xE8s",discardProgress:"Abandonner",cancel:"Annuler",minimize:"Minimiser",width:"Largeur",height:"Hauteur",keepAspect:"Garder les proportions",apply:"Appliquer",overlayOn:"Overlay : ON",overlayOff:"Overlay : OFF",passCompleted:"\u2705 Passage termin\xE9: {painted} pixels peints | Progr\xE8s: {percent}% ({current}/{total})",waitingChargesRegen:"\u23F3 Attente de r\xE9g\xE9n\xE9ration des charges: {current}/{needed} - Temps: {time}",waitingChargesCountdown:"\u23F3 Attente des charges: {current}/{needed} - Restant: {time}",autoInitializing:"\u{1F916} Initialisation automatique...",autoInitSuccess:"\u2705 Bot d\xE9marr\xE9 automatiquement",autoInitFailed:"\u26A0\uFE0F Impossible de d\xE9marrer automatiquement. Utilisez le bouton manuel.",paletteDetected:"\u{1F3A8} Palette de couleurs d\xE9tect\xE9e",paletteNotFound:"\u{1F50D} Recherche de la palette de couleurs...",clickingPaintButton:"\u{1F446} Clic sur le bouton Paint...",paintButtonNotFound:"\u274C Bouton Paint introuvable",manualInitRequired:"\u{1F527} Initialisation manuelle requise",retryAttempt:"\u{1F504} Tentative {attempt}/{maxAttempts} dans {delay}s...",retryError:"\u{1F4A5} Erreur dans tentative {attempt}/{maxAttempts}, nouvel essai dans {delay}s...",retryFailed:"\u274C \xC9chec apr\xE8s {maxAttempts} tentatives. Continuant avec le lot suivant...",networkError:"\u{1F310} Erreur r\xE9seau. Nouvel essai...",serverError:"\u{1F525} Erreur serveur. Nouvel essai...",timeoutError:"\u23F0 Timeout serveur. Nouvel essai..."},farm:{title:"WPlace Farm Bot",start:"D\xE9marrer",stop:"Arr\xEAter",stopped:"Bot arr\xEAt\xE9",calibrate:"Calibrer",paintOnce:"Une fois",checkingStatus:"V\xE9rification du statut...",configuration:"Configuration",delay:"D\xE9lai (ms)",pixelsPerBatch:"Pixels/lot",minCharges:"Charges min",colorMode:"Mode couleur",random:"Al\xE9atoire",fixed:"Fixe",range:"Plage",fixedColor:"Couleur fixe",advanced:"Avanc\xE9",tileX:"Tuile X",tileY:"Tuile Y",customPalette:"Palette personnalis\xE9e",paletteExample:"ex: #FF0000,#00FF00,#0000FF",capture:"Capturer",painted:"Peints",charges:"Charges",retries:"\xC9checs",tile:"Tuile",configSaved:"Configuration sauvegard\xE9e",configLoaded:"Configuration charg\xE9e",configReset:"Configuration r\xE9initialis\xE9e",captureInstructions:"Peindre un pixel manuellement pour capturer les coordonn\xE9es...",backendOnline:"Backend En ligne",backendOffline:"Backend Hors ligne",startingBot:"D\xE9marrage du bot...",stoppingBot:"Arr\xEAt du bot...",calibrating:"Calibrage...",alreadyRunning:"Auto-Farm est d\xE9j\xE0 en cours d'ex\xE9cution.",imageRunningWarning:"Auto-Image est en cours d'ex\xE9cution. Fermez-le avant de d\xE9marrer Auto-Farm.",selectPosition:"S\xE9lectionner Zone",selectPositionAlert:"\u{1F3AF} Peignez un pixel dans une zone VIDE de la carte pour d\xE9finir la zone de farming",waitingPosition:"\u{1F446} En attente que vous peigniez le pixel de r\xE9f\xE9rence...",positionSet:"\u2705 Zone d\xE9finie! Rayon: 500px",positionTimeout:"\u274C D\xE9lai d\xE9pass\xE9 pour la s\xE9lection de zone",missingPosition:"\u274C S\xE9lectionnez une zone d'abord en utilisant 'S\xE9lectionner Zone'",farmRadius:"Rayon farm",positionInfo:"Zone actuelle",farmingInRadius:"\u{1F33E} Farming dans un rayon de {radius}px depuis ({x},{y})",selectEmptyArea:"\u26A0\uFE0F IMPORTANT: S\xE9lectionnez une zone VIDE pour \xE9viter les conflits",noPosition:"Aucune zone",currentZone:"Zone: ({x},{y})",autoSelectPosition:"\u{1F3AF} S\xE9lectionnez une zone d'abord. Peignez un pixel sur la carte pour d\xE9finir la zone de farming"},common:{yes:"Oui",no:"Non",ok:"OK",cancel:"Annuler",close:"Fermer",save:"Sauvegarder",load:"Charger",delete:"Supprimer",edit:"Modifier",start:"D\xE9marrer",stop:"Arr\xEAter",pause:"Pause",resume:"Reprendre",reset:"R\xE9initialiser",settings:"Param\xE8tres",help:"Aide",about:"\xC0 propos",language:"Langue",loading:"Chargement...",error:"Erreur",success:"Succ\xE8s",warning:"Avertissement",info:"Information",languageChanged:"Langue chang\xE9e en {language}"}};var ne={launcher:{title:"WPlace AutoBOT",autoFarm:"\u{1F33E} \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C",autoImage:"\u{1F3A8} \u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",selection:"\u0412\u044B\u0431\u0440\u0430\u043D\u043E",user:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",charges:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F",backend:"\u0411\u044D\u043A\u0435\u043D\u0434",database:"\u0411\u0430\u0437\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",uptime:"\u0412\u0440\u0435\u043C\u044F \u0440\u0430\u0431\u043E\u0442\u044B",close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",launch:"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C",loading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430",executing:"\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435",downloading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u043A\u0440\u0438\u043F\u0442\u0430...",chooseBot:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u043E\u0442\u0430 \u0438 \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C",readyToLaunch:"\u0413\u043E\u0442\u043E\u0432\u043E \u043A \u0437\u0430\u043F\u0443\u0441\u043A\u0443",loadError:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438",loadErrorMsg:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0433\u043E \u0431\u043E\u0442\u0430. \u041F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u0438\u043B\u0438 \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",checking:"\u{1F504} \u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430...",online:"\u{1F7E2} \u041E\u043D\u043B\u0430\u0439\u043D",offline:"\u{1F534} \u041E\u0444\u043B\u0430\u0439\u043D",ok:"\u{1F7E2} \u041E\u041A",error:"\u{1F534} \u041E\u0448\u0438\u0431\u043A\u0430",unknown:"-"},image:{title:"WPlace \u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",initBot:"\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C Auto-BOT",uploadImage:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",resizeImage:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0430\u0437\u043C\u0435\u0440 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",selectPosition:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043C\u0435\u0441\u0442\u043E \u043D\u0430\u0447\u0430\u043B\u0430",startPainting:"\u041D\u0430\u0447\u0430\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u0442\u044C",stopPainting:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435",saveProgress:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",loadProgress:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",checkingColors:"\u{1F50D} \u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0445 \u0446\u0432\u0435\u0442\u043E\u0432...",noColorsFound:"\u274C \u041E\u0442\u043A\u0440\u043E\u0439\u0442\u0435 \u043F\u0430\u043B\u0438\u0442\u0440\u0443 \u0446\u0432\u0435\u0442\u043E\u0432 \u043D\u0430 \u0441\u0430\u0439\u0442\u0435 \u0438 \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u043D\u043E\u0432\u0430!",colorsFound:"\u2705 \u041D\u0430\u0439\u0434\u0435\u043D\u043E {count} \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0445 \u0446\u0432\u0435\u0442\u043E\u0432",loadingImage:"\u{1F5BC}\uFE0F \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F...",imageLoaded:"\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E \u0441 {count} \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C\u0438 \u043F\u0438\u043A\u0441\u0435\u043B\u044F\u043C\u0438",imageError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",selectPositionAlert:"\u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u044B\u0439 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432 \u0442\u043E\u043C \u043C\u0435\u0441\u0442\u0435, \u0433\u0434\u0435 \u0432\u044B \u0445\u043E\u0442\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0440\u0438\u0441\u0443\u043D\u043E\u043A \u043D\u0430\u0447\u0438\u043D\u0430\u043B\u0441\u044F!",waitingPosition:"\u{1F446} \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0433\u043E \u043F\u0438\u043A\u0441\u0435\u043B\u044F....",positionSet:"\u2705 \u041F\u043E\u0437\u0438\u0446\u0438\u044F \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E!",positionTimeout:"\u274C \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0432\u044B\u0431\u043E\u0440\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438",positionDetected:"\u{1F3AF} \u041F\u043E\u0437\u0438\u0446\u0438\u044F \u0432\u044B\u0431\u0440\u0430\u043D\u0430, \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430...",positionError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u044B\u0431\u043E\u0440\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437",startPaintingMsg:"\u{1F3A8} \u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u044F...",paintingProgress:"\u{1F9F1} \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441: {painted} \u0438\u0437 {total} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439...",noCharges:"\u231B \u041D\u0435\u0442 \u0437\u0430\u0440\u044F\u0434\u043E\u0432. \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 {time}...",paintingStopped:"\u23F9\uFE0F \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u043C",paintingComplete:"\u2705 \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E! {count} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E.",paintingError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u043F\u0440\u043E\u0446\u0435\u0441\u0441\u0435 \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u044F",missingRequirements:"\u274C \u0421\u043F\u0435\u0440\u0432\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0438 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043C\u0435\u0441\u0442\u043E \u043D\u0430\u0447\u0430\u043B\u0430",progress:"\u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",userName:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",pixels:"\u041F\u0438\u043A\u0441\u0435\u043B\u0438",charges:"\u0417\u0430\u0440\u044F\u0434\u044B",estimatedTime:"\u041F\u0440\u0435\u0434\u043F\u043E\u043B\u043E\u0436\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u0432\u0440\u0435\u043C\u044F",initMessage:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \xAB\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C Auto-BOT\xBB, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u0447\u0430\u0442\u044C",waitingInit:"\u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438...",resizeSuccess:"\u2705 \u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u043E \u0434\u043E {width}x{height}",paintingPaused:"\u23F8\uFE0F \u0420\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u0438\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E \u043D\u0430 \u043F\u043E\u0437\u0438\u0446\u0438\u0438 X: {x}, Y: {y}",pixelsPerBatch:"\u041F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u0432 \u043F\u0440\u043E\u0445\u043E\u0434\u0435",batchSize:"\u0420\u0430\u0437\u043C\u0435\u0440 \u043F\u0440\u043E\u0445\u043E\u0434\u0430",nextBatchTime:"\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u043F\u0440\u043E\u0445\u043E\u0434 \u0447\u0435\u0440\u0435\u0437",useAllCharges:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u0432\u0441\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u0437\u0430\u0440\u044F\u0434\u044B",showOverlay:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043D\u0430\u043B\u043E\u0436\u0435\u043D\u0438\u0435",maxCharges:"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u0437\u0430\u0440\u044F\u0434\u043E\u0432 \u0437\u0430 \u043F\u0440\u043E\u0445\u043E\u0434",waitingForCharges:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0437\u0430\u0440\u044F\u0434\u043E\u0432: {current} \u0438\u0437 {needed}",timeRemaining:"\u0412\u0440\u0435\u043C\u0435\u043D\u0438 \u043E\u0441\u0442\u0430\u043B\u043E\u0441\u044C",cooldownWaiting:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 {time} \u0434\u043B\u044F \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u044F...",progressSaved:"\u2705 \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D \u043A\u0430\u043A {filename}",progressLoaded:"\u2705 \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D: {painted} \u0438\u0437 {total} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E",progressLoadError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441\u0430: {error}",progressSaveError:"\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441\u0430: {error}",confirmSaveProgress:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441 \u043F\u0435\u0440\u0435\u0434 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u043E\u0439?",saveProgressTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",discardProgress:"\u041D\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u0442\u044C \u043F\u0440\u043E\u0433\u0440\u0435\u0441\u0441",cancel:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",minimize:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C",width:"\u0428\u0438\u0440\u0438\u043D\u0430",height:"\u0412\u044B\u0441\u043E\u0442\u0430",keepAspect:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0441\u043E\u043E\u0442\u043D\u043E\u0448\u0435\u043D\u0438\u0435 \u0441\u0442\u043E\u0440\u043E\u043D",apply:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C",passCompleted:"\u2705 \u041F\u0440\u043E\u0446\u0435\u0441\u0441 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D: {painted} \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u043D\u043E | \u041F\u0440\u043E\u0433\u0440\u0435\u0441\u0441: {percent}% ({current} \u0438\u0437 {total})",waitingChargesRegen:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0432\u043E\u0441\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u0440\u044F\u0434\u0430: {current} \u0438\u0437 {needed} - \u0412\u0440\u0435\u043C\u044F: {time}",waitingChargesCountdown:"\u23F3 \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0437\u0430\u0440\u044F\u0434\u043E\u0432: {current} \u0438\u0437 {needed} - \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F: {time}",autoInitializing:"\u{1F916} \u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0430\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F...",autoInitSuccess:"\u2705 \u0411\u043E\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u043B\u0441\u044F \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438",autoInitFailed:"\u26A0\uFE0F \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0432\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u044C \u0430\u0432\u0442\u043E\u0437\u0430\u043F\u0443\u0441\u043A. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u043A\u043D\u043E\u043F\u043A\u0443 \u0440\u0443\u0447\u043D\u043E\u0433\u043E \u0437\u0430\u043F\u0443\u0441\u043A\u0430.",paletteDetected:"\u{1F3A8} \u0426\u0432\u0435\u0442\u043E\u0432\u0430\u044F \u043F\u0430\u043B\u0438\u0442\u0440\u0430 \u043E\u0431\u043D\u0430\u0440\u0443\u0436\u0435\u043D\u0430",paletteNotFound:"\u{1F50D} \u041F\u043E\u0438\u0441\u043A \u0446\u0432\u0435\u0442\u043E\u0432\u043E\u0439 \u043F\u0430\u043B\u0438\u0442\u0440\u044B...",clickingPaintButton:"\u{1F446} \u041D\u0430\u0436\u0430\u0442\u0438\u0435 \u043A\u043D\u043E\u043F\u043A\u0438 \xABPaint\xBB...",paintButtonNotFound:"\u274C \u041A\u043D\u043E\u043F\u043A\u0430 \xABPaint\xBB \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430",manualInitRequired:"\u{1F527} \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u0440\u0443\u0447\u043D\u0430\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F",retryAttempt:"\u{1F504} \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430 {attempt} \u0438\u0437 {maxAttempts} \u0447\u0435\u0440\u0435\u0437 {delay}s...",retryError:"\u{1F4A5} \u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u043F\u043E\u043F\u044B\u0442\u043A\u0435 {attempt} \u0438\u0437 {maxAttempts}, \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 {delay}s...",retryFailed:"\u274C \u041F\u0440\u043E\u0432\u0430\u043B\u0435\u043D\u043E \u0441\u043F\u0443\u0441\u0442\u044F {maxAttempts} \u043F\u043E\u043F\u044B\u0442\u043E\u043A. \u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u0435 \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C \u043F\u0440\u043E\u0445\u043E\u0434\u0435...",networkError:"\u{1F310} \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0442\u0438. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430...",serverError:"\u{1F525} \u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430...",timeoutError:"\u23F0 \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041F\u043E\u0432\u0442\u043E\u0440\u043D\u0430\u044F \u043F\u043E\u043F\u044B\u0442\u043A\u0430..."},farm:{title:"WPlace \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C",start:"\u041D\u0430\u0447\u0430\u0442\u044C",stop:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C",stopped:"\u0411\u043E\u0442 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D",calibrate:"\u041A\u0430\u043B\u0438\u0431\u0440\u043E\u0432\u0430\u0442\u044C",paintOnce:"\u0415\u0434\u0438\u043D\u043E\u0440\u0430\u0437\u043E\u0432\u043E",checkingStatus:"\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430...",configuration:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F",delay:"\u0417\u0430\u0434\u0435\u0440\u0436\u043A\u0430 (\u043C\u0441)",pixelsPerBatch:"\u041F\u0438\u043A\u0441\u0435\u043B\u0435\u0439 \u0437\u0430 \u043F\u0440\u043E\u0445\u043E\u0434",minCharges:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E",colorMode:"\u0420\u0435\u0436\u0438\u043C \u0446\u0432\u0435\u0442\u043E\u0432",random:"\u0421\u043B\u0443\u0447\u0430\u0439\u043D\u044B\u0439",fixed:"\u0424\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439",range:"\u0414\u0438\u0430\u043F\u0430\u0437\u043E\u043D",fixedColor:"\u0424\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u0446\u0432\u0435\u0442",advanced:"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u044B\u0435",tileX:"\u041F\u043B\u0438\u0442\u043A\u0430 X",tileY:"\u041F\u043B\u0438\u0442\u043A\u0430 Y",customPalette:"\u0421\u0432\u043E\u044F \u043F\u0430\u043B\u0438\u0442\u0440\u0430",paletteExample:"\u043F\u0440\u0438\u043C\u0435\u0440: #FF0000,#00FF00,#0000FF",capture:"\u0417\u0430\u0445\u0432\u0430\u0442",painted:"\u0417\u0430\u043A\u0440\u0430\u0448\u0435\u043D\u043E",charges:"\u0417\u0430\u0440\u044F\u0434\u044B",retries:"\u041F\u043E\u0432\u0442\u043E\u0440\u043D\u044B\u0435 \u043F\u043E\u043F\u044B\u0442\u043A\u0438",tile:"\u041F\u043B\u0438\u0442\u043A\u0430",configSaved:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0430",configLoaded:"\u041A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u0430",configReset:"\u0421\u0431\u0440\u043E\u0441 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438",captureInstructions:"\u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432\u0440\u0443\u0447\u043D\u0443\u044E \u0434\u043B\u044F \u0437\u0430\u0445\u0432\u0430\u0442\u0430 \u043A\u043E\u043E\u0440\u0434\u0438\u043D\u0430\u0442...",backendOnline:"\u0411\u044D\u043A\u044D\u043D\u0434 \u041E\u043D\u043B\u0430\u0439\u043D",backendOffline:"\u0411\u044D\u043A\u044D\u043D\u0434",startingBot:"\u0417\u0430\u043F\u0443\u0441\u043A \u0431\u043E\u0442\u0430...",stoppingBot:"\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0431\u043E\u0442\u0430...",calibrating:"\u041A\u0430\u043B\u0438\u0431\u0440\u043E\u0432\u043A\u0430...",alreadyRunning:"\u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C \u0443\u0436\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D",imageRunningWarning:"\u0410\u0432\u0442\u043E-\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D\u043E. \u0417\u0430\u043A\u0440\u043E\u0439\u0442\u0435 \u0435\u0433\u043E \u043F\u0435\u0440\u0435\u0434 \u0437\u0430\u043F\u0443\u0441\u043A\u043E\u043C \u0410\u0432\u0442\u043E-\u0424\u0430\u0440\u043C\u0430.",selectPosition:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",selectPositionAlert:"\u{1F3AF} \u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u0432 \u041F\u0423\u0421\u0422\u041E\u0419 \u043E\u0431\u043B\u0430\u0441\u0442\u0438 \u043A\u0430\u0440\u0442\u044B, \u0447\u0442\u043E\u0431\u044B \u043E\u0431\u043E\u0437\u043D\u0430\u0447\u0438\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0444\u0430\u0440\u043C\u0430.",waitingPosition:"\u{1F446} \u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0440\u0442\u043E\u0432\u043E\u0433\u043E \u043F\u0438\u043A\u0441\u0435\u043B\u044F....",positionSet:"\u2705 \u041E\u0431\u043B\u0430\u0441\u0442\u044C \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0430! \u0420\u0430\u0434\u0438\u0443\u0441: 500px",positionTimeout:"\u274C \u0422\u0430\u0439\u043C\u0430\u0443\u0442 \u0432\u044B\u0431\u043E\u0440\u0430 \u043E\u0431\u043B\u0430\u0441\u0442\u0438",missingPosition:"\u274C \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \xAB\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C\xBB",farmRadius:"\u0420\u0430\u0434\u0438\u0443\u0441 \u0444\u0430\u0440\u043C\u0430",positionInfo:"\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u043E\u0431\u043B\u0430\u0441\u0442\u044C",farmingInRadius:"\u{1F33E} \u0424\u0430\u0440\u043C \u0432 \u0440\u0430\u0434\u0438\u0443\u0441\u0435 {radius}px \u043E\u0442 ({x},{y})",selectEmptyArea:"\u26A0\uFE0F \u0412\u0410\u0416\u041D\u041E: \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u041F\u0423\u0421\u0422\u0423\u042E \u043E\u0431\u043B\u0430\u0441\u0442\u044C, \u0447\u0442\u043E\u0431\u044B \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044C \u043A\u043E\u043D\u0444\u043B\u0438\u043A\u0442\u043E\u0432.",noPosition:"\u041D\u0435\u0442 \u043E\u0431\u043B\u0430\u0441\u0442\u0438",currentZone:"\u041E\u0431\u043B\u0430\u0441\u0442\u044C: ({x},{y})",autoSelectPosition:"\u{1F3AF} \u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0431\u043B\u0430\u0441\u0442\u044C. \u041D\u0430\u0440\u0438\u0441\u0443\u0439\u0442\u0435 \u043F\u0438\u043A\u0441\u0435\u043B\u044C \u043D\u0430 \u043A\u0430\u0440\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043E\u0431\u043E\u0437\u043D\u0430\u0447\u0438\u0442\u044C \u043E\u0431\u043B\u0430\u0441\u0442\u044C \u0444\u0430\u0440\u043C\u0430."},common:{yes:"\u0414\u0430",no:"\u041D\u0435\u0442",ok:"\u041E\u041A",cancel:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",close:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",save:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",load:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C",delete:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",edit:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C",start:"\u041D\u0430\u0447\u0430\u0442\u044C",stop:"\u0417\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C",pause:"\u041F\u0440\u0438\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C",resume:"\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C",reset:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",settings:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",help:"\u041F\u043E\u043C\u043E\u0449\u044C",about:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",language:"\u042F\u0437\u044B\u043A",loading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...",error:"\u041E\u0448\u0438\u0431\u043A\u0430",success:"\u0423\u0441\u043F\u0435\u0445",warning:"\u041F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0436\u0434\u0435\u043D\u0438\u0435",info:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",languageChanged:"\u042F\u0437\u044B\u043A \u0438\u0437\u043C\u0435\u043D\u0435\u043D \u043D\u0430 {language}"}};var D={es:te,en:ie,fr:ae,ru:ne},X="es",Y=D[X];function Pe(){let e=(window.navigator.language||window.navigator.userLanguage||"es").split("-")[0].toLowerCase();return D[e]?e:"es"}function be(){return null}function q(){let g=be(),e=Pe(),n="es";return g&&D[g]?n=g:e&&D[e]&&(n=e),ye(n),n}function ye(g){if(!D[g]){console.warn(`Idioma '${g}' no disponible. Usando '${X}'`);return}X=g,Y=D[g],typeof window!="undefined"&&window.CustomEvent&&window.dispatchEvent(new window.CustomEvent("languageChanged",{detail:{language:g,translations:Y}}))}function oe(){return X}function v(g,e={}){let n=g.split("."),i=Y;for(let a of n)if(i&&typeof i=="object"&&a in i)i=i[a];else return console.warn(`Clave de traducci\xF3n no encontrada: '${g}'`),g;return typeof i!="string"?(console.warn(`Clave de traducci\xF3n no es string: '${g}'`),g):Ee(i,e)}function Ee(g,e){return!e||Object.keys(e).length===0?g:g.replace(/\{(\w+)\}/g,(n,i)=>e[i]!==void 0?e[i]:n)}function W(g){return Y[g]?Y[g]:(console.warn(`Secci\xF3n de traducci\xF3n no encontrada: '${g}'`),{})}q();var _={SITEKEY:"0x4AAAAAABpqJe8FO0N84q0F",COOLDOWN_DEFAULT:31e3,TRANSPARENCY_THRESHOLD:100,WHITE_THRESHOLD:250,LOG_INTERVAL:10,TILE_SIZE:4e3,PIXELS_PER_BATCH:20,CHARGE_REGEN_MS:3e4,THEME:{primary:"#000000",secondary:"#111111",accent:"#222222",text:"#ffffff",highlight:"#775ce3",success:"#00ff00",error:"#ff0000",warning:"#ffaa00"}};var t={running:!1,imageLoaded:!1,processing:!1,totalPixels:0,paintedPixels:0,availableColors:[],currentCharges:0,cooldown:_.COOLDOWN_DEFAULT,imageData:null,stopFlag:!1,colorsChecked:!1,startPosition:null,selectingPosition:!1,positionTimeoutId:null,cleanupObserver:null,region:null,minimized:!1,lastPosition:{x:0,y:0},estimatedTime:0,language:"es",tileX:null,tileY:null,pixelsPerBatch:_.PIXELS_PER_BATCH,useAllChargesFirst:!0,isFirstBatch:!0,maxCharges:50,nextBatchCooldown:0,inCooldown:!1,cooldownEndTime:0,remainingPixels:[],lastChargeUpdate:0,chargeDecimalPart:0,originalImageName:null,retryCount:0};var V=class{constructor(){this.detectedSize=null,this.confidence=0}detectFromUrl(){try{let e=window.location.href,n=new URLSearchParams(window.location.search),i=window.location.hash,a=null;if(n.has("x")&&n.has("y"))a=[parseInt(n.get("x")),parseInt(n.get("y"))];else if(i){let s=i.match(/#(-?\d+),(-?\d+)/);s&&(a=[parseInt(s[1]),parseInt(s[2])])}if(a&&(Math.abs(a[0])>1e4||Math.abs(a[1])>1e4)){let s=[3e3,4e3,2048,5e3];for(let c of s){let r=Math.floor(a[0]/c),p=Math.floor(a[1]/c),u=a[0]%c,l=a[1]%c;if(u>=0&&u<c&&l>=0&&l<c)return o(`[TILE DETECTOR] URL suggests tile size: ${c} (tile: ${r},${p} local: ${u},${l})`),c}}}catch(e){o("[TILE DETECTOR] Error detecting from URL:",e)}return null}detectFromDOM(){var e;try{let n=["[data-tile-size]",".tile-info",".coordinates",".position-info"];for(let s of n){let c=document.querySelectorAll(s);for(let r of c){let p=r.getAttribute("data-tile-size")||r.dataset.tileSize||((e=r.textContent.match(/tile.*?(\d{4,})/i))==null?void 0:e[1]);if(p){let u=parseInt(p);if(u>=1e3&&u<=1e4)return o(`[TILE DETECTOR] DOM suggests tile size: ${u}`),u}}}let i=document.body.textContent||"",a=i.match(/tile.*?(\d{4,})/i)||i.match(/(\d{4,}).*?tile/i);if(a){let s=parseInt(a[1]);if(s>=1e3&&s<=1e4)return o(`[TILE DETECTOR] Text content suggests tile size: ${s}`),s}}catch(n){o("[TILE DETECTOR] Error detecting from DOM:",n)}return null}async detectFromNetwork(e=1e4){return new Promise(n=>{let i=window.fetch,a=!1,s=setTimeout(()=>{a||(a=!0,window.fetch=i,n(null))},e);window.fetch=async function(c,r){try{if(c.includes("/s0/pixel/")&&r&&r.body){let p=c.match(/\/s0\/pixel\/(-?\d+)\/(-?\d+)/),u;try{u=JSON.parse(r.body)}catch{u=r.body}if(p&&u&&u.coords){let l=parseInt(p[1]),d=parseInt(p[2]),f=u.coords[0],h=u.coords[1],b=[3e3,4e3,2048,5e3];for(let m of b){let w=l*m+f,y=d*m+h;if(f>=0&&f<m&&h>=0&&h<m&&!a){a=!0,clearTimeout(s),window.fetch=i,o(`[TILE DETECTOR] Network request suggests tile size: ${m} (tile: ${l},${d} local: ${f},${h})`),n(m);return}}}}}catch(p){o("[TILE DETECTOR] Error intercepting network:",p)}return i(c,r)}})}async autoDetect(){o("[TILE DETECTOR] Auto-detecting tile size...");let e=this.detectFromUrl();if(e)return this.detectedSize=e,this.confidence=.8,e;if(e=this.detectFromDOM(),e)return this.detectedSize=e,this.confidence=.6,e;if(e=await this.detectFromNetwork(5e3),e)return this.detectedSize=e,this.confidence=.9,e;o("[TILE DETECTOR] Could not auto-detect, trying common sizes...");let i=document.querySelector('meta[name="viewport"]')||document.querySelector('[class*="modern"]')||document.querySelector('[class*="v2"]')||window.location.href.includes("v2")?4e3:3e3;return this.detectedSize=i,this.confidence=.3,o(`[TILE DETECTOR] Using fallback size: ${i} (confidence: ${this.confidence})`),i}getDetectedSize(){return this.detectedSize}getConfidence(){return this.confidence}},H=new V;function j(){o("\u{1F3A8} Detectando colores disponibles...");let g=document.querySelectorAll('[id^="color-"]'),e=[];for(let n of g){if(n.querySelector("svg"))continue;let i=n.id.replace("color-",""),a=parseInt(i);if(a===0||a===5)continue;let s=n.style.backgroundColor;if(s){let c=s.match(/\d+/g);if(c&&c.length>=3){let r={r:parseInt(c[0]),g:parseInt(c[1]),b:parseInt(c[2])};e.push({id:a,element:n,...r}),o(`Color detectado: id=${a}, rgb(${r.r},${r.g},${r.b})`)}}}return o(`\u2705 ${e.length} colores disponibles detectados`),e}var U=class{constructor(e){this.imageSrc=e,this.img=new window.Image,this.originalName=null,this.tileSize=1e3,this.drawMult=3,this.shreadSize=3,this.actualTileSize=_.TILE_SIZE,this.bitmap=null,this.imageWidth=0,this.imageHeight=0,this.totalPixels=0,this.requiredPixelCount=0,this.defacePixelCount=0,this.colorPalette={},this.allowedColorsSet=new Set,this.rgbToMeta=new Map,this.coords=[0,0,0,0],this.templateTiles={},this.templateTilesBuffers={},this.tilePrefixes=new Set,this.initializeTileSize()}async initializeTileSize(){try{let e=await H.autoDetect();e?(this.actualTileSize=e,o(`[BLUE MARBLE] Using detected tile size: ${e}`)):o(`[BLUE MARBLE] Using default tile size: ${this.actualTileSize}`)}catch(e){o("[BLUE MARBLE] Error detecting tile size, using default:",e)}}async load(){return new Promise((e,n)=>{this.img.onload=async()=>{try{this.bitmap=await createImageBitmap(this.img),this.imageWidth=this.bitmap.width,this.imageHeight=this.bitmap.height,this.totalPixels=this.imageWidth*this.imageHeight,o(`[BLUE MARBLE] Imagen cargada: ${this.imageWidth}\xD7${this.imageHeight} = ${this.totalPixels.toLocaleString()} p\xEDxeles`),e()}catch(i){n(i)}},this.img.onerror=n,this.img.src=this.imageSrc})}initializeColorPalette(){o("[BLUE MARBLE] Inicializando paleta de colores...");let e=this.detectSiteColors();this.allowedColorsSet=new Set(e.filter(i=>i.name&&i.name.toLowerCase()!=="transparent"&&Array.isArray(i.rgb)).map(i=>`${i.rgb[0]},${i.rgb[1]},${i.rgb[2]}`));let n="222,250,206";this.allowedColorsSet.add(n),this.rgbToMeta=new Map(e.filter(i=>Array.isArray(i.rgb)).map(i=>[`${i.rgb[0]},${i.rgb[1]},${i.rgb[2]}`,{id:i.id,premium:!!i.premium,name:i.name||`Color ${i.id}`}]));try{let i=e.find(a=>a.name&&a.name.toLowerCase()==="transparent");i&&Array.isArray(i.rgb)&&this.rgbToMeta.set(n,{id:i.id,premium:!!i.premium,name:i.name})}catch{}return o(`[BLUE MARBLE] Paleta inicializada: ${this.allowedColorsSet.size} colores permitidos`),Array.from(e)}detectSiteColors(){let e=document.querySelectorAll('[id^="color-"]'),n=[];for(let i of e){if(i.querySelector("svg"))continue;let a=i.id.replace("color-",""),s=parseInt(a),c=i.style.backgroundColor;if(c){let r=c.match(/\d+/g);if(r&&r.length>=3){let p=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2])];n.push({id:s,element:i,rgb:p,name:i.title||i.getAttribute("aria-label")||`Color ${s}`,premium:i.classList.contains("premium")||i.querySelector(".premium")})}}}return o(`[BLUE MARBLE] ${n.length} colores detectados del sitio`),n}setCoords(e,n,i,a){this.coords=[e,n,i,a],o(`[BLUE MARBLE] \u2705 Coordenadas establecidas: tile(${e},${n}) pixel(${i},${a})`),o(`[BLUE MARBLE] \u{1F4CD} Esto significa: imagen empezar\xE1 en posici\xF3n global (${e*this.actualTileSize+i}, ${n*this.actualTileSize+a})`)}async analyzePixels(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");o("[BLUE MARBLE] Analizando p\xEDxeles de la imagen...");try{let n=new OffscreenCanvas(this.imageWidth,this.imageHeight).getContext("2d",{willReadFrequently:!0});n.imageSmoothingEnabled=!1,n.clearRect(0,0,this.imageWidth,this.imageHeight),n.drawImage(this.bitmap,0,0);let i=n.getImageData(0,0,this.imageWidth,this.imageHeight).data,a=0,s=0,c=new Map;for(let p=0;p<this.imageHeight;p++)for(let u=0;u<this.imageWidth;u++){let l=(p*this.imageWidth+u)*4,d=i[l],f=i[l+1],h=i[l+2];if(i[l+3]===0)continue;let m=`${d},${f},${h}`;d===222&&f===250&&h===206&&s++,this.allowedColorsSet.has(m)&&(a++,c.set(m,(c.get(m)||0)+1))}this.requiredPixelCount=a,this.defacePixelCount=s;let r={};for(let[p,u]of c.entries())r[p]={count:u,enabled:!0};return this.colorPalette=r,o("[BLUE MARBLE] An\xE1lisis completado:"),o(`  - P\xEDxeles requeridos: ${a.toLocaleString()}`),o(`  - P\xEDxeles #deface: ${s.toLocaleString()}`),o(`  - Colores \xFAnicos: ${c.size}`),{totalPixels:this.totalPixels,requiredPixels:a,defacePixels:s,uniqueColors:c.size,colorPalette:r}}catch{return this.requiredPixelCount=Math.max(0,this.totalPixels),this.defacePixelCount=0,o("[BLUE MARBLE] Fallback: usando total de p\xEDxeles como requeridos"),{totalPixels:this.totalPixels,requiredPixels:this.totalPixels,defacePixels:0,uniqueColors:0,colorPalette:{}}}}async createTemplateTiles(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");o("[BLUE MARBLE] Creando tiles de template...");let e={},n={},i=new OffscreenCanvas(this.tileSize,this.tileSize),a=i.getContext("2d",{willReadFrequently:!0});for(let s=this.coords[3];s<this.imageHeight+this.coords[3];){let c=Math.min(this.tileSize-s%this.tileSize,this.imageHeight-(s-this.coords[3]));for(let r=this.coords[2];r<this.imageWidth+this.coords[2];){let p=Math.min(this.tileSize-r%this.tileSize,this.imageWidth-(r-this.coords[2])),u=p*this.shreadSize,l=c*this.shreadSize;i.width=u,i.height=l,a.imageSmoothingEnabled=!1,a.clearRect(0,0,u,l),a.drawImage(this.bitmap,r-this.coords[2],s-this.coords[3],p,c,0,0,p*this.shreadSize,c*this.shreadSize);let d=a.getImageData(0,0,u,l);for(let m=0;m<l;m++)for(let w=0;w<u;w++){let y=(m*u+w)*4;if(d.data[y]===222&&d.data[y+1]===250&&d.data[y+2]===206)(w+m)%2===0?(d.data[y]=0,d.data[y+1]=0,d.data[y+2]=0):(d.data[y]=255,d.data[y+1]=255,d.data[y+2]=255),d.data[y+3]=32;else if(w%this.shreadSize!==1||m%this.shreadSize!==1)d.data[y+3]=0;else{let C=d.data[y],S=d.data[y+1],L=d.data[y+2];this.allowedColorsSet.has(`${C},${S},${L}`)||(d.data[y+3]=0)}}a.putImageData(d,0,0);let f=`${(this.coords[0]+Math.floor(r/1e3)).toString().padStart(4,"0")},${(this.coords[1]+Math.floor(s/1e3)).toString().padStart(4,"0")},${(r%1e3).toString().padStart(3,"0")},${(s%1e3).toString().padStart(3,"0")}`;e[f]=await createImageBitmap(i),this.tilePrefixes.add(f.split(",").slice(0,2).join(","));let b=await(await i.convertToBlob()).arrayBuffer();n[f]=b,r+=p}s+=c}return this.templateTiles=e,this.templateTilesBuffers=n,o(`[BLUE MARBLE] Tiles creados: ${Object.keys(e).length} tiles`),o(`[BLUE MARBLE] Prefijos registrados: ${this.tilePrefixes.size} tiles \xFAnicos`),{templateTiles:e,templateTilesBuffers:n}}generatePixelQueue(){if(!this.bitmap)throw new Error("Imagen no cargada. Llama a load() primero.");o("[BLUE MARBLE] \u{1F3AF} Iniciando generaci\xF3n de cola de p\xEDxeles..."),o(`[BLUE MARBLE] \u{1F4D0} Tama\xF1o actual de tile: ${this.actualTileSize}`),o(`[BLUE MARBLE] \u{1F5C2}\uFE0F Coordenadas almacenadas: tile(${this.coords[0]},${this.coords[1]}) pixel(${this.coords[2]||0},${this.coords[3]||0})`);let e=[],n=this.coords[0]*this.actualTileSize+(this.coords[2]||0),i=this.coords[1]*this.actualTileSize+(this.coords[3]||0);o(`[BLUE MARBLE] \u{1F4CD} Posici\xF3n base calculada: global(${n}, ${i})`),o(`[BLUE MARBLE] \u{1F4CF} Dimensiones imagen: ${this.imageWidth}x${this.imageHeight}`);let s=new OffscreenCanvas(this.imageWidth,this.imageHeight).getContext("2d",{willReadFrequently:!0});s.imageSmoothingEnabled=!1,s.drawImage(this.bitmap,0,0);let c=s.getImageData(0,0,this.imageWidth,this.imageHeight).data,r=-1,p=-1;e:for(let d=0;d<this.imageHeight;d++)for(let f=0;f<this.imageWidth;f++){let h=(d*this.imageWidth+f)*4,b=c[h],m=c[h+1],w=c[h+2];if(c[h+3]===0||b===222&&m===250&&w===206)continue;let C=`${b},${m},${w}`;if(this.allowedColorsSet.has(C)){r=f,p=d;break e}}if(r===-1)return o("[BLUE MARBLE] \u274C No se encontraron p\xEDxeles v\xE1lidos en la imagen"),[];o(`[BLUE MARBLE] \u{1F3AF} Primer p\xEDxel v\xE1lido encontrado en imagen(${r}, ${p})`);let u=n-r,l=i-p;o(`[BLUE MARBLE] \uFFFD Ajuste aplicado: baseX ${n} - ${r} = ${u}`),o(`[BLUE MARBLE] \u{1F527} Ajuste aplicado: baseY ${i} - ${p} = ${l}`),o(`[BLUE MARBLE] \u2705 Primer p\xEDxel se pintar\xE1 en posici\xF3n global: (${u+r}, ${l+p})`);for(let d=0;d<this.imageHeight;d++)for(let f=0;f<this.imageWidth;f++){let h=(d*this.imageWidth+f)*4,b=c[h],m=c[h+1],w=c[h+2],y=c[h+3];if(y===0||b===222&&m===250&&w===206)continue;let C=`${b},${m},${w}`;if(!this.allowedColorsSet.has(C))continue;let S=u+f,L=l+d;e.length===0&&(o("[BLUE MARBLE] \u{1F3A8} PRIMER P\xCDXEL CON AJUSTE:"),o(`[BLUE MARBLE] \u{1F4CA} Imagen position: (${f}, ${d})`),o(`[BLUE MARBLE] \u{1F4CA} Global position: (${S}, ${L})`),o(`[BLUE MARBLE] \u2705 Esto deber\xEDa coincidir con user click: (${n}, ${i})`),o(`[BLUE MARBLE] \u{1F50D} VERIFICACI\xD3N: \xBFEste es el firstValidPixel(${r}, ${p})?`),f!==r||d!==p?(o(`[BLUE MARBLE] \u274C ERROR: Primer pixel en queue (${f}, ${d}) NO coincide con firstValidPixel (${r}, ${p})`),o("[BLUE MARBLE] \u274C Esto causar\xE1 desalineaci\xF3n! Investigando..."),o(`[BLUE MARBLE] \u{1F41B} Pixel inesperado: color(${b},${m},${w}) alpha(${y}) colorKey(${C})`),o(`[BLUE MARBLE] \u{1F41B} allowedColorsSet.has(${C}): ${this.allowedColorsSet.has(C)}`)):o("[BLUE MARBLE] \u2705 CONFIRMADO: Primer pixel coincide con firstValidPixel"));let E=Math.floor(S/this.actualTileSize),T=Math.floor(L/this.actualTileSize),x=S%this.actualTileSize,A=L%this.actualTileSize,$=this.rgbToMeta.get(C)||{id:0,name:"Unknown"};e.push({imageX:f,imageY:d,globalX:S,globalY:L,tileX:E,tileY:T,localX:x,localY:A,color:{r:b,g:m,b:w,id:$.id,name:$.name},originalColor:{r:b,g:m,b:w,alpha:y}}),e.length===1&&o(`[BLUE MARBLE] \u{1F3A8} Primer p\xEDxel v\xE1lido: imagen(${f},${d}) \u2192 global(${S},${L}) \u2192 tile(${E},${T}) local(${x},${A}) color(${b},${m},${w})`)}if(o(`[BLUE MARBLE] \u2705 Cola generada: ${e.length} p\xEDxeles v\xE1lidos`),o(`[BLUE MARBLE] \u{1F4CA} Rango de p\xEDxeles ajustados: X(${u}-${u+this.imageWidth-1}), Y(${l}-${l+this.imageHeight-1})`),e.length>0){let d=e[0],f=e[e.length-1];o(`[BLUE MARBLE] \u{1F4CB} Primer p\xEDxel: global(${d.globalX},${d.globalY})`),o(`[BLUE MARBLE] \u{1F4CB} \xDAltimo p\xEDxel: global(${f.globalX},${f.globalY})`),o(`[BLUE MARBLE] \u2705 Confirmaci\xF3n: Primer p\xEDxel deber\xEDa estar en user click (${n}, ${i})`)}return e}async resize(e,n,i=!0){if(!this.img)throw new Error("Imagen no cargada. Llama a load() primero.");let a=this.img.width,s=this.img.height;if(i){let u=a/s;e/n>u?e=n*u:n=e/u}let c=document.createElement("canvas");c.width=e,c.height=n;let r=c.getContext("2d");r.imageSmoothingEnabled=!1,r.drawImage(this.img,0,0,e,n);let p=c.toDataURL();return this.img.src=p,this.imageSrc=p,await new Promise(u=>{this.img.onload=async()=>{this.bitmap=await createImageBitmap(this.img),this.imageWidth=this.bitmap.width,this.imageHeight=this.bitmap.height,this.totalPixels=this.imageWidth*this.imageHeight,u()}}),o(`[BLUE MARBLE] Imagen redimensionada: ${a}\xD7${s} \u2192 ${this.imageWidth}\xD7${this.imageHeight}`),{width:this.imageWidth,height:this.imageHeight}}getImageData(){return{width:this.imageWidth,height:this.imageHeight,totalPixels:this.totalPixels,requiredPixels:this.requiredPixelCount,defacePixels:this.defacePixelCount,colorPalette:this.colorPalette,coords:[...this.coords],originalName:this.originalName||"image.png",pixels:this.generatePixelQueue()}}generatePreview(e=200,n=200){if(!this.img)return null;let i=document.createElement("canvas"),a=i.getContext("2d"),{width:s,height:c}=this.img,r=s/c,p,u;return e/n>r?(u=n,p=n*r):(p=e,u=e/r),i.width=p,i.height=u,a.imageSmoothingEnabled=!1,a.drawImage(this.img,0,0,p,u),i.toDataURL()}getDimensions(){return{width:this.imageWidth,height:this.imageHeight}}};var z=g=>new Promise(e=>setTimeout(e,g));var G=class{constructor(){this.currentToken=null,this.tokenExpireTime=0,this.isGenerating=!1,this.sitekey=null,this.tokenTimeout=24e4,this.widgetContainer=null,this.overlayContainer=null,this.widgetId=null,this.currentSitekey=null,this.originalFetch=null,this.setupTokenCapture(),this.setupFetchInterception()}setupTokenCapture(){window.__WPA_SET_TURNSTILE_TOKEN__=e=>{e&&typeof e=="string"&&e.length>20&&(P.info(`\u{1F510} Turnstile Token Captured: ${e.substring(0,50)}...`),this.setToken(e))},window.addEventListener("message",e=>{let{source:n,token:i}=e.data;n==="turnstile-capture"&&i&&(!this.isValidToken()||this.currentToken!==i)&&this.setToken(i)})}setupFetchInterception(){if(window.__WPA_FETCH_HOOKED__)return;window.__WPA_FETCH_HOOKED__=!0;let e=window.fetch;this.originalFetch=e,window.fetch=async(...n)=>{let i=await e.apply(this,n),a=n[0]&&typeof n[0]=="object"&&n[0].url?n[0].url:n[0];if(typeof a=="string"&&a.includes("https://backend.wplace.live/s0/pixel/"))try{let s=n[1].body,c=JSON.parse(s);if(c.t){let r=c.t;(!this.isValidToken()||this.currentToken!==r)&&(P.info(`\u{1F510} Token captured from request: ${r.substring(0,50)}...`),window.postMessage({source:"turnstile-capture",token:r},"*"))}}catch{}return i}}setToken(e){this.currentToken=e,this.tokenExpireTime=Date.now()+this.tokenTimeout,P.success("\u{1F510} Turnstile token set successfully")}isValidToken(){return this.currentToken&&Date.now()<this.tokenExpireTime}invalidateToken(){this.currentToken=null,this.tokenExpireTime=0,P.warn("\u{1F5D1}\uFE0F Token invalidated, will force fresh generation")}async getToken(e=!1){if(this.isValidToken()&&!e)return this.currentToken;if(e&&this.invalidateToken(),this.isGenerating)return P.info("\u{1F504} Token generation already in progress, waiting..."),await this.delay(2e3),this.isValidToken()?this.currentToken:null;this.isGenerating=!0;try{P.info("\u{1F504} Token expired or missing, generating new one...");let n=await this.generateInvisibleToken();return n&&n.length>20?(this.setToken(n),P.success("\u2705 Token captured and cached successfully"),n):(P.warn("\u26A0\uFE0F Invisible Turnstile failed, forcing browser automation..."),n=await this.generateTokenViaBrowser(),n&&n.length>20?(this.setToken(n),P.success("\u2705 Fallback token captured successfully"),n):(P.error("\u274C All token generation methods failed"),null))}finally{this.isGenerating=!1}}async generateInvisibleToken(){let e=Date.now();try{let n=this.detectSitekey();P.info(`\u{1F511} Generating Turnstile token for sitekey: ${n.substring(0,20)}...`),typeof window!="undefined"&&window.navigator&&P.info(`\u{1F9EA} UA: ${window.navigator.userAgent.substring(0,100)}... Platform: ${window.navigator.platform}`);let i=await this.renderInvisibleTurnstile(n,"paint");if(i&&i.length>20){let a=Math.round(Date.now()-e);return P.success(`\u2705 Turnstile token generated successfully in ${a}ms`),i}else throw new Error("Invalid or empty token received")}catch(n){let i=Math.round(Date.now()-e);throw P.error(`\u274C Turnstile token generation failed after ${i}ms:`,n),n}}async loadTurnstileScript(){return window.turnstile?Promise.resolve():new Promise((e,n)=>{if(document.querySelector('script[src^="https://challenges.cloudflare.com/turnstile/v0/api.js"]')){let a=()=>{window.turnstile?e():setTimeout(a,100)};return a()}let i=document.createElement("script");i.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",i.async=!0,i.defer=!0,i.onload=()=>{P.success("\u2705 Turnstile script loaded successfully"),e()},i.onerror=()=>{P.error("\u274C Failed to load Turnstile script"),n(new Error("Failed to load Turnstile"))},document.head.appendChild(i)})}getInvisibleContainer(){return(!this.widgetContainer||!document.body.contains(this.widgetContainer))&&(this.widgetContainer&&this.widgetContainer.remove(),this.widgetContainer=document.createElement("div"),this.widgetContainer.style.cssText=`
                position: fixed !important;
                left: -9999px !important;
                top: -9999px !important;
                width: 300px !important;
                height: 65px !important;
                pointer-events: none !important;
                opacity: 0 !important;
                z-index: -1 !important;
            `,this.widgetContainer.setAttribute("aria-hidden","true"),this.widgetContainer.id="turnstile-widget-container",document.body.appendChild(this.widgetContainer)),this.widgetContainer}async renderInvisibleTurnstile(e,n){var i;if(await this.loadTurnstileScript(),this.widgetId&&this.currentSitekey===e&&((i=window.turnstile)!=null&&i.execute))try{P.info("\u{1F504} Reusing existing Turnstile widget...");let a=await Promise.race([window.turnstile.execute(this.widgetId,{action:n}),new Promise((s,c)=>setTimeout(()=>c(new Error("Execute timeout")),15e3))]);if(a&&a.length>20)return P.success("\u2705 Token generated via widget reuse"),a}catch(a){P.info(`\u{1F504} Widget reuse failed, will create a fresh widget: ${a.message}`)}return await this.createInvisibleWidget(e,n)}async createInvisibleWidget(e,n){return new Promise(i=>{var a;try{if(this.widgetId&&((a=window.turnstile)!=null&&a.remove))try{window.turnstile.remove(this.widgetId)}catch{}let s=this.getInvisibleContainer();s.innerHTML="";let c=window.turnstile.render(s,{sitekey:e,action:n,size:"invisible",retry:"auto","retry-interval":8e3,callback:r=>{P.success("\u2705 Invisible Turnstile callback"),i(r)},"error-callback":()=>i(null),"timeout-callback":()=>i(null)});if(!c)return i(null);this.widgetId=c,this.currentSitekey=e,Promise.race([window.turnstile.execute(c,{action:n}),new Promise((r,p)=>setTimeout(()=>p(new Error("Invisible execute timeout")),12e3))]).then(i).catch(()=>i(null))}catch(s){P.error("Invisible Turnstile failed:",s),i(null)}})}async generateTokenViaBrowser(){return new Promise((e,n)=>{(async()=>{try{P.info("\u{1F3AF} Starting automatic CAPTCHA solving process..."),this.invalidateToken();let i=this.delay(3e4).then(()=>n(new Error("Auto-CAPTCHA timed out after 30 seconds."))),a=(async()=>{let s=await this.waitForElement("button.btn.btn-primary.btn-lg",200,3e3);if(s||(s=await this.waitForElement("button.btn-primary.sm\\:btn-xl",200,3e3)),s||(s=await this.waitForElement("button.btn-primary",200,3e3)),!s){P.info("\u{1F3AF} No paint button found, clicking on canvas directly to trigger CAPTCHA...");let h=await this.waitForElement("canvas",200,5e3);h&&(h.click(),await this.delay(1e3),s=await this.waitForElement("button.btn.btn-primary.btn-lg, button.btn-primary.sm\\:btn-xl, button.btn-primary",200,5e3))}if(!s)throw new Error("Could not find any paint button after attempts.");P.info("\u{1F3AF} Found paint button, clicking..."),s.click(),await this.delay(500),P.info("\u{1F3AF} Selecting transparent color...");let c=await this.waitForElement("button#color-0",200,5e3);if(c)c.click();else{P.warn("\u26A0\uFE0F Could not find transparent color button, trying alternative selectors...");let h=document.querySelectorAll('button[id^="color-"]');h.length>0&&(h[0].click(),P.info("\u{1F3AF} Clicked first available color button"))}await this.delay(500),P.info("\u{1F3AF} Finding canvas element...");let r=await this.waitForElement("canvas",200,5e3);if(!r)throw new Error("Could not find the canvas element.");r.setAttribute("tabindex","0"),r.focus();let p=r.getBoundingClientRect(),u=Math.round(p.left+p.width/2),l=Math.round(p.top+p.height/2);P.info("\u{1F3AF} Simulating canvas interaction..."),typeof window!="undefined"&&window.MouseEvent&&window.KeyboardEvent&&(r.dispatchEvent(new window.MouseEvent("mousemove",{clientX:u,clientY:l,bubbles:!0})),r.dispatchEvent(new window.MouseEvent("mousedown",{clientX:u,clientY:l,bubbles:!0})),await this.delay(50),r.dispatchEvent(new window.MouseEvent("mouseup",{clientX:u,clientY:l,bubbles:!0})),r.dispatchEvent(new window.KeyboardEvent("keydown",{key:" ",code:"Space",bubbles:!0})),await this.delay(50),r.dispatchEvent(new window.KeyboardEvent("keyup",{key:" ",code:"Space",bubbles:!0}))),await this.delay(1e3),P.info("\u{1F3AF} Waiting for CAPTCHA challenge..."),await this.delay(2e3),P.info("\u{1F3AF} Starting confirmation loop...");let d=Date.now();(async()=>{let h=0;for(;!this.isValidToken()&&Date.now()-d<25e3;){h++;let b=await this.waitForElement("button.btn.btn-primary.btn-lg",100,1e3);if(b||(b=await this.waitForElement("button.btn.btn-primary.sm\\:btn-xl",100,1e3)),!b){let m=Array.from(document.querySelectorAll("button.btn-primary"));b=m.length?m[m.length-1]:null}b&&!b.disabled?(P.info(`\u{1F3AF} Clicking confirmation button (attempt ${h})...`),b.click()):P.info(`\u{1F3AF} No active confirm button found (attempt ${h})`),await this.delay(800)}})();let f=await this.waitForToken();await this.delay(500),P.success("\u2705 Token successfully captured through browser automation"),e(f)})();await Promise.race([a,i])}catch(i){P.error("\u274C Auto-CAPTCHA process failed:",i),n(i)}})()})}detectSitekey(e="0x4AAAAAABpqJe8FO0N84q0F"){var n;if(this.sitekey)return this.sitekey;try{let i=document.querySelector("[data-sitekey]");if(i){let c=i.getAttribute("data-sitekey");if(c&&c.length>10)return this.sitekey=c,P.info(`\u{1F50D} Sitekey detected from data attribute: ${c}`),c}let a=document.querySelector(".cf-turnstile");if((n=a==null?void 0:a.dataset)!=null&&n.sitekey&&a.dataset.sitekey.length>10)return this.sitekey=a.dataset.sitekey,P.info(`\u{1F50D} Sitekey detected from turnstile element: ${this.sitekey}`),this.sitekey;if(typeof window!="undefined"&&window.__TURNSTILE_SITEKEY&&window.__TURNSTILE_SITEKEY.length>10)return this.sitekey=window.__TURNSTILE_SITEKEY,P.info(`\u{1F50D} Sitekey detected from global variable: ${this.sitekey}`),this.sitekey;let s=document.querySelectorAll("script");for(let c of s){let r=(c.textContent||c.innerHTML).match(/sitekey['":.\s]+(['"]?[0-9a-zA-Z_-]{20,}['"]?)/i);if(r&&r[1]&&r[1].length>10)return this.sitekey=r[1].replace(/['"]/g,""),P.info(`\u{1F50D} Sitekey detected from script content: ${this.sitekey}`),this.sitekey}}catch(i){P.error("Error detecting sitekey:",i)}return P.info(`\u{1F50D} Using fallback sitekey: ${e}`),this.sitekey=e,e}waitForElement(e,n=200,i=1e4){return new Promise(a=>{let s=Date.now()+i,c=()=>{let r=document.querySelector(e);r?a(r):Date.now()<s?setTimeout(c,n):a(null)};c()})}waitForToken(){return new Promise(e=>{let n=Date.now(),i=()=>{this.isValidToken()?e(this.currentToken):Date.now()-n<25e3?setTimeout(i,200):e(null)};i()})}delay(e){return new Promise(n=>setTimeout(n,e))}cleanup(){this.widgetContainer&&(this.widgetContainer.remove(),this.widgetContainer=null),this.overlayContainer&&(this.overlayContainer.remove(),this.overlayContainer=null),this.originalFetch&&window.fetch!==this.originalFetch&&(window.fetch=this.originalFetch),this.widgetId=null,this.currentSitekey=null,this.currentToken=null,this.tokenExpireTime=0}},Z=new G;var K=class{constructor(){this.baseUrl="https://backend.wplace.live/s0",this.canvasBaseUrl="https://canvas.wplace.live/s0",this.maxRetries=3,this.retryDelay=1e3,this.requestQueue=[],this.isProcessingQueue=!1,this.ratelimitDelay=100}async makeRequest(e,n={}){let i=`${this.baseUrl}${e}`,a=null;for(let s=1;s<=this.maxRetries;s++)try{P.info(`\u{1F310} API Request (attempt ${s}/${this.maxRetries}): ${e}`);let c=await Z.getToken(s>1);if(!c)throw new Error("Failed to get Turnstile token");let r={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","User-Agent":"WPlace-Bot/1.0",...n.headers},body:JSON.stringify({t:c,...n.data}),...n.fetchOptions},p=await fetch(i,r);if(p.ok){let d=await p.json();return P.success(`\u2705 API Request successful: ${e}`),d}let u=await p.text(),l=new Error(`HTTP ${p.status}: ${u}`);if(l.status=p.status,l.response=p,(p.status===403||p.status===400)&&(P.warn(`\u{1F504} Status ${p.status} detected, invalidating token and retrying...`),Z.invalidateToken(),s<this.maxRetries)){await this.delay(this.retryDelay*s);continue}if(p.status===429){let d=p.headers.get("Retry-After")||5;if(P.warn(`\u23F3 Rate limited, waiting ${d}s before retry...`),await this.delay(parseInt(d)*1e3),s<this.maxRetries)continue}throw l}catch(c){if(a=c,P.error(`\u274C API Request failed (attempt ${s}/${this.maxRetries}):`,c.message),s<this.maxRetries){let r=this.retryDelay*Math.pow(2,s-1);P.info(`\u23F3 Retrying in ${r}ms...`),await this.delay(r)}else P.error(`\u274C All ${this.maxRetries} attempts failed for ${e}`)}throw a}async paintPixelBatch(e){if(!e||!e.length)return{success:!0,painted:0,errors:[]};P.info(`\u{1F3A8} Starting batch paint operation for ${e.length} pixels`);let n={success:!0,painted:0,skipped:0,errors:[],responses:[]},i=await this.verifyPixelsNeedPaint(e),a=e.length-i.length;if(a>0&&(P.info(`\u{1F50D} Smart verification: ${a} pixels already correct, ${i.length} need painting`),n.skipped=a),i.length===0)return P.success("\u2705 All pixels already painted correctly, no work needed"),n;for(let s=0;s<i.length;s++){let c=i[s];try{await this.delay(this.ratelimitDelay);let r=await this.makeRequest("/pixel/",{data:{x:c.x,y:c.y,c:c.color}});r&&r.success!==!1?(n.painted++,P.debug(`\u2705 Painted pixel at (${c.x}, ${c.y}) with color ${c.color}`)):n.errors.push({pixel:c,error:"API returned unsuccessful response"}),n.responses.push(r)}catch(r){if(n.errors.push({pixel:c,error:r.message}),P.error(`\u274C Failed to paint pixel at (${c.x}, ${c.y}):`,r.message),r.status===401||r.message.includes("token")){P.error("\u{1F6D1} Critical authentication error, stopping batch operation"),n.success=!1;break}}}return P.info(`\u{1F3A8} Batch paint completed: ${n.painted} painted, ${n.skipped} skipped, ${n.errors.length} errors`),n}async verifyPixelsNeedPaint(e){try{let n=await this.getCanvasData();if(!n)return e;let i=[];for(let a of e)this.getPixelColorFromCanvas(n,a.x,a.y)!==a.color?i.push(a):P.debug(`\u{1F50D} Pixel at (${a.x}, ${a.y}) already has correct color ${a.color}`);return i}catch(n){return P.warn("\u26A0\uFE0F Canvas verification failed, will paint all pixels:",n.message),e}}async getCanvasData(){try{let e=await fetch(`${this.canvasBaseUrl}/canvas/`);if(e.ok)return await e.arrayBuffer()}catch(e){P.warn("\u26A0\uFE0F Failed to fetch canvas data:",e.message)}return null}getPixelColorFromCanvas(e,n,i){try{let a=new Uint8Array(e),c=(i*4e3+n)*4;if(c>=0&&c<a.length)return a[c]}catch(a){P.debug("Failed to extract pixel color:",a.message)}return null}async getUserInfo(){try{return await this.makeRequest("/user/")}catch(e){throw P.error("Failed to get user info:",e.message),e}}async getPixelInfo(e,n){try{return await this.makeRequest("/pixel/info",{data:{x:e,y:n}})}catch(i){throw P.error(`Failed to get pixel info at (${e}, ${n}):`,i.message),i}}async getCooldownInfo(){try{return await this.makeRequest("/cooldown/")}catch(e){throw P.error("Failed to get cooldown info:",e.message),e}}async healthCheck(){try{return(await fetch(`${this.baseUrl}/health`)).ok}catch{return!1}}delay(e){return new Promise(n=>setTimeout(n,e))}cleanup(){this.requestQueue=[],this.isProcessingQueue=!1}},re=new K;async function se(g,e,n,i,a){var l,d,f;let{width:s,height:c}=g,{x:r,y:p}=e;o(`Iniciando pintado: imagen(${s}x${c}) inicio LOCAL(${r},${p}) tile(${t.tileX},${t.tileY})`),o("[PAINTER] \u{1F50D} DEBUGGING imageState.remainingPixels:"),o(`[PAINTER] \u{1F4CA} exists: ${!!t.remainingPixels}`),o(`[PAINTER] \u{1F4CA} length: ${((l=t.remainingPixels)==null?void 0:l.length)||0}`),o(`[PAINTER] \u{1F4CA} lastPosition: (${((d=t.lastPosition)==null?void 0:d.x)||0}, ${((f=t.lastPosition)==null?void 0:f.y)||0})`);let u=!t.remainingPixels||t.remainingPixels.length===0||t.lastPosition.x===0&&t.lastPosition.y===0;if(o(`[PAINTER] \u{1F4CA} needsGeneration: ${u}`),u){if(o("\u{1F504} Generando cola de p\xEDxeles con Blue Marble Processor..."),t.imageData&&t.imageData.processor){o("\u2705 Usando Blue Marble processor para generar cola...");let h=t.imageData.processor;t.remainingPixels=h.generatePixelQueue(),o(`\u{1F4CA} Blue Marble gener\xF3: ${t.remainingPixels.length} p\xEDxeles con alignment correcto`)}else o("\u26A0\uFE0F FALLBACK: Blue Marble processor no disponible, usando funci\xF3n antigua..."),t.remainingPixels=Se(g,e,t.tileX,t.tileY),o(`\u{1F4CA} Funci\xF3n antigua gener\xF3: ${t.remainingPixels.length} p\xEDxeles (SIN alignment)`);(t.lastPosition.x>0||t.lastPosition.y>0)&&(t.remainingPixels=t.remainingPixels.filter(h=>{let b=h.imageY*s+h.imageX,m=t.lastPosition.y*s+t.lastPosition.x;return b>=m})),o(`Cola generada: ${t.remainingPixels.length} p\xEDxeles pendientes`);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),t.startPosition&&t.tileX!==void 0&&t.tileY!==void 0&&window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:t.tileX,tileY:t.tileY,pxX:t.startPosition.x,pxY:t.startPosition.y}),window.__WPA_PLAN_OVERLAY__.setPlan(t.remainingPixels,{enabled:!0,nextBatchCount:t.pixelsPerBatch}),o(`\u2705 Plan overlay actualizado con ${t.remainingPixels.length} p\xEDxeles en cola`))}catch(h){o("\u26A0\uFE0F Error actualizando plan overlay:",h)}}try{for(;t.remainingPixels.length>0&&!t.stopFlag;){let h=Math.floor(t.currentCharges),b;if(t.isFirstBatch&&t.useAllChargesFirst&&h>0?(b=Math.min(h,t.remainingPixels.length),t.isFirstBatch=!1,o(`Primera pasada: usando ${b} cargas de ${h} disponibles`)):b=Math.min(t.pixelsPerBatch,t.remainingPixels.length),h<b){o(`Cargas insuficientes: ${h}/${b} necesarias`),await Ae(b-h,n),h=Math.floor(t.currentCharges),t.isFirstBatch||(b=Math.min(t.pixelsPerBatch,t.remainingPixels.length,h));continue}let m=t.remainingPixels.splice(0,b);o(`Pintando lote de ${m.length} p\xEDxeles...`);try{window.__WPA_PLAN_OVERLAY__&&window.__WPA_PLAN_OVERLAY__.setPlan(t.remainingPixels,{enabled:!0,nextBatchCount:t.pixelsPerBatch})}catch(y){o("\u26A0\uFE0F Error actualizando plan overlay durante pintado:",y)}let w=await Ce(m,n);if(w.success&&w.painted>0){if(t.paintedPixels+=w.painted,t.currentCharges=Math.max(0,t.currentCharges-w.painted),o(`Cargas despu\xE9s del lote: ${t.currentCharges.toFixed(1)} (consumidas: ${w.painted})`),m.length>0){let L=m[m.length-1];t.lastPosition={x:L.imageX,y:L.imageY}}o(`Lote exitoso: ${w.painted}/${m.length} p\xEDxeles pintados. Total: ${t.paintedPixels}/${t.totalPixels}`);let y=Le(),C=(t.paintedPixels/t.totalPixels*100).toFixed(1),S=v("image.passCompleted",{painted:w.painted,percent:C,current:t.paintedPixels,total:t.totalPixels});n&&n(t.paintedPixels,t.totalPixels,S,y),await z(2e3)}else w.shouldContinue?o("Lote fall\xF3 despu\xE9s de todos los reintentos, continuando con siguiente lote..."):(t.remainingPixels.unshift(...m),o("Lote fall\xF3: reintentando en 5 segundos..."),await z(5e3));await z(500)}if(t.stopFlag)o(`Pintado pausado en p\xEDxel imagen(${t.lastPosition.x},${t.lastPosition.y})`),i&&i(!1,t.paintedPixels);else{o(`Pintado completado: ${t.paintedPixels} p\xEDxeles pintados`),t.lastPosition={x:0,y:0},t.remainingPixels=[];try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.setPlan([],{enabled:!0,nextBatchCount:0}),o("\u2705 Plan overlay limpiado al completar pintado"))}catch(h){o("\u26A0\uFE0F Error limpiando plan overlay:",h)}i&&i(!0,t.paintedPixels)}}catch(h){o("Error en proceso de pintado:",h),a&&a(h)}}async function ve(g){try{if(!g||g.length===0)return{success:!1,painted:0,error:"Lote vac\xEDo"};let e=new Map;for(let i of g){if(!i){o("paintPixelBatch: skipping undefined pixel");continue}if(i.localX==null||i.localY==null||i.tileX==null||i.tileY==null){o("paintPixelBatch: skipping pixel with missing coordinates",i);continue}if(!i.color){o("paintPixelBatch: skipping pixel with missing color",i);continue}let a=i.color.id||i.color.value||null;if(a===null){o("paintPixelBatch: skipping pixel with invalid color",i);continue}let s=`${i.tileX}:${i.tileY}`;e.has(s)||e.set(s,{tileX:i.tileX,tileY:i.tileY,coords:[],colors:[]});let c=e.get(s);c.coords.push(i.localX,i.localY),c.colors.push(a),e.get(s).coords.length<=6&&o(`[PAINTER] \u{1F3A8} Pixel ${Math.ceil(e.get(s).coords.length/2)}: tile(${i.tileX},${i.tileY}) local(${i.localX},${i.localY}) imagePos(${i.imageX||"?"},${i.imageY||"?"}) color(${a})`)}if(e.size===0)return{success:!1,painted:0,error:"No valid pixels in batch"};let n=[];for(let[,i]of e.entries())for(let a=0;a<i.coords.length;a++){let[s,c]=i.coords[a];n.push({x:s,y:c,color:i.colors[a]})}try{let i=await re.paintPixelBatch(n);return{success:i.success,painted:i.painted,skipped:i.skipped,errors:i.errors}}catch(i){return o("paintPixelBatch: Enhanced API error:",i.message),{success:!1,painted:0,error:i.message}}}catch(e){return o("Error en paintPixelBatch:",e),{success:!1,painted:0,error:e.message}}}async function Ce(g,e){for(let s=1;s<=5;s++)try{let c=await ve(g);if(c.success)return t.retryCount=0,c;if(t.retryCount=s,s<5){let r=3e3*Math.pow(2,s-1),p=Math.round(r/1e3),u;c.status===0||c.status==="NetworkError"?u=v("image.networkError"):c.status>=500?u=v("image.serverError"):c.status===408?u=v("image.timeoutError"):u=v("image.retryAttempt",{attempt:s,maxAttempts:5,delay:p}),e&&e(t.paintedPixels,t.totalPixels,u),o(`Reintento ${s}/5 despu\xE9s de ${p}s. Error: ${c.error}`),await z(r)}}catch(c){if(o(`Error en intento ${s}:`,c),t.retryCount=s,s<5){let r=3e3*Math.pow(2,s-1),p=Math.round(r/1e3),u=v("image.retryError",{attempt:s,maxAttempts:5,delay:p});e&&e(t.paintedPixels,t.totalPixels,u),await z(r)}}t.retryCount=5;let a=v("image.retryFailed",{maxAttempts:5});return e&&e(t.paintedPixels,t.totalPixels,a),o("Fall\xF3 despu\xE9s de 5 intentos, continuando con siguiente lote"),{success:!1,painted:0,error:"Fall\xF3 despu\xE9s de 5 intentos",shouldContinue:!0}}async function Ae(g,e){let i=_.CHARGE_REGEN_MS*g+5e3;if(o(`Esperando ${Math.round(i/1e3)}s para obtener ${g} cargas`),t.inCooldown=!0,t.cooldownEndTime=Date.now()+i,t.nextBatchCooldown=Math.round(i/1e3),e){let a=Math.floor(i/6e4),s=Math.floor(i%6e4/1e3),c=a>0?`${a}m ${s}s`:`${s}s`,r=v("image.waitingChargesRegen",{current:Math.floor(t.currentCharges),needed:g,time:c});e(t.paintedPixels,t.totalPixels,r)}for(let a=Math.round(i/1e3);a>0&&!t.stopFlag;a--){if(t.nextBatchCooldown=a,e&&(a%5===0||a<=10||a===Math.round(i/1e3))){let s=Math.floor(a/60),c=a%60,r=s>0?`${s}m ${c}s`:`${c}s`,p=v("image.waitingChargesCountdown",{current:Math.floor(t.currentCharges),needed:g,time:r});e(t.paintedPixels,t.totalPixels,p)}await z(1e3)}t.inCooldown=!1,t.nextBatchCooldown=0,t.currentCharges=Math.min(t.maxCharges||50,t.currentCharges+i/_.CHARGE_REGEN_MS)}function Se(g,e,n,i){var u,l;let{pixels:a}=g,{x:s,y:c}=e,r=[],p=0;for(let d of a){let f=typeof d.x=="number"&&typeof d.y=="number"||typeof d.imageX=="number"&&typeof d.imageY=="number";if(!d||!f){p++,o("generatePixelQueue: skipping pixel with missing coordinates",d);continue}let h=(u=d.imageX)!=null?u:d.x,b=(l=d.imageY)!=null?l:d.y,m=d.color||d.targetColor;if(!m||!m.id&&!m.value){p++,o("generatePixelQueue: skipping pixel with missing/invalid color",d);continue}let w,y,C,S;if(d.tileX!=null&&d.tileY!=null&&d.localX!=null&&d.localY!=null)w=d.tileX,y=d.tileY,C=d.localX,S=d.localY;else{let L=s+h,E=c+b;w=n,y=i,C=L,S=E}r.push({imageX:h,imageY:b,localX:C,localY:S,tileX:w,tileY:y,color:m,originalColor:d.originalColor})}return p>0&&o(`\u26A0\uFE0F Se omitieron ${p} p\xEDxeles inv\xE1lidos durante la generaci\xF3n de la cola`),o(`Cola de p\xEDxeles generada: ${r.length} p\xEDxeles para pintar`),r}function Le(){if(!t.remainingPixels||t.remainingPixels.length===0)return 0;let g=t.remainingPixels.length,e=t.pixelsPerBatch,n=_.CHARGE_REGEN_MS/1e3,i=Math.ceil(g/e),a=e*n,s=(i-1)*a,c=i*2;return Math.ceil(s+c)}function Q(){t.stopFlag=!0,t.running=!1,o("\u{1F6D1} Deteniendo proceso de pintado...")}function J(g=null){try{if(!t.imageData||t.paintedPixels===0)throw new Error("No hay progreso para guardar");let e={version:"1.0",timestamp:Date.now(),imageData:{width:t.imageData.width,height:t.imageData.height,originalName:t.originalImageName},progress:{paintedPixels:t.paintedPixels,totalPixels:t.totalPixels,lastPosition:{...t.lastPosition}},position:{startPosition:{...t.startPosition},tileX:t.tileX,tileY:t.tileY},config:{pixelsPerBatch:t.pixelsPerBatch,useAllChargesFirst:t.useAllChargesFirst,isFirstBatch:t.isFirstBatch,maxCharges:t.maxCharges},colors:t.availableColors.map(r=>({id:r.id,r:r.r,g:r.g,b:r.b})),remainingPixels:t.remainingPixels||[]},n=JSON.stringify(e,null,2),i=new window.Blob([n],{type:"application/json"}),a=g||`wplace_progress_${t.originalImageName||"image"}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,s=window.URL.createObjectURL(i),c=document.createElement("a");return c.href=s,c.download=a,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(s),o(`\u2705 Progreso guardado: ${a}`),{success:!0,filename:a}}catch(e){return o("\u274C Error guardando progreso:",e),{success:!1,error:e.message}}}async function ce(g){return new Promise(e=>{try{let n=new window.FileReader;n.onload=i=>{try{let a=JSON.parse(i.target.result),c=["imageData","progress","position","colors"].filter(r=>!(r in a));if(c.length>0)throw new Error(`Campos requeridos faltantes: ${c.join(", ")}`);if(t.availableColors.length>0){let r=a.colors.map(l=>l.id),p=t.availableColors.map(l=>l.id);r.filter(l=>p.includes(l)).length<r.length*.8&&o("\u26A0\uFE0F Los colores guardados no coinciden completamente con los actuales")}t.imageData={...a.imageData,pixels:[]},t.paintedPixels=a.progress.paintedPixels,t.totalPixels=a.progress.totalPixels,a.progress.lastPosition?t.lastPosition=a.progress.lastPosition:a.position.lastX!==void 0&&a.position.lastY!==void 0&&(t.lastPosition={x:a.position.lastX,y:a.position.lastY}),a.position.startPosition?t.startPosition=a.position.startPosition:a.position.startX!==void 0&&a.position.startY!==void 0&&(t.startPosition={x:a.position.startX,y:a.position.startY}),t.tileX=a.position.tileX,t.tileY=a.position.tileY,t.originalImageName=a.imageData.originalName,t.remainingPixels=a.remainingPixels||a.progress.remainingPixels||[];try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),t.startPosition&&t.tileX!==void 0&&t.tileY!==void 0&&(window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:t.tileX,tileY:t.tileY,pxX:t.startPosition.x,pxY:t.startPosition.y}),o(`\u2705 Plan overlay anclado con posici\xF3n cargada: tile(${t.tileX},${t.tileY}) local(${t.startPosition.x},${t.startPosition.y})`)),window.__WPA_PLAN_OVERLAY__.setPlan(t.remainingPixels,{enabled:!0,nextBatchCount:t.pixelsPerBatch}),o(`\u2705 Plan overlay activado con ${t.remainingPixels.length} p\xEDxeles restantes`))}catch(r){o("\u26A0\uFE0F Error activando plan overlay al cargar progreso:",r)}a.config&&(t.pixelsPerBatch=a.config.pixelsPerBatch||t.pixelsPerBatch,t.useAllChargesFirst=a.config.useAllChargesFirst!==void 0?a.config.useAllChargesFirst:t.useAllChargesFirst,t.isFirstBatch=a.config.isFirstBatch!==void 0?a.config.isFirstBatch:!0,t.maxCharges=a.config.maxCharges||t.maxCharges),t.imageLoaded=!0,t.colorsChecked=!0,o(`\u2705 Progreso cargado: ${t.paintedPixels}/${t.totalPixels} p\xEDxeles`),e({success:!0,data:a,painted:t.paintedPixels,total:t.totalPixels,canContinue:t.remainingPixels.length>0})}catch(a){o("\u274C Error parseando archivo de progreso:",a),e({success:!1,error:a.message})}},n.onerror=()=>{let i="Error leyendo archivo";o("\u274C",i),e({success:!1,error:i})},n.readAsText(g)}catch(n){o("\u274C Error cargando progreso:",n),e({success:!1,error:n.message})}})}function de(){t.paintedPixels=0,t.totalPixels=0,t.lastPosition={x:0,y:0},t.remainingPixels=[],t.imageData=null,t.startPosition=null,t.imageLoaded=!1,t.originalImageName=null,t.isFirstBatch=!0,t.nextBatchCooldown=0,o("\u{1F9F9} Progreso limpiado")}function le(){return t.imageLoaded&&t.paintedPixels>0&&t.remainingPixels&&t.remainingPixels.length>0}function ue(){return{hasProgress:le(),painted:t.paintedPixels,total:t.totalPixels,remaining:t.remainingPixels?t.remainingPixels.length:0,percentage:t.totalPixels>0?t.paintedPixels/t.totalPixels*100:0,lastPosition:{...t.lastPosition},canContinue:le()}}function ge(g=null){let e=document.createElement("div");g&&(e.id=g),e.style.cssText=`
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 2147483647;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  `;let n=e.attachShadow({mode:"open"});return document.body.appendChild(e),{host:e,root:n}}function pe(g,e){let n=0,i=0,a=0,s=0;g.style.cursor="move",g.addEventListener("mousedown",c);function c(u){u.target.closest(".header-btn, .wplace-header-btn")||(u.preventDefault(),a=u.clientX,s=u.clientY,document.addEventListener("mouseup",p),document.addEventListener("mousemove",r))}function r(u){u.preventDefault(),n=a-u.clientX,i=s-u.clientY,a=u.clientX,s=u.clientY,e.style.top=e.offsetTop-i+"px",e.style.left=e.offsetLeft-n+"px"}function p(){document.removeEventListener("mouseup",p),document.removeEventListener("mousemove",r)}}async function me({texts:g,...e}){if(o("\u{1F3A8} Creando interfaz de Auto-Image"),!document.querySelector('link[href*="font-awesome"]')){let x=document.createElement("link");x.rel="stylesheet",x.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css",document.head.appendChild(x),o("\u{1F4E6} FontAwesome a\xF1adido al document.head")}let{host:n,root:i}=ge(),a=document.createElement("style");a.textContent=`
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0, 255, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0); }
    }
    
    .container {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 300px;
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 0;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      z-index: 9998;
      font-family: 'Segoe UI', Roboto, sans-serif;
      color: #eee;
      animation: slideIn 0.4s ease-out;
      overflow: hidden;
    }
    
    .header {
      padding: 12px 15px;
      background: #2d3748;
      color: #60a5fa;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: move;
      user-select: none;
    }
    
    .header-title {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .header-controls {
      display: flex;
      gap: 10px;
    }
    
    .header-btn {
      background: none;
      border: none;
      color: #eee;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
      padding: 5px;
    }
    
    .header-btn:hover {
      opacity: 1;
    }
    
    .content {
      padding: 15px;
      display: block;
    }
    
    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .config-panel {
      display: none;
      background: #2d3748;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    
    .config-panel.visible {
      display: block;
    }
    
    .config-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .config-input {
      width: 60px;
      padding: 4px;
      border: 1px solid #333;
      border-radius: 4px;
      background: #1a1a1a;
      color: #eee;
      text-align: center;
    }
    
    .config-checkbox {
      margin-right: 8px;
    }
    
    .main-config {
      background: #2d3748;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 10px;
      border: 1px solid #3a4553;
    }
    
    .config-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    
    .config-label {
      font-size: 13px;
      color: #cbd5e0;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .batch-value, .cooldown-value {
      font-weight: bold;
      color: #60a5fa;
    }
    
    .btn {
      padding: 10px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
      font-size: 14px;
    }
    
    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }
    
    .btn-primary {
      background: #60a5fa;
      color: white;
    }
    
    .btn-upload {
      background: #2d3748;
      color: white;
      border: 1px dashed #eee;
    }
    
    .btn-load {
      background: #2196F3;
      color: white;
    }
    
    .btn-start {
      background: #10b981;
      color: white;
    }
    
    .btn-stop {
      background: #ef4444;
      color: white;
    }
    
    .btn-select {
      background: #f59e0b;
      color: black;
    }
    
    .progress {
      width: 100%;
      background: #2d3748;
      border-radius: 4px;
      margin: 10px 0;
      overflow: hidden;
      height: 10px;
    }
    
    .progress-bar {
      height: 100%;
      background: #60a5fa;
      transition: width 0.3s;
      width: 0%;
    }
    
    .stats {
      background: #2d3748;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
    }
    
    .stat-item {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
      font-size: 14px;
    }
    
    .stat-label {
      display: flex;
      align-items: center;
      gap: 6px;
      opacity: 0.8;
    }
    
    .status {
      padding: 8px;
      border-radius: 4px;
      text-align: center;
      font-size: 13px;
    }
    
    .status-default {
      background: rgba(255,255,255,0.1);
    }
    
    .status-success {
      background: rgba(0, 255, 0, 0.1);
      color: #10b981;
    }
    
    .status-error {
      background: rgba(255, 0, 0, 0.1);
      color: #ef4444;
    }
    
    .status-warning {
      background: rgba(255, 165, 0, 0.1);
      color: orange;
    }
    
    .status-info {
      background: rgba(0, 150, 255, 0.1);
      color: #60a5fa;
    }
    
    .minimized .content {
      display: none;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 10001;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal {
      background: #1a1a1a;
      border: 2px solid #333;
      border-radius: 15px;
      padding: 25px;
      color: #eee;
      min-width: 350px;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    
    .modal h3 {
      margin: 0 0 15px 0;
      text-align: center;
      font-size: 18px;
    }
    
    .modal p {
      margin: 0 0 20px 0;
      text-align: center;
      line-height: 1.4;
    }
    
    .modal-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    
    .modal-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 100px;
    }
    
    .modal-btn-save {
      background: #10b981;
      color: white;
    }
    
    .modal-btn-discard {
      background: #ef4444;
      color: white;
    }
    
    .modal-btn-cancel {
      background: #2d3748;
      color: white;
    }
    
    .modal-btn:hover {
      transform: translateY(-2px);
    }
    
    /* Resize Dialog Styles */
    .resize-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 9999;
      display: none;
    }
    
    .resize-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      z-index: 10000;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      max-width: 90%;
      max-height: 90%;
      overflow: auto;
      color: #ffffff;
      display: none;
    }
    
    .resize-container h3 {
      margin: 0 0 15px 0;
      color: #ffffff;
    }
    
    .resize-controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 15px;
    }
    
    .resize-controls label {
      color: #ffffff;
      font-size: 14px;
    }
    
    .resize-slider {
      width: 100%;
      margin: 5px 0;
    }
    
    .resize-preview {
      max-width: 100%;
      max-height: 300px;
      margin: 10px 0;
      border: 1px solid #333;
      display: block;
    }
    
    .resize-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
  `,i.appendChild(a);let s=document.createElement("div");s.className="container",s.innerHTML=`
    <div class="header">
      <div class="header-title">
        \u{1F5BC}\uFE0F
        <span>${g.title}</span>
      </div>
      <div class="header-controls">
        <button class="header-btn config-btn" title="Configuraci\xF3n">
          \u2699\uFE0F
        </button>
        <button class="header-btn minimize-btn" title="${g.minimize}">
          \u2796
        </button>
      </div>
    </div>
    <div class="content">
      <div class="config-panel">
        <div class="config-item">
          <label>${g.batchSize}:</label>
          <input class="config-input pixels-per-batch" type="number" min="1" max="50" value="20">
        </div>
        <div class="config-item">
          <label>
            <input class="config-checkbox use-all-charges" type="checkbox" checked>
            ${g.useAllCharges}
          </label>
        </div>
        <div class="config-item">
          <label>
            <input class="config-checkbox show-overlay" type="checkbox" checked>
            ${g.showOverlay||"Mostrar overlay"}
          </label>
        </div>
      </div>
      
      <!-- Configuraci\xF3n visible en la interfaz principal -->
      <div class="main-config">
        <div class="config-row">
          <div class="config-label">
            \u{1F3AF} ${g.batchSize}:
            <span class="batch-value">20</span>
          </div>
          <div class="config-label">
            \u23F1\uFE0F ${g.nextBatchTime}:
            <span class="cooldown-value">--</span>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn btn-primary init-btn">
          \u{1F916}
          <span>${g.initBot}</span>
        </button>
        <button class="btn btn-upload upload-btn" disabled>
          \u{1F4E4}
          <span>${g.uploadImage}</span>
        </button>
        <button class="btn btn-load load-progress-btn" disabled>
          \u{1F4C1}
          <span>${g.loadProgress}</span>
        </button>
        <button class="btn btn-primary resize-btn" disabled>
          \u{1F504}
          <span>${g.resizeImage}</span>
        </button>
        <button class="btn btn-select select-pos-btn" disabled>
          \u{1F3AF}
          <span>${g.selectPosition}</span>
        </button>
        <button class="btn btn-start start-btn" disabled>
          \u25B6\uFE0F
          <span>${g.startPainting}</span>
        </button>
        <button class="btn btn-stop stop-btn" disabled>
          \u23F9\uFE0F
          <span>${g.stopPainting}</span>
        </button>
      </div>
      
      <div class="progress">
        <div class="progress-bar"></div>
      </div>
      
      <div class="stats">
        <div class="stats-area">
          <div class="stat-item">
            <div class="stat-label">\u2139\uFE0F ${g.initMessage}</div>
          </div>
        </div>
      </div>
      
      <div class="status status-default">
        ${g.waitingInit}
      </div>
    </div>
  `,i.appendChild(s);let c=document.createElement("input");c.type="file",c.accept="image/png,image/jpeg",c.style.display="none",i.appendChild(c);let r=document.createElement("input");r.type="file",r.accept=".json",r.style.display="none",i.appendChild(r);let p=document.createElement("div");p.className="resize-overlay",i.appendChild(p);let u=document.createElement("div");u.className="resize-container",u.innerHTML=`
    <h3>${g.resizeImage}</h3>
    <div class="resize-controls">
      <label>
        ${g.width}: <span class="width-value">0</span>px
        <input type="range" class="resize-slider width-slider" min="10" max="500" value="100">
      </label>
      <label>
        ${g.height}: <span class="height-value">0</span>px
        <input type="range" class="resize-slider height-slider" min="10" max="500" value="100">
      </label>
      <label>
        <input type="checkbox" class="keep-aspect" checked>
        ${g.keepAspect}
      </label>
      <img class="resize-preview" src="" alt="Preview">
      <div class="resize-buttons">
        <button class="btn btn-primary confirm-resize">
          \u2705
          <span>${g.apply}</span>
        </button>
        <button class="btn btn-stop cancel-resize">
          \u274C
          <span>${g.cancel}</span>
        </button>
      </div>
    </div>
  `,i.appendChild(u);let l={header:s.querySelector(".header"),configBtn:s.querySelector(".config-btn"),minimizeBtn:s.querySelector(".minimize-btn"),configPanel:s.querySelector(".config-panel"),pixelsPerBatch:s.querySelector(".pixels-per-batch"),useAllCharges:s.querySelector(".use-all-charges"),showOverlay:s.querySelector(".show-overlay"),batchValue:s.querySelector(".batch-value"),cooldownValue:s.querySelector(".cooldown-value"),initBtn:s.querySelector(".init-btn"),uploadBtn:s.querySelector(".upload-btn"),loadProgressBtn:s.querySelector(".load-progress-btn"),resizeBtn:s.querySelector(".resize-btn"),selectPosBtn:s.querySelector(".select-pos-btn"),startBtn:s.querySelector(".start-btn"),stopBtn:s.querySelector(".stop-btn"),progressBar:s.querySelector(".progress-bar"),statsArea:s.querySelector(".stats-area"),status:s.querySelector(".status"),content:s.querySelector(".content")},d={overlay:p,container:u,widthSlider:u.querySelector(".width-slider"),heightSlider:u.querySelector(".height-slider"),widthValue:u.querySelector(".width-value"),heightValue:u.querySelector(".height-value"),keepAspect:u.querySelector(".keep-aspect"),preview:u.querySelector(".resize-preview"),confirmBtn:u.querySelector(".confirm-resize"),cancelBtn:u.querySelector(".cancel-resize")},f={minimized:!1,configVisible:!1};pe(l.header,s),l.minimizeBtn.addEventListener("click",()=>{f.minimized=!f.minimized,f.minimized?(s.classList.add("minimized"),l.minimizeBtn.innerHTML="\u{1F53C}"):(s.classList.remove("minimized"),l.minimizeBtn.innerHTML="\u{1F53D}")}),l.configBtn.addEventListener("click",()=>{f.configVisible=!f.configVisible,f.configVisible?(l.configPanel.classList.add("visible"),l.configBtn.innerHTML="\u274C"):(l.configPanel.classList.remove("visible"),l.configBtn.innerHTML="\u2699\uFE0F")}),l.pixelsPerBatch.addEventListener("change",()=>{let x=parseInt(l.pixelsPerBatch.value)||20;l.batchValue.textContent=x,e.onConfigChange&&e.onConfigChange({pixelsPerBatch:x})}),l.useAllCharges.addEventListener("change",()=>{e.onConfigChange&&e.onConfigChange({useAllCharges:l.useAllCharges.checked})});function h(){l.uploadBtn.disabled=!1,l.loadProgressBtn.disabled=!1}l.initBtn.addEventListener("click",async()=>{l.initBtn.disabled=!0,e.onInitBot&&await e.onInitBot()&&h(),l.initBtn.disabled=!1}),l.uploadBtn.addEventListener("click",()=>{c.click()}),c.addEventListener("change",async()=>{c.files.length>0&&e.onUploadImage&&await e.onUploadImage(c.files[0])&&(l.selectPosBtn.disabled=!1,l.resizeBtn.disabled=!1)}),l.loadProgressBtn.addEventListener("click",()=>{r.click()}),r.addEventListener("change",async()=>{r.files.length>0&&e.onLoadProgress&&await e.onLoadProgress(r.files[0])&&(l.selectPosBtn.disabled=!1,l.startBtn.disabled=!1,l.resizeBtn.disabled=!1)}),l.resizeBtn.addEventListener("click",()=>{e.onResizeImage&&e.onResizeImage()}),l.selectPosBtn.addEventListener("click",async()=>{e.onSelectPosition&&(l.selectPosBtn.disabled=!0,await e.onSelectPosition()&&(l.startBtn.disabled=!1),l.selectPosBtn.disabled=!1)}),l.showOverlay.addEventListener("change",()=>{if(!window.__WPA_PLAN_OVERLAY__)return;window.__WPA_PLAN_OVERLAY__.injectStyles();let x=l.showOverlay.checked;window.__WPA_PLAN_OVERLAY__.setEnabled(x)}),l.startBtn.addEventListener("click",async()=>{e.onStartPainting&&(l.startBtn.disabled=!0,l.stopBtn.disabled=!1,await e.onStartPainting()||(l.startBtn.disabled=!1,l.stopBtn.disabled=!0))}),l.stopBtn.addEventListener("click",async()=>{e.onStopPainting&&await e.onStopPainting()&&(l.startBtn.disabled=!1,l.stopBtn.disabled=!0)});function b(x,A="default"){l.status.textContent=x,l.status.className=`status status-${A}`,l.status.style.animation="none",l.status.offsetWidth,l.status.style.animation="slideIn 0.3s ease-out"}function m(x){let{width:A,height:$}=x.getDimensions(),I=A/$;d.widthSlider.value=A,d.heightSlider.value=$,d.widthValue.textContent=A,d.heightValue.textContent=$,d.preview.src=x.img.src,d.overlay.style.display="block",d.container.style.display="block";let B=()=>{let M=parseInt(d.widthSlider.value),O=parseInt(d.heightSlider.value);d.widthValue.textContent=M,d.heightValue.textContent=O,d.preview.src=x.generatePreview(M,O)},k=()=>{if(d.keepAspect.checked){let M=parseInt(d.widthSlider.value),O=Math.round(M/I);d.heightSlider.value=O}B()},R=()=>{if(d.keepAspect.checked){let M=parseInt(d.heightSlider.value),O=Math.round(M*I);d.widthSlider.value=O}B()};d.widthSlider.addEventListener("input",k),d.heightSlider.addEventListener("input",R);let F=()=>{let M=parseInt(d.widthSlider.value),O=parseInt(d.heightSlider.value);e.onConfirmResize&&e.onConfirmResize(x,M,O),w()},N=()=>{w()};d.confirmBtn.addEventListener("click",F),d.cancelBtn.addEventListener("click",N),d.overlay.addEventListener("click",N),window.cleanupResizeDialog=()=>{d.widthSlider.removeEventListener("input",k),d.heightSlider.removeEventListener("input",R),d.confirmBtn.removeEventListener("click",F),d.cancelBtn.removeEventListener("click",N),d.overlay.removeEventListener("click",N)},B()}function w(){d.overlay.style.display="none",d.container.style.display="none",window.cleanupResizeDialog&&(window.cleanupResizeDialog(),delete window.cleanupResizeDialog)}function y(x,A,$=null){let I=A>0?x/A*100:0;l.progressBar.style.width=`${I}%`;let B=`
      <div class="stat-item">
        <div class="stat-label">\u{1F3A8} ${g.progress}</div>
        <div>${x}/${A} (${I.toFixed(1)}%)</div>
      </div>
    `;if($&&($.username&&(B+=`
          <div class="stat-item">
            <div class="stat-label">\u{1F464} ${g.userName}</div>
            <div>${$.username}</div>
          </div>
        `),$.charges!==void 0&&(B+=`
          <div class="stat-item">
            <div class="stat-label">\u26A1 ${g.charges}</div>
            <div>${Math.floor($.charges)}</div>
          </div>
        `),$.pixels!==void 0&&(B+=`
          <div class="stat-item">
            <div class="stat-label">\u{1F533} ${g.pixels}</div>
            <div>${$.pixels.toLocaleString()}</div>
          </div>
        `),$.estimatedTime!==void 0&&$.estimatedTime>0)){let k=Math.floor($.estimatedTime/3600),R=Math.floor($.estimatedTime%3600/60),F=k>0?`${k}h ${R}m`:`${R}m`;B+=`
          <div class="stat-item">
            <div class="stat-label">\u23F0 ${g.timeRemaining}</div>
            <div>${F}</div>
          </div>
        `}l.statsArea.innerHTML=B}function C(x){if(x>0){let A=Math.floor(x/60),$=x%60,I=A>0?`${A}m ${$}s`:`${$}s`;l.cooldownValue.textContent=I}else l.cooldownValue.textContent="--"}function S(x){x&&x.includes("\u23F3")?(l.status.textContent=x,l.status.className="status status-info"):x&&b(x,"info")}function L(x){x?(l.initBtn.disabled=!0,l.initBtn.style.opacity="0.6",l.initBtn.innerHTML=`\u2705 <span>${g.initBot} - Completado</span>`):(l.initBtn.disabled=!1,l.initBtn.style.opacity="1",l.initBtn.innerHTML=`\u{1F916} <span>${g.initBot}</span>`)}function E(x){l.initBtn.style.display=x?"flex":"none"}function T(){n.remove()}return o("\u2705 Interfaz de Auto-Image creada"),{setStatus:b,updateProgress:y,updateCooldownDisplay:C,updateCooldownMessage:S,setInitialized:L,setInitButtonVisible:E,enableButtonsAfterInit:h,showResizeDialog:m,closeResizeDialog:w,destroy:T}}function he(g,e,n={}){return new Promise(i=>{let a=document.createElement("div");a.className="modal-overlay",a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.background="rgba(0,0,0,0.7)",a.style.zIndex="10001",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center";let s=document.createElement("div");s.style.background="#1a1a1a",s.style.border="2px solid #333",s.style.borderRadius="15px",s.style.padding="25px",s.style.color="#eee",s.style.minWidth="350px",s.style.maxWidth="400px",s.style.boxShadow="0 10px 30px rgba(0,0,0,0.5)",s.style.fontFamily="'Segoe UI', Roboto, sans-serif",s.innerHTML=`
      <h3 style="margin: 0 0 15px 0; text-align: center; font-size: 18px;">${e}</h3>
      <p style="margin: 0 0 20px 0; text-align: center; line-height: 1.4;">${g}</p>
      <div style="display: flex; gap: 10px; justify-content: center;">
        ${n.save?`<button class="save-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #10b981; color: white;">${n.save}</button>`:""}
        ${n.discard?`<button class="discard-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #ef4444; color: white;">${n.discard}</button>`:""}
        ${n.cancel?`<button class="cancel-btn" style="padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; min-width: 100px; background: #2d3748; color: white;">${n.cancel}</button>`:""}
      </div>
    `,a.appendChild(s),document.body.appendChild(a);let c=s.querySelector(".save-btn"),r=s.querySelector(".discard-btn"),p=s.querySelector(".cancel-btn"),u=()=>{document.body.removeChild(a)};c&&c.addEventListener("click",()=>{u(),i("save")}),r&&r.addEventListener("click",()=>{u(),i("discard")}),p&&p.addEventListener("click",()=>{u(),i("cancel")}),a.addEventListener("click",l=>{l.target===a&&(u(),i("cancel"))})})}var Te="https://backend.wplace.live";async function fe(){var g,e,n;try{let i=await fetch(`${Te}/me`,{credentials:"include"}).then(r=>r.json()),a=i||null,s=(i==null?void 0:i.charges)||{},c={count:(g=s.count)!=null?g:0,max:(e=s.max)!=null?e:0,cooldownMs:(n=s.cooldownMs)!=null?n:3e4};return{success:!0,data:{user:a,charges:c.count,maxCharges:c.max,chargeRegen:c.cooldownMs}}}catch(i){return{success:!1,error:i.message,data:{user:null,charges:0,maxCharges:0,chargeRegen:3e4}}}}function ee(){let g=['[data-testid="color-picker"]',".color-picker",".palette",'[class*="color"][class*="picker"]','[class*="palette"]'];for(let i of g){let a=document.querySelector(i);if(a&&a.offsetParent!==null)return!0}let e=document.querySelectorAll('[style*="background-color"], [style*="background:"], .color, [class*="color"]'),n=0;for(let i of e)if(i.offsetParent!==null&&i.offsetWidth>10&&i.offsetHeight>10&&(n++,n>=5))return!0;return!1}function xe(){let g=document.querySelector("button.btn.btn-primary.btn-lg, button.btn.btn-primary.sm\\:btn-xl");if(g){let i=g.textContent.toLowerCase().includes("paint"),a=g.querySelector('svg path[d*="240-120"]');if(i||a)return g.click(),!0}let e=document.querySelectorAll("button");for(let n of e)if(n.textContent.toLowerCase().includes("paint")&&n.offsetParent!==null&&!n.disabled)return n.click(),!0;return!1}(()=>{let e={enabled:!1,templates:[],templatesShouldBeDrawn:!0,tileSize:1e3,drawMult:3,pixelPlan:null,nextBatchCount:0,anchor:null,imageWidth:null,imageHeight:null,originalFetch:null,fetchedBlobQueue:new Map,isIntercepting:!1};function n(){console.log("[PLAN OVERLAY] Blue Marble tile system initialized")}function i(){e.isIntercepting||(e.originalFetch=window.fetch,e.isIntercepting=!0,window.fetch=async function(...m){var L;let w=await e.originalFetch.apply(this,m),y=w.clone(),C=(m[0]instanceof Request?(L=m[0])==null?void 0:L.url:m[0])||"ignore";if((y.headers.get("content-type")||"").includes("image/")&&C.includes("/tiles/")&&!C.includes("openfreemap")&&!C.includes("maps")){console.log("[PLAN OVERLAY] Intercepting tile request:",C);try{let E=await y.blob(),T=await s(E,C);return new Response(T,{headers:y.headers,status:y.status,statusText:y.statusText})}catch(E){return console.error("[PLAN OVERLAY] Error processing tile:",E),w}}return w},console.log("[PLAN OVERLAY] Fetch interception started"))}function a(){!e.isIntercepting||!e.originalFetch||(window.fetch=e.originalFetch,e.isIntercepting=!1,console.log("[PLAN OVERLAY] Fetch interception stopped"))}async function s(m,w){if(!e.enabled||!e.templatesShouldBeDrawn||!e.pixelPlan)return m;let y=w.split("/"),C=parseInt(y[y.length-1].replace(".png","")),S=parseInt(y[y.length-2]);if(isNaN(S)||isNaN(C))return console.warn("[PLAN OVERLAY] Could not extract tile coordinates from URL:",w),m;console.log(`[PLAN OVERLAY] Processing tile: ${S},${C}`);let L=c(S,C);if(L.length===0)return m;console.log(`[PLAN OVERLAY] Found ${L.length} pixels for tile ${S},${C}`);let E=e.tileSize*e.drawMult,T=await createImageBitmap(m),x=new OffscreenCanvas(E,E),A=x.getContext("2d");return A.imageSmoothingEnabled=!1,A.clearRect(0,0,E,E),A.drawImage(T,0,0,E,E),r(A,L,S,C),await x.convertToBlob({type:"image/png"})}function c(m,w){return!e.pixelPlan||!e.pixelPlan.pixels?[]:e.pixelPlan.pixels.filter(y=>{let C=Math.floor(y.globalX/4e3),S=Math.floor(y.globalY/4e3);return C===m&&S===w})}function r(m,w,y,C){let S=y*4e3,L=C*4e3;m.globalAlpha=.7;for(let E of w){let T=(E.globalX-S)*e.drawMult+1,x=(E.globalY-L)*e.drawMult+1;T>=0&&T<e.tileSize*e.drawMult&&x>=0&&x<e.tileSize*e.drawMult&&(m.fillStyle=`rgb(${E.r},${E.g},${E.b})`,m.fillRect(T,x,1,1))}if(e.nextBatchCount>0){m.globalAlpha=1;let E=w.slice(0,e.nextBatchCount);for(let T of E){let x=(T.globalX-S)*e.drawMult+1,A=(T.globalY-L)*e.drawMult+1;x>=0&&x<e.tileSize*e.drawMult&&A>=0&&A<e.tileSize*e.drawMult&&(m.fillStyle=`rgb(${T.r},${T.g},${T.b})`,m.fillRect(x,A,1,1))}}}function p(m){e.enabled=!!m,e.enabled?i():a(),console.log(`[PLAN OVERLAY] setEnabled: ${e.enabled}`)}function u(m,w={}){var C,S,L;if(!m||m.length===0){e.pixelPlan=null,console.log("[PLAN OVERLAY] Plan cleared");return}let y=[];for(let E of m){let T,x;if(typeof E.tileX=="number"&&typeof E.localX=="number")T=E.tileX*4e3+E.localX,x=E.tileY*4e3+E.localY;else if(w.anchor&&typeof E.imageX=="number"){let A=w.anchor.tileX*4e3+(w.anchor.pxX||0),$=w.anchor.tileY*4e3+(w.anchor.pxY||0);T=A+E.imageX,x=$+E.imageY}else continue;y.push({globalX:T,globalY:x,r:((C=E.color)==null?void 0:C.r)||0,g:((S=E.color)==null?void 0:S.g)||0,b:((L=E.color)==null?void 0:L.b)||0})}e.pixelPlan={pixels:y},e.nextBatchCount=w.nextBatchCount||0,e.anchor=w.anchor||null,e.imageWidth=w.imageWidth||null,e.imageHeight=w.imageHeight||null,console.log(`[PLAN OVERLAY] Plan set: ${y.length} pixels`),typeof w.enabled=="boolean"&&p(w.enabled)}function l(m){e.nextBatchCount=Math.max(0,Number(m||0)),console.log(`[PLAN OVERLAY] Next batch count: ${e.nextBatchCount}`)}function d(m){e.anchor=m,console.log("[PLAN OVERLAY] Anchor set:",m)}function f(m,w){console.log("[PLAN OVERLAY] CSS anchor set (ignored in tile system):",{x:m,y:w})}function h(){console.log("[PLAN OVERLAY] Selection mode ended (ignored in tile system)")}function b(){a(),e.pixelPlan=null,e.fetchedBlobQueue.clear(),console.log("[PLAN OVERLAY] Cleanup completed")}window.__WPA_PLAN_OVERLAY__={injectStyles:n,setEnabled:p,setPlan:u,setPlanItemsFromTileList:u,setNextBatchCount:l,setAnchor:d,setAnchorCss:f,endSelectionMode:h,render:()=>{},cleanup:b,get state(){return e}},console.log("[PLAN OVERLAY] Blue Marble tile system ready")})();async function we(){o("\u{1F680} Iniciando WPlace Auto-Image (versi\xF3n modular)"),q(),window.__wplaceBot={...window.__wplaceBot,imageRunning:!0};let g=null,e=window.fetch,n=()=>{window.fetch!==e&&(window.fetch=e,o("\u{1F504} Fetch original restaurado")),t.positionTimeoutId&&(clearTimeout(t.positionTimeoutId),t.positionTimeoutId=null),t.cleanupObserver&&(t.cleanupObserver(),t.cleanupObserver=null),t.selectingPosition=!1};try{let i={..._},a=W("image");if(t.language=oe(),!i.SITEKEY){let u=document.querySelector("*[data-sitekey]");u?(i.SITEKEY=u.getAttribute("data-sitekey"),o(`\u{1F4DD} Sitekey encontrada autom\xE1ticamente: ${i.SITEKEY.substring(0,20)}...`)):o("\u26A0\uFE0F No se pudo encontrar la sitekey autom\xE1ticamente")}async function s(){return o("\u{1F916} Intentando auto-inicio..."),ee()?(o("\u{1F3A8} Paleta de colores ya est\xE1 abierta"),!0):(o("\u{1F50D} Paleta no encontrada, buscando bot\xF3n Paint..."),xe()?(o("\u{1F446} Bot\xF3n Paint encontrado y presionado"),await z(2e3),ee()?(o("\u2705 Paleta abierta exitosamente"),!0):(o("\u274C La paleta no se abri\xF3 despu\xE9s de hacer clic"),!1)):(o("\u274C Bot\xF3n Paint no encontrado"),!1))}async function c(u=!1){o("\u{1F916} Inicializando Auto-Image..."),r.setStatus(v("image.checkingColors"),"info");let l=j();if(l.length===0)return r.setStatus(v("image.noColorsFound"),"error"),!1;let d=await fe(),f=null;d.success&&d.data.user?(f={username:d.data.user.name||"An\xF3nimo",charges:d.data.charges,maxCharges:d.data.maxCharges,pixels:d.data.user.pixelsPainted||0},g=f,t.currentCharges=d.data.charges,t.maxCharges=d.data.maxCharges||50,o(`\u{1F464} Usuario conectado: ${d.data.user.name||"An\xF3nimo"} - Cargas: ${f.charges}/${f.maxCharges} - P\xEDxeles: ${f.pixels}`)):o("\u26A0\uFE0F No se pudo obtener informaci\xF3n del usuario"),t.availableColors=l,t.colorsChecked=!0,r.setStatus(v("image.colorsFound",{count:l.length}),"success"),r.updateProgress(0,0,f),u||o(`\u2705 ${l.length} colores disponibles detectados`),r.setInitialized(!0),r.enableButtonsAfterInit();try{}catch{}return!0}let r=await me({texts:a,onConfigChange:u=>{u.pixelsPerBatch!==void 0&&(t.pixelsPerBatch=u.pixelsPerBatch),u.useAllCharges!==void 0&&(t.useAllChargesFirst=u.useAllCharges),o("Configuraci\xF3n actualizada:",u)},onInitBot:c,onUploadImage:async u=>{try{r.setStatus(v("image.loadingImage"),"info");let l=window.URL.createObjectURL(u),d=new U(l);d.originalName=u.name,await d.load();let f=d.initializeColorPalette();t.availableColors=f;let h=await d.analyzePixels();d.setCoords(0,0,0,0);let b=d.getImageData();t.imageData=b,t.imageData.processor=d,t.totalPixels=h.requiredPixels,t.paintedPixels=0,t.originalImageName=u.name,t.imageLoaded=!0,r.setStatus(v("image.imageLoaded",{count:h.requiredPixels}),"success"),r.updateProgress(0,h.requiredPixels,g),o(`\u2705 [BLUE MARBLE] Imagen cargada: ${b.width}x${b.height}, ${h.requiredPixels} p\xEDxeles v\xE1lidos`),o(`\u2705 [BLUE MARBLE] An\xE1lisis: ${h.uniqueColors} colores \xFAnicos, ${h.defacePixels} p\xEDxeles #deface`),window.URL.revokeObjectURL(l);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),window.__WPA_PLAN_OVERLAY__.setPlan([],{enabled:!0,nextBatchCount:0}),o("\u2705 Plan overlay activado autom\xE1ticamente al cargar imagen"))}catch(m){o("\u26A0\uFE0F Error activando plan overlay:",m)}return!0}catch(l){return r.setStatus(v("image.imageError"),"error"),o("\u274C Error cargando imagen:",l),!1}},onSelectPosition:async()=>new Promise(u=>{r.setStatus(v("image.selectPositionAlert"),"info"),r.setStatus(v("image.waitingPosition"),"info"),t.selectingPosition=!0;let l=!1,d=()=>{window.fetch=async(b,m)=>{var w,y,C,S,L;if(t.selectingPosition&&!l&&typeof b=="string"&&b.includes("/s0/pixel/")&&m&&m.method==="POST")try{o(`\u{1F3AF} Interceptando request de pintado: ${b}`);let E=await e(b,m);if(E.ok&&m.body){let T;try{T=JSON.parse(m.body)}catch(x){return o("Error parseando body del request:",x),E}if(T.coords&&Array.isArray(T.coords)&&T.coords.length>=2){let x=T.coords[0],A=T.coords[1];o(`[AUTO-IMAGE] \u{1F446} Usuario hizo clic: local(${x}, ${A})`);let $=b.match(/\/s0\/pixel\/(-?\d+)\/(-?\d+)/);if($&&!l){l=!0;let I=parseInt($[1]),B=parseInt($[2]);if(o(`[AUTO-IMAGE] \u{1F4CD} Posici\xF3n capturada: tile(${I}, ${B}) + pixel(${x}, ${A})`),o(`[AUTO-IMAGE] \u{1F30D} Esto corresponde a coordenada global: (${I*4e3+x}, ${B*4e3+A})`),t.tileX=I,t.tileY=B,t.startPosition={x,y:A},t.selectingPosition=!1,t.imageData&&t.imageData.processor){let k=t.imageData.processor;o("[AUTO-IMAGE] \u{1F504} Processor encontrado. Estado antes de setCoords:"),o(`[AUTO-IMAGE] \u{1F4CA} Processor coords actuales: [${k.coords.join(",")}]`),o(`[AUTO-IMAGE] \u{1F504} Llamando setCoords(${I}, ${B}, ${x}, ${A})`),k.setCoords(I,B,x,A),o(`[AUTO-IMAGE] \u{1F4CA} Processor coords despu\xE9s de setCoords: [${k.coords.join(",")}]`);try{await k.createTemplateTiles(),o(`\u2705 [BLUE MARBLE] Template tiles creados para posici\xF3n tile(${I},${B}) pixel(${x},${A})`)}catch(F){o(`\u274C [BLUE MARBLE] Error creando template tiles: ${F.message}`)}let R=k.generatePixelQueue();t.remainingPixels=R,t.totalPixels=R.length,o(`\u2705 Cola de p\xEDxeles generada: ${R.length} p\xEDxeles para overlay`),o(`[AUTO-IMAGE] \u{1F4CA} imageState.remainingPixels set to: ${((w=t.remainingPixels)==null?void 0:w.length)||0} pixels`),o(`[AUTO-IMAGE] \u{1F4CA} First pixel from Blue Marble: global(${(y=R[0])==null?void 0:y.globalX}, ${(C=R[0])==null?void 0:C.globalY}) local(${(S=R[0])==null?void 0:S.localX}, ${(L=R[0])==null?void 0:L.localY})`)}else o("[AUTO-IMAGE] \u274C ERROR: Processor no encontrado!"),o(`[AUTO-IMAGE] \u{1F4CA} imageState.imageData existe: ${!!t.imageData}`),t.imageData&&o(`[AUTO-IMAGE] \u{1F4CA} imageState.imageData.processor existe: ${!!t.imageData.processor}`);try{window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.injectStyles(),window.__WPA_PLAN_OVERLAY__.setEnabled(!0),window.__WPA_PLAN_OVERLAY__.setAnchor({tileX:I,tileY:B,pxX:x,pxY:A}),t.remainingPixels&&t.remainingPixels.length>0?(window.__WPA_PLAN_OVERLAY__.setPlan(t.remainingPixels,{anchor:{tileX:I,tileY:B,pxX:x,pxY:A},imageWidth:t.imageData.width,imageHeight:t.imageData.height,enabled:!0}),o(`\u2705 Plan overlay anclado en tile(${I},${B}) local(${x},${A})`)):o("\u26A0\uFE0F No hay p\xEDxeles para mostrar en overlay"))}catch(k){o(`\u274C Error configurando overlay: ${k.message}`)}n(),r.setStatus(v("image.positionSet"),"success"),o(`\u2705 Posici\xF3n establecida: tile(${t.tileX},${t.tileY}) local(${x},${A})`),u(!0)}else o("\u26A0\uFE0F No se pudo extraer tile de la URL:",b)}}return E}catch(E){if(o("\u274C Error interceptando pixel:",E),!l)return n(),e(b,m)}return e(b,m)}},f=()=>{let b=document.querySelectorAll("canvas");if(b.length===0){o("\u26A0\uFE0F No se encontraron elementos canvas");return}o(`\u{1F4CA} Configurando observer para ${b.length} canvas`);let m=w=>{var C;if(!t.selectingPosition||l)return;let y=w.target;if(y&&y.tagName==="CANVAS"){o("\u{1F5B1}\uFE0F Click detectado en canvas durante selecci\xF3n");try{let L=(((C=document.querySelector("canvas"))==null?void 0:C.parentElement)||document.body).getBoundingClientRect(),E=w.clientX-L.left,T=w.clientY-L.top;window.__WPA_PLAN_OVERLAY__&&(window.__WPA_PLAN_OVERLAY__.setAnchorCss(E,T),o(`Plan overlay: ancla CSS establecida en (${E}, ${T})`))}catch(S){o("Plan Overlay: error calculando ancla CSS",S)}setTimeout(()=>{!l&&t.selectingPosition&&o("\u{1F50D} Buscando requests recientes de pintado...")},500)}};document.addEventListener("click",m),t.cleanupObserver=()=>{document.removeEventListener("click",m)}};d(),f();let h=setTimeout(()=>{t.selectingPosition&&!l&&(n(),t.cleanupObserver&&t.cleanupObserver(),r.setStatus(v("image.positionTimeout"),"error"),o("\u23F0 Timeout en selecci\xF3n de posici\xF3n"),u(!1))},12e4);t.positionTimeoutId=h}),onStartPainting:async()=>{var u;if(o("\u{1F50D} Estado para iniciar pintura:",{imageLoaded:t.imageLoaded,startPosition:t.startPosition,tileX:t.tileX,tileY:t.tileY,totalPixels:t.totalPixels,remainingPixels:((u=t.remainingPixels)==null?void 0:u.length)||0}),!t.imageLoaded||!t.startPosition)return r.setStatus(v("image.missingRequirements"),"error"),o(`\u274C Validaci\xF3n fallida: imageLoaded=${t.imageLoaded}, startPosition=${!!t.startPosition}`),!1;t.running=!0,t.stopFlag=!1,t.isFirstBatch=!0,r.setStatus(v("image.startPaintingMsg"),"success");try{return await se(t.imageData,t.startPosition,(l,d,f,h)=>{g&&(g.charges=Math.floor(t.currentCharges),h!==void 0&&(g.estimatedTime=h)),r.updateProgress(l,d,g),t.inCooldown&&t.nextBatchCooldown>0?r.updateCooldownDisplay(t.nextBatchCooldown):r.updateCooldownDisplay(0),f?f.includes("\u23F3")&&t.inCooldown?r.updateCooldownMessage(f):r.setStatus(f,"info"):r.setStatus(v("image.paintingProgress",{painted:l,total:d}),"info")},(l,d)=>{l?(r.setStatus(v("image.paintingComplete",{count:d}),"success"),de()):r.setStatus(v("image.paintingStopped"),"warning"),t.running=!1},l=>{r.setStatus(v("image.paintingError"),"error"),o("\u274C Error en proceso de pintado:",l),t.running=!1}),!0}catch(l){return r.setStatus(v("image.paintingError"),"error"),o("\u274C Error iniciando pintado:",l),t.running=!1,!1}},onStopPainting:async()=>{if(ue().hasProgress){let l=await he(v("image.confirmSaveProgress"),v("image.saveProgressTitle"),{save:v("image.saveProgress"),discard:v("image.discardProgress"),cancel:v("image.cancel")});if(l==="save"){let d=J();d.success?r.setStatus(v("image.progressSaved",{filename:d.filename}),"success"):r.setStatus(v("image.progressSaveError",{error:d.error}),"error")}else if(l==="cancel")return!1}return Q(),r.setStatus(v("image.paintingStopped"),"warning"),!0},onSaveProgress:async()=>{let u=J();return u.success?r.setStatus(v("image.progressSaved",{filename:u.filename}),"success"):r.setStatus(v("image.progressSaveError",{error:u.error}),"error"),u.success},onLoadProgress:async u=>{try{let l=await ce(u);return l.success?(r.setStatus(v("image.progressLoaded",{painted:l.painted,total:l.total}),"success"),r.updateProgress(l.painted,l.total,g),o("\u2705 Progreso cargado - habilitando botones de inicio"),!0):(r.setStatus(v("image.progressLoadError",{error:l.error}),"error"),!1)}catch(l){return r.setStatus(v("image.progressLoadError",{error:l.message}),"error"),!1}},onResizeImage:()=>{t.imageLoaded&&t.imageData&&t.imageData.processor&&r.showResizeDialog(t.imageData.processor)},onConfirmResize:async(u,l,d)=>{o(`\u{1F504} Redimensionando imagen de ${u.getDimensions().width}x${u.getDimensions().height} a ${l}x${d}`);try{await u.resize(l,d);let f=await u.analyzePixels();t.imageData={processor:u,width:l,height:d,validPixelCount:f.validPixelCount,totalPixels:f.totalPixels,unknownPixels:f.unknownPixels},t.totalPixels=f.validPixelCount,t.paintedPixels=0,t.remainingPixels=[],t.lastPosition={x:0,y:0},r.updateProgress(0,f.validPixelCount,g),r.setStatus(v("image.resizeSuccess",{width:l,height:d}),"success"),o(`\u2705 Imagen redimensionada: ${f.validPixelCount} p\xEDxeles v\xE1lidos de ${f.totalPixels} totales`);try{if(window.__WPA_PLAN_OVERLAY__&&t.startPosition&&t.tileX!=null&&t.tileY!=null){await u.createTemplateTiles();let h=u.generatePixelQueue();t.remainingPixels=h,t.totalPixels=h.length,window.__WPA_PLAN_OVERLAY__.setPlan(h,{anchor:{tileX:t.tileX,tileY:t.tileY,pxX:t.startPosition.x,pxY:t.startPosition.y},imageWidth:l,imageHeight:d,enabled:!0}),o(`\u2705 Overlay actualizado con ${h.length} p\xEDxeles despu\xE9s del resize`)}}catch(h){o(`\u26A0\uFE0F Error actualizando overlay despu\xE9s del resize: ${h.message}`)}}catch(f){o(`\u274C Error redimensionando imagen: ${f.message}`),r.setStatus(v("image.imageError"),"error")}}}),p=u=>{let{language:l}=u.detail;o(`\u{1F30D} Imagen: Detectado cambio de idioma desde launcher: ${l}`),t.language=l};window.addEventListener("launcherLanguageChanged",p),window.addEventListener("languageChanged",p),window.addEventListener("beforeunload",()=>{n(),Q(),r.destroy(),window.removeEventListener("launcherLanguageChanged",p),window.removeEventListener("languageChanged",p),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1)}),o("\u2705 Auto-Image inicializado correctamente"),setTimeout(async()=>{try{r.setStatus(v("image.autoInitializing"),"info"),o("\u{1F916} Intentando auto-inicio..."),await s()?(r.setStatus(v("image.autoInitSuccess"),"success"),o("\u2705 Auto-inicio exitoso"),r.setInitButtonVisible(!1),await c(!0)&&o("\u{1F680} Bot auto-iniciado completamente")):(r.setStatus(v("image.autoInitFailed"),"warning"),o("\u26A0\uFE0F Auto-inicio fall\xF3, se requiere inicio manual"))}catch(u){o("\u274C Error en auto-inicio:",u),r.setStatus(v("image.manualInitRequired"),"warning")}},1e3)}catch(i){throw o("\u274C Error inicializando Auto-Image:",i),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1),i}}(()=>{"use strict";var g,e;if((g=window.__wplaceBot)!=null&&g.imageRunning){alert("Auto-Image ya est\xE1 corriendo.");return}if((e=window.__wplaceBot)!=null&&e.farmRunning){alert("Auto-Farm est\xE1 ejecut\xE1ndose. Ci\xE9rralo antes de iniciar Auto-Image.");return}window.__wplaceBot||(window.__wplaceBot={}),window.__wplaceBot.imageRunning=!0,we().catch(n=>{console.error("[BOT] Error en Auto-Image:",n),window.__wplaceBot&&(window.__wplaceBot.imageRunning=!1),alert("Auto-Image: error inesperado. Revisa consola.")})})();})();
